<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="../favicon.png">
    <link rel="apple-touch-icon" href="../apple-touch-icon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hammadde Modülü | Kablo Fabrikası ERP</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg: #f3f3f3;
            --fg: #000000;
            --gray-100: #f3f4f6;
            --gray-300: #d1d5db;
            --positive: #16a34a;
            --negative: #dc2626;
            --accent: #2563eb;
            --turquoise: #00b5ad;
        }
        body { font-family: 'IBM Plex Mono', monospace; background: var(--bg); color: var(--fg); font-size: 12px; line-height: 1.3; }
        .nav { position: sticky; top: 0; z-index: 50; border-bottom: 2px solid var(--fg); background: var(--bg); }
        .nav-container { max-width: 1400px; margin: 0 auto; padding: 0 64px; height: 56px; display: flex; align-items: center; }
        .nav-left { display: flex; align-items: center; gap: 12px; }
        .nav-logo { font-size: 18px; font-weight: 700; letter-spacing: 2px; text-decoration: none; color: var(--fg); }
        .nav-right { margin-left: auto; }
        .nav-link-small { color: var(--fg); text-decoration: underline; font-size: 11px; }
        .nav-divider { color: var(--fg); font-size: 14px; font-weight: 300; }
        .report { max-width: 1400px; margin: 0 auto; padding: 24px 64px; }
        .report h1 { font-size: 28px; margin-bottom: 8px; letter-spacing: 2px; }
        .report h2 { font-size: 18px; margin-top: 36px; margin-bottom: 12px; border-bottom: 2px solid #000; padding-bottom: 4px; scroll-margin-top: 72px; }
        .report h3 { font-size: 14px; margin-top: 20px; margin-bottom: 8px; }
        .report h4 { font-size: 12px; margin-top: 14px; margin-bottom: 6px; }
        .report p { font-size: 13px; line-height: 1.6; margin-bottom: 12px; }
        .report ul { font-size: 13px; margin: 12px 0; padding-left: 20px; }
        .report li { margin-bottom: 6px; line-height: 1.5; }
        .report ol { font-size: 13px; margin: 12px 0; padding-left: 20px; }
        .report ol li { margin-bottom: 6px; line-height: 1.5; }
        .report .subtitle { font-size: 14px; color: #666; margin-bottom: 4px; }
        .report .authors { font-size: 12px; color: #888; margin-bottom: 32px; }
        .report code { background: #e5e5e0; padding: 1px 5px; font-size: 12px; }
        .report pre { background: #1a1a2e; color: #e0e0e0; padding: 16px; margin: 12px 0; overflow-x: auto; font-size: 12px; line-height: 1.5; border: 2px solid #000; }
        .report pre .comment { color: #6a9955; }
        .report pre .keyword { color: #569cd6; }
        .report pre .string { color: #ce9178; }
        .report pre .decorator { color: #dcdcaa; }
        .report .abstract { background: #f5f5f0; padding: 16px; margin: 20px 0; border-left: 3px solid #000; }
        .report .finding { background: #fffbe6; padding: 12px; margin: 12px 0; border: 1px solid #e6d600; }
        .report .warning { background: #fee2e2; padding: 12px; margin: 12px 0; border: 1px solid #dc2626; }
        .report .discovery { background: #e6ffe6; padding: 12px; margin: 12px 0; border: 1px solid #0a0; }
        .report .insight { background: #eff6ff; padding: 12px; margin: 12px 0; border: 1px solid #2563eb; }
        .report .philosophy { background: #faf5ff; padding: 12px; margin: 12px 0; border: 1px solid #7c3aed; }
        .stat-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin: 16px 0; }
        .stat-grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin: 16px 0; }
        .stat-box { background: #f3f4f6; padding: 12px; text-align: center; border: 2px solid #000; }
        .stat-box .value { font-size: 24px; font-weight: bold; }
        .stat-box .label { font-size: 10px; color: #666; margin-top: 2px; }
        .report table { width: auto; border-collapse: collapse; border: 2px solid #000; margin: 16px 0; }
        .report tr:first-child { background: #f3f4f6; border-bottom: 2px solid #000; }
        .report th { padding: 4px 10px; text-align: left; font-size: 0.65rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.03em; white-space: nowrap; border-right: 2px solid #000; background: #f3f4f6; }
        .report th:last-child { border-right: none; }
        .report tr:not(:first-child) { border-bottom: 1px solid #d1d5db; }
        .report tr:last-child { border-bottom: none; }
        .report td { padding: 4px 10px; font-size: 0.75rem; border-right: 2px solid #000; }
        .report td:last-child { border-right: none; }
        .report tr:not(:first-child):hover { background: rgba(0,0,0,0.02); }
        .flow { display: flex; align-items: center; gap: 8px; margin: 16px 0; flex-wrap: wrap; }
        .flow-box { padding: 8px 14px; border: 2px solid #000; font-size: 12px; font-weight: 700; text-align: center; min-width: 100px; }
        .flow-arrow { font-size: 18px; font-weight: 700; }
        .flow-box.done { background: #dcfce7; border-color: #16a34a; }
        .flow-box.active { background: #dbeafe; border-color: #2563eb; }
        .flow-box.pending { background: #f3f4f6; }
        .arch-box { background: #fff; border: 2px solid #000; padding: 16px; margin: 12px 0; }
        .arch-box h4 { font-size: 14px; margin-bottom: 8px; margin-top: 0; }
        .arch-box p { font-size: 12px; line-height: 1.5; }
        .arch-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 16px; margin: 16px 0; }
        .back-link { display: inline-block; font-size: 12px; color: #666; text-decoration: none; margin-bottom: 24px; padding: 8px 0; }
        .back-link:hover { color: #000; }
        .back-link::before { content: "\2190  "; }
        .good { color: #16a34a; font-weight: 700; }
        .bad { color: #dc2626; font-weight: 700; }

        .submod-card { background: #fff; border: 2px solid #000; padding: 16px; margin: 10px 0; display: flex; align-items: flex-start; gap: 16px; }
        .submod-num { background: #000; color: #fff; font-size: 13px; font-weight: 700; min-width: 36px; height: 36px; padding: 0 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .submod-body { flex: 1; }
        .submod-body h4 { font-size: 14px; margin: 0 0 4px 0; }
        .submod-body p { font-size: 12px; color: #555; margin: 0 0 6px 0; line-height: 1.4; }
        .submod-tags { display: flex; gap: 6px; flex-wrap: wrap; }
        .submod-tag { font-size: 10px; padding: 2px 6px; background: #f3f4f6; border: 1px solid #d1d5db; }

        @media (max-width: 768px) {
            .report { padding: 16px; }
            .nav-container { padding: 0 16px; }
            .stat-grid, .stat-grid-3 { grid-template-columns: repeat(2, 1fr); }
            .flow { flex-direction: column; align-items: stretch; }
            .flow-arrow { transform: rotate(90deg); text-align: center; }
            .arch-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <nav class="nav">
        <div class="nav-container">
            <div class="nav-left">
                <a href="erp-system.html" class="nav-logo">ERP SYSTEM</a>
            </div>
            <div class="nav-right">
                <a href="erp-mod-hammadde-tr.html" class="nav-link-small" style="font-weight: 700;">TR</a>
                <span class="nav-divider">|</span>
                <a href="erp-mod-hammadde.html" class="nav-link-small">EN</a>
            </div>
        </div>
    </nav>

    <main class="report">
        <a href="erp-deep-dives-tr.html" class="back-link">Modüllere Dön</a>
        <h1>HAMMADDE &mdash; HAM MALZEME YÖNETİMİ</h1>
        <p class="subtitle">Satın alma siparişinden QR kodlu envantere uzanan tedarik zinciri. Fabrika kapısından giren her gram bakır, kalay, plastik, katalizör, boya, palet ve makara &mdash; anlık takip altında.</p>
        <p class="authors">Şubat 2026 &bull; Solen Kablo &bull; Yaşayan Doküman</p>

        <div class="abstract">
            <p style="margin-bottom: 0;"><strong>Hammadde, fiziksel malzemenin dijital takiple buluştuğu yerdir.</strong> Bir kablo fabrikası sekiz kategori hammadde tüketir: bakır tel çubukları, kalay külçeleri, plastik granüller, katalizörler, boyalar, anti-kemirgen bileşikler, paletler (ahşap nakliye platformları) ve makaralar (kablo tamburları). Her biri bir tedarikçiden gelir, tartılır, fotoğraflanır, benzersiz bir QR kodu atanır ve sisteme girilir. O andan itibaren malzeme izlenebilirdir &mdash; üretim tüketiminden kalan ağırlık takibine ve makaradaki bitmiş kabloya kadar. Hammadde ayrıca tüm satın alma sipariş yaşam döngüsünü yönetir: sipariş oluşturmadan teslimat tarihlerini takibe, tarih değişikliği nedenlerini kaydetmeye ve teslimat sonrası tedarikçi performansını puanlamaya kadar.</p>
        </div>

        <div class="stat-grid">
            <div class="stat-box">
                <div class="value" style="color: var(--accent);">4</div>
                <div class="label">ALT MODÜL</div>
            </div>
            <div class="stat-box">
                <div class="value" style="color: var(--turquoise);">~30</div>
                <div class="label">API ENDPOINT</div>
            </div>
            <div class="stat-box">
                <div class="value">6</div>
                <div class="label">VERİTABANI TABLOSU</div>
            </div>
            <div class="stat-box">
                <div class="value" style="color: var(--positive);">5100+</div>
                <div class="label">SATIR FRONTEND</div>
            </div>
        </div>

        <!-- İÇİNDEKİLER -->
        <div style="background: #fff; border: 2px solid #000; padding: 20px 28px; margin: 24px 0;">
            <h3 style="margin: 0 0 12px 0; font-size: 14px; letter-spacing: 1px;">&#304;&Ccedil;&#304;NDEK&#304;LER</h3>
            <div style="columns: 2; column-gap: 32px; font-size: 12px; line-height: 2;">
                <a href="#sec-1" style="text-decoration: none; color: var(--fg); display: block;"><strong>1.</strong> Hammadde Ne Yapar</a>
                <a href="#sec-2" style="text-decoration: none; color: var(--fg); display: block;"><strong>2.</strong> Veri Ak&#305;&#351;&#305;</a>
                <a href="#sec-3" style="text-decoration: none; color: var(--fg); display: block;"><strong>3.</strong> Veritaban&#305; Katman&#305;</a>
                <a href="#sec-4" style="text-decoration: none; color: var(--fg); display: block;"><strong>4.</strong> Backend Mimarisi</a>
                <a href="#sec-5" style="text-decoration: none; color: var(--fg); display: block;"><strong>5.</strong> Frontend</a>
                <a href="#sec-6" style="text-decoration: none; color: var(--fg); display: block;"><strong>6.</strong> Alt Mod&uuml;ller</a>
                <a href="#sec-6-1" style="text-decoration: none; color: #555; display: block; padding-left: 16px;">6.1 Tedarik&ccedil;i Y&ouml;netimi</a>
                <a href="#sec-6-2" style="text-decoration: none; color: #555; display: block; padding-left: 16px;">6.2 Hammadde Sipari&#351;</a>
                <a href="#sec-6-3" style="text-decoration: none; color: #555; display: block; padding-left: 16px;">6.3 Hammadde Giri&#351;i</a>
                <a href="#sec-6-4" style="text-decoration: none; color: #555; display: block; padding-left: 16px;">6.4 Hammaddeler Listesi</a>
                <a href="#sec-7" style="text-decoration: none; color: var(--fg); display: block;"><strong>7.</strong> Sonu&ccedil;</a>
            </div>
        </div>

        <!-- ============================================ -->
        <h2 id="sec-1">1. HAMMADDE NE YAPAR</h2>
        <!-- ============================================ -->

        <p>Hammadde modülü, fabrikanın tedarik zincirinin bağlı olduğu dört soruyu yanıtlar:</p>

        <ol>
            <li><strong>Stokta hangi hammaddeler var?</strong> &mdash; Malzeme Girişi gelen her sevkiyatı kaydeder. Bakır paletler halinde gelir (teslimat başına birden fazla), kalay tek tartımlı külçe olarak ve plastik/katalizör/boya/antirodent lot bazlı girişler olarak. Her birine QR kodu atanır (A=bakır, B=kalay, C=plastik, D=katalizör, E=boya, F=antirodent, I=palet, H=makara), teslimat ve test fotoğrafları eklenir ve satın alma siparişine bağlanır.</li>
            <li><strong>Her gram malzeme şu anda nerede?</strong> &mdash; Hammaddeler Listesi lazy-load fotoğraf önizlemeleri, durum takibi (received &rarr; approved &rarr; in_use &rarr; consumed/rejected), üretim sonrası kalan ağırlık ve malzeme oluşturma/değiştirme/silme sırasında gerçek zamanlı WebSocket güncellemeleriyle tam envanter görünümü sunar.</li>
            <li><strong>Ne sipariş ettik ve ne zaman gelecek?</strong> &mdash; Hammadde Sipariş, sipariş grup kodları (R1, R2, R3...), beklenen teslimat tarihleri, gerçek teslimat tarihleri, nedenli tarih değişikliği geçmişi (tedarikçi/solen/diğer), teslim edilen miktar takibi ve teslimat sonrası tedarikçi puanlaması (0.5&ndash;5 yıldız) ile her satın almayı izler.</li>
            <li><strong>Tedarikçilerimiz kim ve ne sağlıyorlar?</strong> &mdash; Tedarikçi Yönetimi bire-çok ilişki yönetir: bir tedarikçi şirket birden fazla malzeme türü sağlayabilir (bakır, plastik, boya vb.), her biri yoğunluk (g/cm&sup3;), boyut ve makara tipi (yazılı/yazısız) gibi malzemeye özgü özellikler taşır.</li>
        </ol>

        <div class="finding">
            <p style="margin-bottom: 0;"><strong>Alt akış tüketicisi.</strong> Hammadde, Teknik modülünün Kablo Veritabanı&rsquo;nın birincil tüketicisidir. Sipariş modülü bir sipariş için malzeme gereksinimlerini hesapladığında (bakır ağırlığı, kalay kaplama, plastik hacimler, katalizör/boya yüzdeleri), Teknik&rsquo;ten kablo özelliklerini okuyan ve Hammadde&rsquo;nin karşılaması gereken tedarik miktarlarını üreten <code>material_calculator</code> servisini kullanır. Malzeme Girişi sayfası ayrıca gelen teslimatları doğrudan Malzeme Siparişlerine bağlayarak &ldquo;ne sipariş edildi&rdquo; ile &ldquo;gerçekte ne geldi&rdquo; arasındaki döngüyü kapatır.</p>
        </div>

        <!-- ============================================ -->
        <h2 id="sec-2">2. VERİ AKIŞI</h2>
        <!-- ============================================ -->

        <p>Veri, Hammadde modülünde net bir tedarik-tüketim döngüsünde akar:</p>

        <h3>Tedarik Akışı</h3>
        <div class="flow">
            <div class="flow-box" style="background: #faf5ff; border-color: #7c3aed;">TEDARİKÇİ<br><span style="font-size:9px;color:#666;">Sisteme kayıtlı</span></div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box" style="background: #eff6ff; border-color: #2563eb;">SİPARİŞ<br><span style="font-size:9px;color:#666;">R1, R2... oluşturulur</span></div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box" style="background: #fffbe6; border-color: #f59e0b;">TESLİMAT<br><span style="font-size:9px;color:#666;">Tarih takibi</span></div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box" style="background: #dcfce7; border-color: #16a34a;">GİRİŞ<br><span style="font-size:9px;color:#666;">QR + fotoğraf</span></div>
        </div>

        <h3>Tüketim Akışı</h3>
        <div class="flow">
            <div class="flow-box" style="background: #dcfce7; border-color: #16a34a;">MALZEME<br><span style="font-size:9px;color:#666;">Durum: teslim alındı</span></div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box" style="background: #dbeafe; border-color: #2563eb;">ONAYLANDI<br><span style="font-size:9px;color:#666;">Lab onayı</span></div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box" style="background: #fffbe6; border-color: #f59e0b;">KULLANIMDA<br><span style="font-size:9px;color:#666;">Üretim hattında</span></div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box" style="background: #f3f4f6; border-color: #666;">TÜKETİLDİ<br><span style="font-size:9px;color:#666;">remaining_weight = 0</span></div>
        </div>

        <h3>Sipariş-Giriş Bağlantısı</h3>
        <p>Malzeme teslimatı geldiğinde, Malzeme Girişi sayfası gelen malzemeyi doğrudan bekleyen satın alma siparişine bağlayabilir. Bu, siparişin <code>delivered_quantity</code> değerini günceller, durumunu <code>delivered</code> olarak ayarlar ve <code>delivered_date</code> kaydeder. Bu sıkı bağlantı sayesinde sistem her zaman bilir: sipariş edilen her kilogram için gerçekte ne kadar geldi ve ne zaman.</p>

        <div class="insight">
            <p style="margin-bottom: 0;"><strong>Her yerde gerçek zamanlı.</strong> Her malzeme oluşturma, güncelleme ve silme bir WebSocket olayı yayınlar. Hammaddeler Listesi sayfası polling olmadan otomatik yenilenir. Tedarikçi Yönetimi sayfası da aynı şekilde. Bu, birden fazla kullanıcının (lab teknisyenleri, satın alma personeli) tüm ekranlarında değişiklikleri anında görmesi anlamına gelir.</p>
        </div>

        <!-- ============================================ -->
        <h2 id="sec-3">3. VERİTABANI KATMANI</h2>
        <!-- ============================================ -->

        <p>Hammadde modülüne 6 tablo hizmet eder. Üç gruba ayrılırlar:</p>

        <h3>Malzeme Tabloları (2)</h3>

        <h4>raw_materials</h4>
        <p>Merkezi tablo. Fabrikaya giren her fiziksel malzeme &mdash; türü ne olursa olsun &mdash; burada bir satır alır.</p>
        <table>
            <tr><th>Kolon</th><th>Tip</th><th>Amaç</th></tr>
            <tr><td>id</td><td>INTEGER PK</td><td>Otomatik artan birincil anahtar</td></tr>
            <tr><td>material_type</td><td>VARCHAR(50)</td><td>raw_copper, raw_tin, raw_plastic, raw_catalyst, raw_dye, raw_antirodent, raw_palette, raw_reel</td></tr>
            <tr><td>material_name</td><td>VARCHAR(200)</td><td>Tedarikçi kataloğundan spesifik malzeme adı (ör. HFX500, K388)</td></tr>
            <tr><td>sequence_number</td><td>INTEGER</td><td>Tür bazlı sayaç &mdash; her material_type için ayrı sıra</td></tr>
            <tr><td>qr_code</td><td>VARCHAR(50) UNIQUE</td><td>Oluşturulan kod: ön ek + sıra (A1, B7, C23, I145...)</td></tr>
            <tr><td>supplier_id</td><td>FK &rarr; suppliers</td><td>Bu malzemeyi hangi tedarikçi sağladı</td></tr>
            <tr><td>material_order_id</td><td>FK &rarr; material_orders</td><td>Satın alma siparişine bağlantı (teslimat takibi için)</td></tr>
            <tr><td>lot_number</td><td>VARCHAR(100)</td><td>Tedarikçinin lot numarası (veya kalay için otomatik: TIN-N)</td></tr>
            <tr><td>weight</td><td>FLOAT</td><td>Teslim alındığında ölçülen ağırlık (kg)</td></tr>
            <tr><td>remaining_weight</td><td>FLOAT</td><td>Üretim tüketimi sonrası kalan ağırlık (kg)</td></tr>
            <tr><td>form_weight</td><td>FLOAT</td><td>Resmi form ağırlığı (bakır paletler için)</td></tr>
            <tr><td>quantity</td><td>INTEGER</td><td>Lot bazlı malzemeler için adet (plastik/katalizör/boya/antirodent)</td></tr>
            <tr><td>status</td><td>VARCHAR(50)</td><td>received &rarr; approved &rarr; in_use &rarr; consumed | rejected</td></tr>
            <tr><td>entered_by</td><td>FK &rarr; users</td><td>Malzemeyi sisteme kim girdi</td></tr>
            <tr><td>notes</td><td>TEXT</td><td>Serbest notlar</td></tr>
            <tr><td>received_date</td><td>DATETIME</td><td>Malzemenin fiziksel olarak teslim alındığı zaman</td></tr>
            <tr><td>created_at</td><td>DATETIME</td><td>Kayıt oluşturma zaman damgası</td></tr>
            <tr><td>updated_at</td><td>DATETIME</td><td>Son güncelleme zaman damgası (değişiklikte otomatik)</td></tr>
        </table>

        <h4>material_photos</h4>
        <p><strong>Lazy loading performansı</strong> için fotoğraflar ayrı tabloda tutulur. Binlerce malzeme varken, her liste sorgusunda base64 fotoğraf verisi yüklemek felaket olurdu. Bunun yerine liste sadece fotoğraf ID&rsquo;lerini döner ve frontend gerçek fotoğraf verisini talep üzerine çeker.</p>
        <table>
            <tr><th>Kolon</th><th>Tip</th><th>Amaç</th></tr>
            <tr><td>id</td><td>INTEGER PK</td><td>Fotoğraf tanımlayıcısı</td></tr>
            <tr><td>material_id</td><td>FK &rarr; raw_materials (CASCADE)</td><td>Bu fotoğraf hangi malzemeye ait</td></tr>
            <tr><td>photo_type</td><td>VARCHAR(20)</td><td>&lsquo;delivery&rsquo; veya &lsquo;test&rsquo;</td></tr>
            <tr><td>sequence</td><td>INTEGER</td><td>1, 2 veya 3 (tür başına en fazla 3 fotoğraf)</td></tr>
            <tr><td>photo_data</td><td>TEXT</td><td>Base64 kodlanmış görüntü verisi</td></tr>
            <tr><td>created_at</td><td>DATETIME</td><td>Yükleme zaman damgası</td></tr>
        </table>

        <div class="discovery">
            <p style="margin-bottom: 0;"><strong>Performans deseni:</strong> Eski tasarım fotoğrafları doğrudan <code>raw_materials</code> tablosunda base64 dizilerinin JSON dizileri olarak saklıyordu. Bu, liste sorgularını dayanılmaz derecede yavaşlatıyordu. Ayrı bir <code>material_photos</code> tablosuna geçiş ve bireysel fotoğraf endpoint&rsquo;leri (<code>GET /materials/photo/{id}</code>) üzerinden lazy loading ile bu sorun tamamen çözüldü. Eski kolonlar (<code>delivery_form_photo</code>, <code>test_report_photo</code>, <code>delivery_form_photos</code>, <code>test_report_photos</code>) geriye uyumluluk için tutulur ancak artık kullanılmaz.</p>
        </div>

        <h3>Sipariş Tabloları (2)</h3>

        <h4>material_orders</h4>
        <p>Satın alma siparişlerini takip eder. Resmi ERP satın alma siparişleri değil &mdash; malzemelerin ne zaman gelmesinin beklendiğine dair dahili takip kayıtlarıdır.</p>
        <table>
            <tr><th>Kolon</th><th>Tip</th><th>Amaç</th></tr>
            <tr><td>id</td><td>INTEGER PK</td><td>Sipariş tanımlayıcısı</td></tr>
            <tr><td>order_group_code</td><td>VARCHAR(20)</td><td>Gruplama kodu (R1, R2...) &mdash; aynı sevkiyattan siparişler bunu paylaşır</td></tr>
            <tr><td>material_type</td><td>VARCHAR(50)</td><td>Ne sipariş ediliyor (bakır, plastik vb.)</td></tr>
            <tr><td>supplier_id</td><td>FK &rarr; suppliers</td><td>Siparişi hangi tedarikçi karşılıyor</td></tr>
            <tr><td>supplier_material_id</td><td>FK &rarr; supplier_materials</td><td>Sipariş edilen spesifik malzeme</td></tr>
            <tr><td>quantity</td><td>FLOAT</td><td>Sipariş edilen miktar</td></tr>
            <tr><td>delivered_quantity</td><td>FLOAT</td><td>Gerçekte teslim edilen miktar (malzeme girişi bağlandığında güncellenir)</td></tr>
            <tr><td>unit</td><td>VARCHAR(20)</td><td>Malzemeler için &lsquo;kg&rsquo;, palet/makara için &lsquo;adet&rsquo;</td></tr>
            <tr><td>order_date</td><td>DATE</td><td>Siparişin verildiği tarih</td></tr>
            <tr><td>expected_date</td><td>DATE</td><td>Teslimatın beklendiği tarih (değişebilir &mdash; takip edilir)</td></tr>
            <tr><td>delivered_date</td><td>DATE</td><td>Gerçek teslimat tarihi</td></tr>
            <tr><td>status</td><td>VARCHAR(20)</td><td>pending &rarr; shipped &rarr; delivered | cancelled</td></tr>
            <tr><td>rating</td><td>FLOAT</td><td>Teslimat sonrası puan (0.5&ndash;5 yıldız, yarım artışlarla)</td></tr>
            <tr><td>rating_note</td><td>TEXT</td><td>Puanlama yorumu</td></tr>
            <tr><td>notes</td><td>TEXT</td><td>Sipariş notları</td></tr>
            <tr><td>created_by</td><td>FK &rarr; users</td><td>Bu siparişi kim oluşturdu</td></tr>
        </table>

        <h4>material_order_date_changes</h4>
        <p>Beklenen teslimat tarihi değişiklikleri için denetim izi. Birisi beklenen tarihi her değiştirdiğinde, sistem nedenini kaydeder.</p>
        <table>
            <tr><th>Kolon</th><th>Tip</th><th>Amaç</th></tr>
            <tr><td>id</td><td>INTEGER PK</td><td>Değişiklik kaydı tanımlayıcısı</td></tr>
            <tr><td>order_id</td><td>FK &rarr; material_orders (CASCADE)</td><td>Hangi sipariş değiştirildi</td></tr>
            <tr><td>old_date</td><td>DATE</td><td>Önceki beklenen tarih</td></tr>
            <tr><td>new_date</td><td>DATE</td><td>Yeni beklenen tarih</td></tr>
            <tr><td>reason_type</td><td>VARCHAR(20)</td><td>&lsquo;supplier&rsquo; | &lsquo;solen&rsquo; | &lsquo;other&rsquo;</td></tr>
            <tr><td>reason_detail</td><td>TEXT</td><td>Manuel açıklama (&lsquo;other&rsquo; için zorunlu)</td></tr>
            <tr><td>changed_by</td><td>FK &rarr; users</td><td>Tarihi kim değiştirdi</td></tr>
            <tr><td>created_at</td><td>DATETIME</td><td>Değişikliğin kaydedildiği zaman</td></tr>
        </table>

        <h3>Tedarikçi Tabloları (2)</h3>

        <h4>suppliers</h4>
        <p>Şirket düzeyinde tedarikçi kayıtları. Her tedarikçi, iletişim bilgileriyle birlikte tek bir şirkettir.</p>
        <table>
            <tr><th>Kolon</th><th>Tip</th><th>Amaç</th></tr>
            <tr><td>id</td><td>INTEGER PK</td><td>Tedarikçi tanımlayıcısı</td></tr>
            <tr><td>name</td><td>VARCHAR(200) UNIQUE</td><td>Şirket adı (BÜYÜK HARF olarak saklanır)</td></tr>
            <tr><td>contact_person</td><td>VARCHAR(100)</td><td>Birincil iletişim kişisi</td></tr>
            <tr><td>phone</td><td>VARCHAR(50)</td><td>Otomatik biçimlendirilen Türk telefon numarası</td></tr>
            <tr><td>email</td><td>VARCHAR(100)</td><td>E-posta (regex doğrulamalı)</td></tr>
            <tr><td>address</td><td>TEXT</td><td>Fiziksel adres</td></tr>
            <tr><td>tax_number</td><td>VARCHAR(50)</td><td>Vergi sicil numarası</td></tr>
            <tr><td>is_active</td><td>BOOLEAN</td><td>Yumuşak silme bayrağı (aktif/pasif geçişi)</td></tr>
            <tr><td>notes</td><td>TEXT</td><td>Serbest notlar</td></tr>
        </table>

        <h4>supplier_materials</h4>
        <p>Bire-çok ilişki. Bir tedarikçi birden fazla malzeme türü sağlayabilir, her biri türe özgü özellikler taşır.</p>
        <table>
            <tr><th>Kolon</th><th>Tip</th><th>Amaç</th></tr>
            <tr><td>id</td><td>INTEGER PK</td><td>Tedarikçi-malzeme bağlantı tanımlayıcısı</td></tr>
            <tr><td>supplier_id</td><td>FK &rarr; suppliers</td><td>Hangi tedarikçi</td></tr>
            <tr><td>material_type</td><td>VARCHAR(50)</td><td>copper, tin, plastic, catalyst, dye, antirodent, palette, reel</td></tr>
            <tr><td>material_name</td><td>VARCHAR(100)</td><td>Spesifik ürün adı (HF-500, CAT-203 vb.)</td></tr>
            <tr><td>density</td><td>FLOAT</td><td>Plastik/katalizör/boya/antirodent için (g/cm&sup3;)</td></tr>
            <tr><td>boyut</td><td>VARCHAR(100)</td><td>Palet/makara için boyutlar</td></tr>
            <tr><td>reel_type</td><td>VARCHAR(20)</td><td>Makaralar için: Yazılı/Yazısız (etiketli/etiketsiz)</td></tr>
            <tr><td>is_active</td><td>BOOLEAN</td><td>Bu malzemenin hâlâ sunulup sunulmadığı</td></tr>
        </table>

        <div class="finding">
            <p style="margin-bottom: 0;"><strong>Varlık ilişki özeti:</strong> <code>suppliers</code> 1&mdash;N <code>supplier_materials</code> (ne satıyorlar), <code>suppliers</code> 1&mdash;N <code>raw_materials</code> (ne teslim ettiler), <code>material_orders</code> N&mdash;1 <code>suppliers</code> (kimden sipariş ettik), <code>material_orders</code> N&mdash;1 <code>supplier_materials</code> (tam olarak ne), <code>raw_materials</code> N&mdash;1 <code>material_orders</code> (bağlı teslimat), <code>raw_materials</code> 1&mdash;N <code>material_photos</code> (lazy-loaded), <code>material_orders</code> 1&mdash;N <code>material_order_date_changes</code> (denetim izi).</p>
        </div>

        <!-- ============================================ -->
        <h2 id="sec-4">4. BACKEND MİMARİSİ</h2>
        <!-- ============================================ -->

        <p>Backend FastAPI ile inşa edilmiş olup 4 route dosyası, 4 model, 2 şema dosyası ve 1 servisten oluşur. Toplam backend kodu: ~3.200 satır.</p>

        <h3>4.1 Route Organizasyonu</h3>

        <div class="arch-grid">
            <div class="arch-box">
                <h4>material_routes.py (986 satır)</h4>
                <p>Router ön eki: <code>/api/materials</code><br>
                Ana malzeme CRUD. Bakır girişi (çoklu palet), kalay girişi (tekli), lot bazlı giriş (plastik/katalizör/boya/antirodent), fotoğraf alma, listeleme, güncelleme, baskı önizleme, yazıcı yönetimi, QR yazdırma, durum geçişi ve kalıcı silme. palette_routes alt yönlendiricisini içerir.</p>
            </div>
            <div class="arch-box">
                <h4>material_order_routes.py (478 satır)</h4>
                <p>Router ön eki: <code>/api/material-orders</code><br>
                Sipariş yaşam döngüsü yönetimi. Filtreli listeleme, tedarikçi/tarihe göre gruplanmış bekleyen siparişler (Malzeme Girişi bağlantısı için), tekli veya toplu oluşturma (otomatik R kodları), tarih değişikliği takipli güncelleme, tarih değişikliği geçmişi alma, teslimat puanlama ve silme.</p>
            </div>
            <div class="arch-box">
                <h4>palette_routes.py (316 satır)</h4>
                <p>material_routes içinde yer alır (ayrı ön ek yok).<br>
                Palet ve makara giriş endpoint&rsquo;leri. lot-entry&rsquo;ye benzer ancak envanter kalemleri için özelleştirilmiş: paletler QR ön eki I, makaralar H alır. Her ikisi de sipariş bağlama ve fotoğraf yüklemeyi destekler.</p>
            </div>
            <div class="arch-box">
                <h4>supplier_routes.py (435 satır)</h4>
                <p>Router ön eki: <code>/api/suppliers</code><br>
                Tam tedarikçi yaşam döngüsü: iç içe malzemelerle oluşturma, eager-loaded malzemelerle listeleme, malzeme türüne göre filtreleme, benzersiz malzeme listesi (tekilleştirilmiş özellikler), tekil tedarikçi alma, malzeme değişimiyle güncelleme, bağımlılık kontrolüyle kalıcı silme ve durum geçişi.</p>
            </div>
        </div>

        <h3>4.2 QR Kod Sistemi</h3>
        <p>Her malzeme, tür ön eki ve sıra numarasına dayalı deterministik bir QR kodu alır:</p>

        <pre><span class="keyword">def</span> generate_qr_code(material_type: str, sequence_number: int) -&gt; str:
    prefix_map = {
        <span class="string">"raw_copper"</span>:     <span class="string">"A"</span>,   <span class="comment"># A1, A2, A3...</span>
        <span class="string">"raw_tin"</span>:        <span class="string">"B"</span>,   <span class="comment"># B1, B2, B3...</span>
        <span class="string">"raw_plastic"</span>:    <span class="string">"C"</span>,   <span class="comment"># C1, C2, C3...</span>
        <span class="string">"raw_catalyst"</span>:   <span class="string">"D"</span>,   <span class="comment"># D1, D2, D3...</span>
        <span class="string">"raw_dye"</span>:        <span class="string">"E"</span>,   <span class="comment"># E1, E2, E3...</span>
        <span class="string">"raw_antirodent"</span>: <span class="string">"F"</span>,   <span class="comment"># F1, F2, F3...</span>
        <span class="string">"raw_palette"</span>:    <span class="string">"I"</span>,   <span class="comment"># I1, I2, I3...</span>
        <span class="string">"raw_reel"</span>:       <span class="string">"H"</span>,   <span class="comment"># H1, H2, H3...</span>
    }
    prefix = prefix_map.get(material_type, <span class="string">"X"</span>)
    <span class="keyword">return</span> f<span class="string">"{prefix}{sequence_number}"</span></pre>

        <p>Sıra numarası tür bazlıdır: sistem o <code>material_type</code> için maksimum <code>sequence_number</code> değerini sorgular ve artırır. Bu, A1 ve B1&rsquo;in birlikte var olabileceği anlamına gelir &mdash; her türün kendi bağımsız sayacı vardır.</p>

        <h3>4.3 Malzeme Giriş Mantığı</h3>
        <p>Giriş endpoint&rsquo;i, malzeme türüne göre temelden farklı üç akışı yönetir:</p>

        <table>
            <tr><th>Malzeme Türü</th><th>Giriş Yöntemi</th><th>Temel Davranış</th></tr>
            <tr><td>Bakır (raw_copper)</td><td>POST /materials/entry</td><td><strong>Palet başına bir satır</strong> oluşturur. 5 paletlik tek teslimat 5 <code>raw_materials</code> satırı oluşturur, her birinin kendi QR kodu (A1, A2...), lot numarası ve ölçülen ağırlığı olur.</td></tr>
            <tr><td>Kalay (raw_tin)</td><td>POST /materials/entry</td><td><strong>Tek satır</strong> oluşturur. Tek ağırlık girişi. Lot numarası otomatik: TIN-{sıra}.</td></tr>
            <tr><td>Plastik, Katalizör, Boya, Antirodent</td><td>POST /materials/lot-entry</td><td><strong>Lot başına bir satır</strong> oluşturur. Her lotun kendi test fotoğrafları, ağırlığı ve adedi olur. Malzeme adı <code>supplier_materials</code> tablosundan çözümlenir.</td></tr>
            <tr><td>Palet</td><td>POST /materials/palette-entry</td><td><strong>Palet tipi başına bir satır</strong> oluşturur. QR ön eki I. Lot otomatik: PALET-{sıra}.</td></tr>
            <tr><td>Makara</td><td>POST /materials/reel-entry</td><td><strong>Makara tipi başına bir satır</strong> oluşturur. QR ön eki H. Lot otomatik: REEL-{sıra}.</td></tr>
        </table>

        <h3>4.4 Sipariş Grup Kodları</h3>
        <p>Malzeme siparişleri oluştururken, sistem mevcut en yüksek R numarasını bulup artırarak bir grup kodu (R1, R2, R3...) üretir:</p>

        <pre><span class="keyword">def</span> generate_order_group_code(db: Session) -&gt; str:
    <span class="comment"># Mevcut kodlardan en yüksek R numarasını al</span>
    result = db.query(func.max(MaterialOrder.order_group_code)).filter(
        MaterialOrder.order_group_code.isnot(None),
        MaterialOrder.order_group_code.like(<span class="string">'R%'</span>)
    ).scalar()

    <span class="keyword">if</span> result:
        match = re.search(r<span class="string">'R(\d+)'</span>, result)
        <span class="keyword">if</span> match:
            <span class="keyword">return</span> f<span class="string">"R{int(match.group(1)) + 1}"</span>
    <span class="keyword">return</span> <span class="string">"R1"</span></pre>

        <p>Aynı sevkiyattan gelen siparişler bir grup kodunu paylaşır. Bu, sistemin arayüzde gruplanmış siparişleri göstermesini ve birden fazla malzeme girişini aynı teslimat olayına bağlamasını sağlar.</p>

        <h3>4.5 Tarih Değişikliği Takibi</h3>
        <p>Bir siparişin beklenen tarihi değiştirildiğinde, güncelleme endpoint&rsquo;i değişikliği otomatik olarak kaydeder:</p>

        <pre><span class="comment"># Tarih gerçekten değiştiyse ve neden sağlandıysa, kaydet</span>
<span class="keyword">if</span> old_expected_date != new_expected_date:
    <span class="keyword">if</span> <span class="string">'date_change_reason'</span> <span class="keyword">in</span> data:
        date_change = MaterialOrderDateChange(
            order_id=order.id,
            old_date=old_expected_date,
            new_date=new_expected_date,
            reason_type=data[<span class="string">'date_change_reason'</span>],         <span class="comment"># supplier | solen | other</span>
            reason_detail=data.get(<span class="string">'date_change_detail'</span>),  <span class="comment"># serbest metin</span>
            changed_by=current_user.id
        )
        db.add(date_change)</pre>

        <p>Üç neden kategorisi: <code>supplier</code> (tedarikçi kaynaklı gecikme), <code>solen</code> (Solen dahili kaynaklı gecikme), <code>other</code> (manuel açıklama gerektirir). Bu, tedarik performans analizi için bir hesap verebilirlik izi oluşturur.</p>

        <h3>4.6 Malzeme Hesaplayıcı Servisi</h3>
        <p><code>material_calculator.py</code> (478 satır) veritabanı bağımlılığı olmayan saf bir hesaplama servisidir. Sağladıkları:</p>

        <div class="arch-grid">
            <div class="arch-box">
                <h4>Bakır Hesaplama</h4>
                <p><code>calculate_copper(wire_groups, length_meters, bunching_stages)</code><br>
                Tel çapı&rarr;adet haritası alır (ör. 6mm&sup2; için {0.30: 73}), sabitlerden tel başı ağırlık uygular, uzunlukla çarpar ve çok aşamalı büküm için bileşik büküm faktörü uygular. Toplam kg döner.</p>
            </div>
            <div class="arch-box">
                <h4>Kalay Hesaplama</h4>
                <p><code>calculate_tin(copper_kg)</code><br>
                Basit yüzde: copper_kg &times; TIN_COATING_FACTOR (~%0.7). Kalay kaplama 1.8mm tel üzerinde ~4&mu;m kalınlığındadır.</p>
            </div>
            <div class="arch-box">
                <h4>Plastik Hesaplama</h4>
                <p><code>calculate_plastic_weight(inner_dia, thickness, density, length, is_first_layer, num_cables)</code><br>
                Silindirik hacim: &pi; &times; (R&sup2; &minus; r&sup2;) &times; uzunluk. Bakır üzerindeki ilk katman pürüzlü yüzey için %14 aşırı dolgu alır. İkiz kablolar num_cables ile çarpılır. Hacim &times; yoğunluk = ağırlık.</p>
            </div>
            <div class="arch-box">
                <h4>Katman Hesaplama</h4>
                <p><code>calculate_layer(...)</code><br>
                Tüm malzeme alternatifleriyle birlikte tam katman. Her alternatif seçim için plastik + katalizör + boya hesaplar. En kötü durum tedarik planlaması için tüm seçenekler arasında maksimum değerleri döner.</p>
            </div>
        </div>

        <h3>4.7 Yetki Sistemi</h3>
        <p>Modül hibrit bir yetki yaklaşımı kullanır:</p>
        <ul>
            <li><strong>Rol bazlı:</strong> Malzeme girişi <code>lab_user</code> veya <code>super_admin</code> gerektirir. Malzeme güncellemeleri <code>super_admin</code> gerektirir. Kalıcı silmeler <code>super_admin</code> gerektirir.</li>
            <li><strong>Akıllı yetki kontrolü:</strong> Tedarikçi route&rsquo;ları, hem eski rol bazlı sistem hem de yeni ultra-granüler sayfa-buton yetki sistemiyle aynı anda çalışan <code>check_permission_smart()</code> kullanır.</li>
            <li><strong>Frontend kaydı:</strong> Her sayfa butonlarını <code>registerPageButtons()</code> ile yetki sistemine kaydeder ve hangi eylemlerin var olduğunu tam olarak bildirir (ör. <code>add_copper</code>, <code>add_tin</code>, <code>upload_delivery_photo</code>, <code>print_qr_modal</code>).</li>
        </ul>

        <h3>4.8 WebSocket Entegrasyonu</h3>
        <p>Üç varlık türü gerçek zamanlı güncellemeler yayınlar:</p>
        <pre><span class="comment"># Malzeme oluşturma sonrası</span>
<span class="keyword">await</span> broadcast_update(<span class="string">"materials"</span>, <span class="string">"create"</span>, {<span class="string">"id"</span>: material.id, <span class="string">"qr_code"</span>: material.qr_code})

<span class="comment"># Malzeme güncelleme sonrası</span>
<span class="keyword">await</span> broadcast_update(<span class="string">"materials"</span>, <span class="string">"update"</span>, {<span class="string">"id"</span>: material.id, <span class="string">"qr_code"</span>: material.qr_code})

<span class="comment"># Malzeme silme sonrası</span>
<span class="keyword">await</span> broadcast_update(<span class="string">"materials"</span>, <span class="string">"delete"</span>, {<span class="string">"id"</span>: material_id, <span class="string">"qr_code"</span>: qr_code})

<span class="comment"># Tedarikçiler de yayınlar</span>
<span class="keyword">await</span> broadcast_update(<span class="string">"suppliers"</span>, <span class="string">"create"</span>, {<span class="string">"id"</span>: new_supplier.id, <span class="string">"name"</span>: new_supplier.name})</pre>

        <h3>4.9 Yazdırma Kuyruğu Entegrasyonu</h3>
        <p>Malzeme QR kodu yazdırma <strong>engelleyici değildir</strong>. <code>POST /materials/print/{material_id}</code> endpoint&rsquo;i, yazıcıyı beklerken HTTP isteğini engellemek yerine yazdırma kuyruğu sistemine yönlendirir. Sistem <code>GET /materials/print/preview/{material_id}</code> ile önizleme görüntüsü (base64) üretir ve <code>POST /materials/print/update-printer-ip</code> ile yazıcı IP yapılandırmasına izin verir.</p>

        <!-- ============================================ -->
        <h2 id="sec-5">5. FRONTEND</h2>
        <!-- ============================================ -->

        <p>Ant Design Pro ile inşa edilmiş 4 React sayfası, toplamda ~5.100 satır TypeScript. Tüm sayfalar koşullu stillendirme ile karanlık mod desteğine sahiptir.</p>

        <h3>5.1 Sayfa Haritası</h3>

        <table>
            <tr><th>Route</th><th>Bileşen</th><th>Satır</th><th>Amaç</th></tr>
            <tr><td>/hammadde/hammadde-girisi</td><td>Lab/MaterialEntry</td><td>1.930</td><td>8 malzeme türü kartıyla malzeme girişi, fotoğraf yükleme, sipariş bağlama</td></tr>
            <tr><td>/hammadde/hammaddeler-listesi</td><td>Hammadde/HammaddelerListesi</td><td>1.153</td><td>Lazy fotoğraf önizlemeleriyle ProTable, CRUD, yazdırma, durum yönetimi</td></tr>
            <tr><td>/hammadde/hammadde-siparis</td><td>Hammadde/HammaddeSiparis</td><td>1.237</td><td>Tarih değişikliği geçmişi, gruplama, puanlama ile sipariş takibi</td></tr>
            <tr><td>/hammadde/tedarikci-yonetimi</td><td>Lab/SupplierManagement</td><td>761</td><td>İç içe malzeme türleriyle tedarikçi CRUD, arama, gerçek zamanlı güncellemeler</td></tr>
        </table>

        <h3>5.2 Temel Frontend Desenleri</h3>

        <div class="arch-grid">
            <div class="arch-box">
                <h4>Kart Bazlı Malzeme Seçimi</h4>
                <p>Malzeme Girişi, birincil navigasyon olarak 8 renkli kart kullanır (bakır=turuncu, kalay=camgöbeği, plastik=mor vb.). Her kart türü, türe özgü alanlarla farklı bir modal form açar. Renkler tema duyarlıdır &mdash; karanlık modda 0.12 opaklık ile rgba kullanılarak soluklaştırılır.</p>
            </div>
            <div class="arch-box">
                <h4>Lazy Fotoğraf Yükleme</h4>
                <p><code>LazyPhotoThumbnail</code> bileşeni fotoğrafları <code>GET /materials/photo/{id}</code> ile tek tek yükler. Tıklandığında, o malzemenin TÜM fotoğraflarını yükler ve gezinmeli galeri görünümü açar. Bu desen, binlerce malzeme olsa bile liste sayfasını hızlı tutar.</p>
            </div>
            <div class="arch-box">
                <h4>Sipariş Bağlama UX</h4>
                <p>Malzeme girerken, kullanıcı isteğe bağlı olarak bağlanacak bekleyen bir satın alma siparişi seçebilir. Sistem, <code>GET /material-orders/pending-by-type/{type}</code> ile tedarikçi ve beklenen tarihe göre gruplanmış bekleyen siparişleri çeker ve seçilen siparişten tedarikçi bilgisini otomatik doldurur.</p>
            </div>
            <div class="arch-box">
                <h4>Gerçek Zamanlı WebSocket Güncellemeleri</h4>
                <p>Hem Hammaddeler Listesi hem de Tedarikçi Yönetimi, sırasıyla <code>materials</code> ve <code>suppliers</code> odalarına abone olan <code>useWebSocket</code> hook&rsquo;unu kullanır. Herhangi bir oluşturma/güncelleme/silme olayında ProTable <code>actionRef.current?.reload()</code> ile otomatik yenilenir.</p>
            </div>
        </div>

        <h3>5.3 Malzeme Türleri ve Renkleri</h3>
        <table>
            <tr><th>Tür</th><th>QR Ön Eki</th><th>Renk</th><th>Giriş Yöntemi</th></tr>
            <tr><td>Bakır</td><td>A</td><td style="background:#fff7e6;">Turuncu</td><td>Form + ölçülen ağırlıklarla çoklu palet</td></tr>
            <tr><td>Kalay</td><td>B</td><td style="background:#e6fffb;">Camgöbeği</td><td>Tek ağırlık girişi</td></tr>
            <tr><td>Plastik</td><td>C</td><td style="background:#f9f0ff;">Mor</td><td>Lot başına test fotoğraflarıyla lot bazlı</td></tr>
            <tr><td>Katalizör</td><td>D</td><td style="background:#f6ffed;">Yeşil</td><td>Lot başına test fotoğraflarıyla lot bazlı</td></tr>
            <tr><td>Boya</td><td>E</td><td style="background:#fff0f6;">Pembe</td><td>Lot başına test fotoğraflarıyla lot bazlı</td></tr>
            <tr><td>Antirodent</td><td>F</td><td style="background:#e6fffb;">Deniz Mavisi</td><td>Lot başına test fotoğraflarıyla lot bazlı</td></tr>
            <tr><td>Palet</td><td>I</td><td style="background:#fcffe6;">Yeşil Sarı</td><td>Palet tipi başına adet</td></tr>
            <tr><td>Makara</td><td>H</td><td style="background:#fffbe6;">Altın</td><td>Makara tipi başına adet</td></tr>
        </table>

        <!-- ============================================ -->
        <h2 id="sec-6">6. ALT MODÜLLER</h2>
        <!-- ============================================ -->

        <p>Hammadde modülü, her biri ham malzeme yönetiminin farklı bir yönünü ele alan 4 alt modülden oluşur. Aşağıdaki bölümler her birini derinlemesine inceleyecektir.</p>

        <div class="submod-card">
            <div class="submod-num">6.1</div>
            <div class="submod-body">
                <h4>Tedarikçi Yönetimi (Supplier Management)</h4>
                <p>Bire-çok malzeme ilişkileriyle tedarikçi şirket yönetimi. İç içe malzeme listeleriyle tedarikçi oluşturma, her malzeme türü kendi özelliklerini taşır (yoğunluk, boyut, makara tipi). Akıllı yetki kontrolü, gerçek zamanlı WebSocket güncellemeleri, FK bağımlılık korumasıyla kalıcı silme. Başlangıç noktası &mdash; kayıtlı tedarikçi olmadan hiçbir şey sipariş edilemez veya girilemez.</p>
                <div class="submod-tags">
                    <span class="submod-tag">761 SATIR</span>
                    <span class="submod-tag">1:N MALZEMELER</span>
                    <span class="submod-tag">AKILLI YETKİLER</span>
                    <span class="submod-tag">GERÇEK ZAMANLI</span>
                    <span class="submod-tag">FK KORUMA</span>
                </div>
            </div>
        </div>

        <div class="submod-card">
            <div class="submod-num">6.2</div>
            <div class="submod-body">
                <h4>Hammadde Sipariş (Material Orders)</h4>
                <p>Sipariş grup kodları (R1, R2...) ile satın alma sipariş takibi, kategorize edilmiş nedenlerle (tedarikçi/solen/diğer) tarih değişikliği geçmişi, teslimat miktarı takibi, teslimat sonrası tedarikçi puanlaması (yarım artışlarla 0.5&ndash;5 yıldız) ve durum yaşam döngüsü yönetimi.</p>
                <div class="submod-tags">
                    <span class="submod-tag">1.237 SATIR</span>
                    <span class="submod-tag">SİPARİŞ GRUPLARI</span>
                    <span class="submod-tag">TARİH TAKİBİ</span>
                    <span class="submod-tag">TEDARİKÇİ PUANLAMA</span>
                    <span class="submod-tag">7 ENDPOINT</span>
                </div>
            </div>
        </div>

        <div class="submod-card">
            <div class="submod-num">6.3</div>
            <div class="submod-body">
                <h4>Hammadde Girişi (Material Entry)</h4>
                <p>1.930 satırlık giriş sayfası. 8 malzeme türü kartı, çoklu palet bakır girişi, lot bazlı kimyasal giriş, fotoğraf yüklemeleri (irsaliye + test raporları, her birinden en fazla 3), QR kod oluşturma ve yazdırma, teslimat takibi için sipariş bağlama. Modüldeki en büyük ve en karmaşık sayfa.</p>
                <div class="submod-tags">
                    <span class="submod-tag">1.930 SATIR</span>
                    <span class="submod-tag">14 ENDPOINT</span>
                    <span class="submod-tag">8 MALZEME TÜRÜ</span>
                    <span class="submod-tag">QR KODLAR</span>
                    <span class="submod-tag">FOTOĞRAF YÜKLEME</span>
                </div>
            </div>
        </div>

        <div class="submod-card">
            <div class="submod-num">6.4</div>
            <div class="submod-body">
                <h4>Hammaddeler Listesi (Materials List)</h4>
                <p>ProTable ile tam envanter görünümü. Lazy-loaded fotoğraf önizlemeleri, malzeme durum yönetimi (received/approved/in_use/consumed/rejected), QR kodu değiştirme ile düzenleme, bağımlılık kontrolüyle kalıcı silme, kalan ağırlık takibi ve QR kod yazdırma kuyruğu entegrasyonu.</p>
                <div class="submod-tags">
                    <span class="submod-tag">1.153 SATIR</span>
                    <span class="submod-tag">PROTABLE</span>
                    <span class="submod-tag">LAZY FOTOĞRAFLAR</span>
                    <span class="submod-tag">GERÇEK ZAMANLI</span>
                    <span class="submod-tag">YAZICI KUYRUĞU</span>
                </div>
            </div>
        </div>

        <!-- ============================================ -->
        <h2 id="sec-6-1">6.1 TEDARİKÇİ YÖNETİMİ (SUPPLIER MANAGEMENT)</h2>
        <!-- ============================================ -->

        <p>Tüm Hammadde modülünün başlangıç noktası. Herhangi bir malzeme sipariş edilmeden veya sisteme girilmeden önce bir tedarikçi mevcut olmalıdır. Bu sayfa tedarikçi şirketlerini ve her birinin sağladığı spesifik malzemeleri yönetir.</p>

        <h3>6.1.1 Ne Yapar</h3>
        <p>Tedarikçi Yönetimi <strong>bire-çok ilişkiyi</strong> yönetir: bir tedarikçi şirket birden fazla malzeme türü sağlayabilir. &ldquo;ORMETSAN&rdquo; gibi tek bir tedarikçi hem bakır tel çubuğu hem de kalay külçesi sağlayabilirken, &ldquo;BETEK&rdquo; 3 farklı plastik bileşeni, 2 katalizör ve bir boya sağlayabilir &mdash; hepsi aynı şirket altında ayrı malzeme girişleri olarak kayıtlıdır.</p>

        <p>Sayfa şunları sunar:</p>
        <ul>
            <li>Tüm alanlarda istemci taraflı arama ile ProTable (Türkçe malzeme türü adları dahil)</li>
            <li>Malzeme türüne göre dinamik koşullu alanlarla Oluştur/Düzenle modalı</li>
            <li>Tabloda sayı rozetleri ve detay ipuçlarıyla malzeme türü gruplandırması</li>
            <li>Yumuşak silme (aktif/pasif geçişi) ve FK bağımlılık korumasıyla kalıcı silme</li>
            <li>Tüm bağlı istemciler arasında gerçek zamanlı WebSocket güncellemeleri</li>
        </ul>

        <h3>6.1.2 API Kontratı</h3>

        <table>
            <tr><th>Metot</th><th>Yol</th><th>Fonksiyon</th><th>Yetki</th></tr>
            <tr><td>POST</td><td>/api/suppliers/create</td><td>create_supplier</td><td>Akıllı: lab_user VEYA hammadde.tedarikci-yonetimi.create_supplier</td></tr>
            <tr><td>GET</td><td>/api/suppliers/list</td><td>get_suppliers</td><td>Herhangi kimliği doğrulanmış kullanıcı</td></tr>
            <tr><td>GET</td><td>/api/suppliers/by-material/{type}</td><td>get_suppliers_by_material</td><td>Herhangi kimliği doğrulanmış kullanıcı</td></tr>
            <tr><td>GET</td><td>/api/suppliers/materials-list</td><td>get_supplier_materials_list</td><td>Herhangi kimliği doğrulanmış kullanıcı</td></tr>
            <tr><td>GET</td><td>/api/suppliers/{id}</td><td>get_supplier</td><td>Herhangi kimliği doğrulanmış kullanıcı</td></tr>
            <tr><td>PUT</td><td>/api/suppliers/{id}</td><td>update_supplier</td><td>Herhangi kimliği doğrulanmış kullanıcı</td></tr>
            <tr><td>PUT</td><td>/api/suppliers/{id}/toggle-status</td><td>toggle_supplier_status</td><td>Akıllı: super_admin VEYA deactivate_supplier</td></tr>
            <tr><td>DELETE</td><td>/api/suppliers/{id}/hard-delete</td><td>hard_delete_supplier</td><td>Akıllı: super_admin VEYA hard_delete_supplier</td></tr>
        </table>

        <h3>6.1.3 CRUD Akışı</h3>

        <p><strong>Oluşturma:</strong></p>
        <ol>
            <li>Araç çubuğundaki &ldquo;Yeni Tedarikçi&rdquo; butonuna tıkla</li>
            <li>Modal açılır: firma adı + dinamik malzeme bölümü (başlangıçta bir boş malzeme kartı)</li>
            <li>Malzeme tipi seç &rarr; koşullu alanlar belirir (plastik için yoğunluk, palet için boyut, makara için boyut+reel_type, bakır/kalay için ek alan yok)</li>
            <li>Aynı tedarikçiye daha fazla malzeme eklemek için &ldquo;+&rdquo; tıkla</li>
            <li>Gönderimde: önyüz <code>undefined</code> değerleri temizler &rarr; <code>POST /api/suppliers/create</code></li>
            <li>Başarılı: toast &ldquo;Tedarikçi başarıyla oluşturuldu&rdquo; &rarr; modal kapanır &rarr; WebSocket tüm istemcilere yayın yapar &rarr; tablo yenilenir</li>
        </ol>

        <p><strong>Düzenleme:</strong></p>
        <ol>
            <li>Eylemler sütunundaki düzenle ikonuna tıkla</li>
            <li>Modal, mevcut firma adı ve tüm malzeme kartlarıyla önceden dolu açılır</li>
            <li>Kullanıcı adı değiştirebilir, malzeme ekleyebilir/kaldırabilir/değiştirebilir</li>
            <li>Gönderimde: <code>PUT /api/suppliers/{id}</code> &rarr; backend malzemeler için <strong>sil-ve-yeniden-oluştur</strong> stratejisi kullanır (mevcut TÜM supplier_materials silinir, sıfırdan yenileri oluşturulur)</li>
            <li>Başarılı: toast &ldquo;Tedarikçi başarıyla güncellendi&rdquo; &rarr; modal kapanır &rarr; WebSocket yayını &rarr; tablo yenilenir</li>
        </ol>

        <p><strong>Pasif Silme (Devre Dışı Bırakma):</strong></p>
        <ol>
            <li>Eylemler sütunundaki durum değiştir ikonuna tıkla</li>
            <li>Popconfirm: &ldquo;Bu tedarikçiyi devre dışı bırakmak istediğinize emin misiniz?&rdquo;</li>
            <li>Onayda: <code>PUT /api/suppliers/{id}/toggle-status</code></li>
            <li>Tedarikçi satırı &ldquo;inactive&rdquo; olur &mdash; tabloda hala görünür ama grileştirilmiş. Aynı yolla yeniden etkinleştirilebilir.</li>
        </ol>

        <p><strong>Kalıcı Silme:</strong></p>
        <ol>
            <li>Eylemler sütunundaki sil ikonuna tıkla (<code>hard_delete_supplier</code> yetkisi gerekir)</li>
            <li>Güçlü uyarı metinli Popconfirm</li>
            <li>Onayda: <code>DELETE /api/suppliers/{id}/hard-delete</code></li>
            <li>Backend bağımlı <code>raw_materials</code> satırlarını kontrol eder &mdash; varsa silme <strong>engellenir</strong>: &ldquo;Bu tedarikçiye ait {n} hammadde kaydı var. Önce hammaddeleri silin.&rdquo;</li>
            <li>Bağımlılık yoksa: önce supplier_materials silinir (cascade), sonra supplier &rarr; WebSocket yayını &rarr; tablo yenilenir</li>
        </ol>

        <h3>6.1.4 Koşullu Form Mantığı</h3>
        <p>Oluştur/düzenle modalı dinamik bir malzemeler bölümü içerir. Her malzeme kartı <strong>seçilen malzeme türüne göre farklı alanlar</strong> gösterir:</p>

        <table>
            <tr><th>Malzeme Türü</th><th>Gösterilen Alanlar</th><th>Örnek</th></tr>
            <tr><td>Bakır, Kalay</td><td><em>Ek alan yok</em> &mdash; &ldquo;Bu malzeme için ek bilgi gerekmez&rdquo;</td><td>&mdash;</td></tr>
            <tr><td>Plastik, Katalizör, Boya, Antirodent</td><td>material_name + density (g/cm&sup3;)</td><td>HF-500, 1.42 g/cm&sup3;</td></tr>
            <tr><td>Palet</td><td>material_name + boyut (ölçüler)</td><td>Euro Palet, 120x80x15 cm</td></tr>
            <tr><td>Makara</td><td>material_name + boyut + reel_type</td><td>300mm Makara, 300x150 mm, Yazılı</td></tr>
        </table>

        <p>Malzeme türü açılır menüsü değiştiğinde tüm koşullu alanlar <strong>temizlenir</strong>:</p>

        <pre><span class="keyword">const</span> updateMaterial = (index: number, field: keyof MaterialItem, value: any) =&gt; {
    <span class="keyword">const</span> newMaterials = [...materials];
    newMaterials[index] = { ...newMaterials[index], [field]: value };

    <span class="comment">// Tür değiştiğinde koşullu alanları temizle</span>
    <span class="keyword">if</span> (field === <span class="string">'material_type'</span>) {
        newMaterials[index].material_name = <span class="keyword">undefined</span>;
        newMaterials[index].density = <span class="keyword">undefined</span>;
        newMaterials[index].boyut = <span class="keyword">undefined</span>;
        newMaterials[index].reel_type = <span class="keyword">undefined</span>;
    }

    setMaterials(newMaterials);
};</pre>

        <p>Kullanıcılar sınırsız malzeme ekleyebilir (&ldquo;Malzeme Ekle&rdquo; kesikli butonu ile) ve sonuncusu hariç herhangi birini kaldırabilir (minimum 1 malzeme gereklidir). Yeni malzemeler ilki için <code>copper</code>, sonrakiler için <code>plastic</code> varsayılanıyla eklenir.</p>

        <h3>6.1.5 Backend Doğrulama Zinciri</h3>
        <p>Veri veritabanına ulaşmadan önce üç Pydantic doğrulayıcısı tetiklenir:</p>

        <h4>İsim Doğrulayıcı</h4>
        <pre><span class="decorator">@validator</span>(<span class="string">'name'</span>)
<span class="keyword">def</span> validate_name(cls, v):
    <span class="keyword">if</span> <span class="keyword">not</span> v <span class="keyword">or</span> <span class="keyword">not</span> v.strip():
        <span class="keyword">raise</span> ValueError(<span class="string">'Tedarikçi adı boş olamaz'</span>)
    <span class="keyword">if</span> any(char <span class="keyword">in</span> v <span class="keyword">for</span> char <span class="keyword">in</span> [<span class="string">'@'</span>, <span class="string">'#'</span>, <span class="string">'$'</span>, <span class="string">'%'</span>, <span class="string">'^'</span>, <span class="string">'&amp;'</span>, <span class="string">'*'</span>]):
        <span class="keyword">raise</span> ValueError(<span class="string">'Tedarikçi adı özel karakterler içeremez'</span>)
    <span class="keyword">return</span> v.strip().upper()  <span class="comment"># Her zaman BÜYÜK HARF olarak saklanır</span></pre>

        <h4>Telefon Doğrulayıcı</h4>
        <pre><span class="decorator">@validator</span>(<span class="string">'phone'</span>)
<span class="keyword">def</span> validate_phone(cls, v):
    <span class="comment"># TÜM rakam olmayanları sıyır: boşluk, tire, parantez, artı, nokta</span>
    clean = v.replace(<span class="string">' '</span>,<span class="string">''</span>).replace(<span class="string">'-'</span>,<span class="string">''</span>).replace(<span class="string">'('</span>,<span class="string">''</span>).replace(<span class="string">')'</span>,<span class="string">''</span>).replace(<span class="string">'+'</span>,<span class="string">''</span>).replace(<span class="string">'.'</span>,<span class="string">''</span>)

    <span class="comment"># +90 ülke kodunu kaldır → 0xxx</span>
    <span class="keyword">if</span> clean.startswith(<span class="string">'90'</span>) <span class="keyword">and</span> len(clean) &gt; 10:
        clean = <span class="string">'0'</span> + clean[2:]    <span class="comment"># +90 212 → 0212</span>

    <span class="comment"># Otomatik biçimlendir: "0212 555 1234"</span>
    <span class="keyword">if</span> len(clean) == 10:
        <span class="keyword">return</span> f<span class="string">"{clean[:4]} {clean[4:7]} {clean[7:]}"</span>
    <span class="keyword">elif</span> len(clean) == 11:       <span class="comment"># Mobil: 05xx xxx xxxx</span>
        <span class="keyword">return</span> f<span class="string">"{clean[:4]} {clean[4:7]} {clean[7:]}"</span></pre>

        <h4>E-posta Doğrulayıcı</h4>
        <p>Standart regex kontrolü: <code>^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$</code></p>

        <div class="finding">
            <p style="margin-bottom: 0;"><strong>Duplikasyon koruması:</strong> Oluşturmadan önce backend <code>Supplier.name == supplier_data.name.upper()</code> kontrolü yapar. İsimler her zaman büyük harf olarak saklandığından, &ldquo;ormetsan&rdquo;, &ldquo;ORMETSAN&rdquo; ve &ldquo;Ormetsan&rdquo; hepsi aynı tedarikçi olarak değerlendirilir. 400 döner: &ldquo;Bu tedarikçi zaten kayıtlı&rdquo;.</p>
        </div>

        <h3>6.1.6 Güncelleme Stratejisi: Sil-ve-Yeniden Oluştur</h3>
        <p>Bir tedarikçinin malzemeleri güncellenirken, backend bireysel kayıtları <strong>yamamamaz</strong>. Bunun yerine TÜM mevcut <code>supplier_materials</code> satırlarını siler ve yenilerini oluşturur:</p>

        <pre><span class="comment"># Malzemeler sağlandıysa güncelle</span>
<span class="keyword">if</span> supplier_data.materials <span class="keyword">is not</span> None:
    <span class="comment"># TÜM eski malzemeleri sil</span>
    db.query(SupplierMaterial).filter(
        SupplierMaterial.supplier_id == supplier_id
    ).delete()

    <span class="comment"># Sıfırdan yeni malzemeler oluştur</span>
    <span class="keyword">for</span> material_data <span class="keyword">in</span> supplier_data.materials:
        supplier_material = SupplierMaterial(
            supplier_id=supplier.id,
            material_type=material_data.material_type.value,
            material_name=material_data.material_name,
            density=material_data.density,
            boyut=material_data.boyut,
            reel_type=material_data.reel_type,
            is_active=True
        )
        db.add(supplier_material)</pre>

        <div class="warning">
            <p style="margin-bottom: 0;"><strong>Neden sil-ve-yeniden oluştur?</strong> Bu, mantığı muazzam ölçüde basitleştirir. Alternatif &mdash; mevcut kayıtları karşılaştırmak, değişenleri güncellemek, kaldırılanları silmek, yenilerini eklemek &mdash; frontend&rsquo;de malzeme ID&rsquo;lerini takip etmeyi ve karmaşık birleştirme mantığını yönetmeyi gerektirir. supplier_materials&rsquo;ın diğer tablolardan gelen yabancı anahtarı olmadığından (material_orders supplier_material_id&rsquo;ye bağlanır ama siparişler belirli bir malzeme girişine referans verir), bu yaklaşım güvenli ve deterministiktir.</p>
        </div>

        <h3>6.1.7 FK Korumasıyla Kalıcı Silme</h3>
        <p>Bir tedarikçiyi kalıcı olarak silmeden önce, backend bağımlı hammaddeleri kontrol eder:</p>

        <pre><span class="comment"># Tedarikçinin hammaddeleri var mı kontrol et (FK nedeniyle engellenir)</span>
has_materials = db.query(RawMaterial).filter(
    RawMaterial.supplier_id == supplier_id
).count()

<span class="keyword">if</span> has_materials &gt; 0:
    <span class="keyword">raise</span> HTTPException(
        status_code=400,
        detail=f<span class="string">"Bu tedarikçiye ait {has_materials} hammadde kaydı var. Önce hammaddeleri silin."</span>
    )</pre>

        <p>Kontrol geçerse, silme sırası: önce <code>supplier_materials</code> (cascade), sonra <code>supplier</code> kendisi. Hemen ardından bir WebSocket yayını gelir.</p>

        <h3>6.1.8 Türkçe Eşleştirmeli İstemci Taraflı Arama</h3>
        <p>Arama çubuğu, iç içe malzemeler dahil <strong>tüm alanlarda</strong> Türkçe çevirilerle filtreleme yapar:</p>

        <pre><span class="keyword">const</span> materialTurkish: Record&lt;string, string&gt; = {
    copper: <span class="string">'bakır'</span>,    tin: <span class="string">'kalay'</span>,
    plastic: <span class="string">'plastik'</span>,  catalyst: <span class="string">'katalizör'</span>,
    dye: <span class="string">'boya'</span>,        antirodent: <span class="string">'antirodent'</span>,
    palette: <span class="string">'palet'</span>,    reel: <span class="string">'makara'</span>,
};

<span class="comment">// Arama kontrol eder: name, contact_person, phone, email,</span>
<span class="comment">// tax_number, address, durum (aktif/pasif), id,</span>
<span class="comment">// material_type (EN + TR), material_name</span></pre>

        <p>&ldquo;bakır&rdquo; yazmak bakır sağlayan tüm tedarikçileri bulur. &ldquo;HF-500&rdquo; yazmak o spesifik plastiği sağlayan tedarikçiyi bulur. &ldquo;pasif&rdquo; yazmak sadece devre dışı bırakılmış tedarikçileri gösterir.</p>

        <h3>6.1.9 Malzemeler Kolonu: Gruplama ve İpuçları</h3>
        <p>Tablonun &ldquo;Malzemeler&rdquo; kolonu malzemeleri türe göre gruplar ve sayıları gösterir:</p>
        <ul>
            <li>Bir tedarikçi 1 plastik sağlıyorsa &rarr; <code>Plastik</code> etiketi gösterir</li>
            <li>Bir tedarikçi 3 plastik sağlıyorsa &rarr; <code>Plastik (3)</code> etiketi gösterir</li>
            <li>Herhangi bir etiketin üzerine gelindiğinde tüm malzeme detaylarını gösteren ipucu görünür: ad, yoğunluk, boyutlar</li>
            <li>Her malzeme türü tutarlı bir renk alır: bakır=turuncu, kalay=mavi, plastik=mor, katalizör=yeşil, boya=magenta, antirodent=camgöbeği, palet=yeşil sarı, makara=altın</li>
        </ul>

        <h3>6.1.10 Benzersiz Özellikler Endpoint&rsquo;i</h3>
        <p><code>GET /suppliers/materials-list</code> endpoint&rsquo;i özel bir amaca hizmet eder: tüm tedarikçiler arasında <strong>tekilleştirilmiş malzeme özelliklerini</strong> döner. 3 farklı tedarikçi hepsi 1.42 g/cm&sup3; yoğunlukta &ldquo;HF-500&rdquo; plastik sağlıyorsa, endpoint bunu bir kez döner. Tekilleştirme anahtarı: <code>material_name|boyut|reel_type</code>. Bu, diğer sayfalar (Malzeme Girişi, Malzeme Siparişleri) tarafından duplikasız açılır menü seçenekleri göstermek için kullanılır.</p>

        <h3>6.1.11 Yetki Mimarisi</h3>
        <p>Sayfa 8 kayıtlı butonla hibrit bir yetki modeli kullanır:</p>

        <pre><span class="comment">// Frontend mevcut TÜM eylemleri kaydeder</span>
registerPageButtons({
    pageId: <span class="string">'hammadde.tedarikci-yonetimi'</span>,
    buttons: [
        { id: <span class="string">'access_page'</span>,          label: <span class="string">'Sayfaya Erişim'</span> },
        { id: <span class="string">'view_table'</span>,           label: <span class="string">'Tablo Görüntüle'</span> },
        { id: <span class="string">'create_supplier'</span>,      label: <span class="string">'Yeni Tedarikçi'</span> },
        { id: <span class="string">'edit_supplier'</span>,        label: <span class="string">'Düzenle'</span> },
        { id: <span class="string">'add_material'</span>,         label: <span class="string">'Malzeme Ekle'</span> },
        { id: <span class="string">'remove_material'</span>,      label: <span class="string">'Malzeme Kaldır'</span> },
        { id: <span class="string">'deactivate_supplier'</span>,  label: <span class="string">'Pasifleştir'</span> },
        { id: <span class="string">'hard_delete_supplier'</span>, label: <span class="string">'Kalıcı Sil'</span>, critical: true }
    ]
});</pre>

        <p>Backend, sırasıyla üç katmanı kontrol eden <code>check_permission_smart()</code> kullanır: (1) super_admin her zaman geçer, (2) eski rol bazlı kontrol (user_type gerekli listede), (3) yeni ultra-granüler sayfa.buton yetkisi. Herhangi bir katman geçerse eylem izin verilir. Bu, rol bazlıdan buton düzeyine geçiş sırasında geriye uyumluluğu sağlar.</p>

        <h3>6.1.12 Gerçek Zamanlı Güncellemeler</h3>
        <p>Üç tedarikçi işlemi WebSocket olayları yayınlar:</p>
        <ul>
            <li><code>broadcast_update("suppliers", "create", {id, name})</code> &mdash; başarılı oluşturma sonrası</li>
            <li><code>broadcast_update("suppliers", "update", {id, name})</code> &mdash; güncelleme veya durum geçişi sonrası</li>
            <li><code>broadcast_update("suppliers", "delete", {id, name})</code> &mdash; kalıcı silme sonrası</li>
        </ul>
        <p>Frontend <code>['suppliers', 'all']</code> odalarına abone olur ve herhangi bir olayda tam tablo yenilemesini tetikleyen <code>actionRef.current?.reload()</code> çağırır.</p>

        <h3>6.1.13 Performans İçin Eager Loading</h3>
        <p>Liste endpoint&rsquo;i, tedarikçileri malzemeleriyle birlikte tek bir sorguda çekmek için SQLAlchemy&rsquo;nin <code>joinedload</code> kullanır:</p>

        <pre>query = db.query(Supplier).options(
    joinedload(Supplier.materials_provided)
)</pre>

        <p>Bu olmadan, 50 tedarikçi listelemek her birinin malzemelerini çekmek için 50 ek sorgu tetiklerdi (N+1 problemi). Eager loading ile tek bir JOIN sorgusudur.</p>

        <h3>6.1.14 Gönderim Öncesi Veri Temizleme</h3>
        <p>Frontend, Pydantic&rsquo;in reddedeceği <code>undefined</code> değerleri sıyırarak malzeme dizisini backend&rsquo;e göndermeden önce temizler:</p>

        <pre><span class="keyword">const</span> cleanedMaterials = materials.map(mat =&gt; {
    <span class="keyword">const</span> cleaned: any = { material_type: mat.material_type };
    <span class="keyword">if</span> (mat.material_name !== <span class="keyword">undefined</span> &amp;&amp; mat.material_name !== <span class="string">''</span>)
        cleaned.material_name = mat.material_name;
    <span class="keyword">if</span> (mat.density !== <span class="keyword">undefined</span> &amp;&amp; mat.density !== <span class="keyword">null</span>)
        cleaned.density = mat.density;
    <span class="keyword">if</span> (mat.boyut !== <span class="keyword">undefined</span> &amp;&amp; mat.boyut !== <span class="string">''</span>)
        cleaned.boyut = mat.boyut;
    <span class="keyword">if</span> (mat.reel_type !== <span class="keyword">undefined</span> &amp;&amp; mat.reel_type !== <span class="string">''</span>)
        cleaned.reel_type = mat.reel_type;
    <span class="keyword">return</span> cleaned;
});</pre>

        <div class="discovery">
            <p style="margin-bottom: 0;"><strong>Bu neden önemli:</strong> Temizleme olmadan, bir bakır malzemesi <code>{"material_type": "copper", "material_name": undefined, "density": undefined, "boyut": undefined, "reel_type": undefined}</code> olarak gönderilirdi. Pydantic bunları <code>None</code> olarak kabul ederdi, ancak JSON.stringify <code>undefined</code> değerlerini tamamen düşürür. Açık kontrol yalnızca anlamlı verilerin gönderilmesini sağlayarak API yükünü temiz ve öngörülebilir tutar.</p>
        </div>

        <h3>6.1.15 Tedarikçi Verisi Sistemde Nasıl Kullanılır</h3>
        <p>Tedarikçi Yönetimi bağımsız bir sayfa değildir. Oluşturduğu veri, Hammadde&rsquo;deki <strong>diğer tüm alt modüller</strong> ve ötesi tarafından tüketilir. Tedarikçi verisinin aktığı yerlerin tam haritası:</p>

        <h4>Malzeme Girişi (Hammadde Girişi) &mdash; Tedarikçi Seçimi</h4>
        <p>Kullanıcı herhangi bir malzeme kartına (bakır, kalay, plastik vb.) tıkladığında, giriş sayfası <code>GET /suppliers/list?active_only=true</code> çağırır ve her tedarikçinin <code>materials_provided</code> dizisini kontrol ederek yerel olarak filtreler. Yalnızca <code>supplier_materials</code> tablosunda o malzeme türü aktif olan tedarikçiler açılır menüde gösterilir. Bu şu anlama gelir: bir tedarikçiyi sadece &ldquo;bakır&rdquo; ve &ldquo;kalay&rdquo; ile kaydederseniz, plastik giriş formunda <strong>asla görünmezler</strong>.</p>

        <pre><span class="comment">// Malzeme Girişi: tedarikçileri malzeme türüne göre filtrele</span>
<span class="keyword">const</span> filterSuppliers = (materialType: string) =&gt; {
    <span class="keyword">const</span> filtered = suppliers.filter(supplier =&gt; {
        <span class="keyword">const</span> materials = supplier.materials_provided || [];
        <span class="keyword">return</span> materials.some(
            (mat: any) =&gt; mat.material_type === materialType &amp;&amp; mat.is_active
        );
    });
    setFilteredSuppliers(filtered);
};</pre>

        <h4>Malzeme Girişi &mdash; Malzeme Adı Çözümleme</h4>
        <p>Lot bazlı girişlerde (plastik, katalizör, boya, antirodent), bir lot oluşturulduğunda backend spesifik <code>material_name</code> değerini çözümlemek için <code>supplier_material_id</code> arar. Bu ad (ör. &ldquo;HF-500&rdquo;, &ldquo;CAT-203&rdquo;) doğrudan <code>raw_materials.material_name</code> kolonunda saklanır. Palet ve makaralar için ayrıca <code>boyut</code> ölçüsünü de ekler (ör. &ldquo;Euro Palet - 120x80x15 cm&rdquo;).</p>

        <pre><span class="comment"># Lot girişi: SupplierMaterial'dan malzeme adını çözümle</span>
<span class="keyword">if</span> material_type_id:
    supplier_material = db.query(SupplierMaterial).filter(
        SupplierMaterial.id == material_type_id
    ).first()
    <span class="keyword">if</span> supplier_material:
        material_name = supplier_material.material_name
        <span class="keyword">if</span> supplier_material.boyut:
            material_name = f<span class="string">"{material_name} - {supplier_material.boyut}"</span></pre>

        <h4>Malzeme Sipariş (Hammadde Sipariş) &mdash; Tedarikçi + Malzeme Seçimi</h4>
        <p>Satın alma siparişi oluştururken, kullanıcı önce bir tedarikçi seçer, sonra yalnızca o tedarikçinin sağladığı malzemeleri görür. Sipariş hem <code>supplier_id</code> (kim) hem de <code>supplier_material_id</code> (tam olarak ne) saklar. Bu bağlantı kritiktir: bir teslimat geldiğinde ve Malzeme Girişi üzerinden girildiğinde, sistem gelen malzemeleri bekleyen siparişleriyle eşleştirmek için <code>supplier_material_id</code> kullanır.</p>

        <h4>Malzeme Sipariş &mdash; Giriş Bağlama İçin Bekleyen Sipariş Grupları</h4>
        <p><code>GET /material-orders/pending-by-type/{material_type}</code> endpoint&rsquo;i bekleyen siparişleri <code>supplier_id + expected_date</code> bazında gruplanmış döner. Malzeme Girişi bunu &ldquo;Siparişe Bağla&rdquo; seçeneği göstermek için kullanır. Kullanıcı bir sipariş grubu seçtiğinde, sistem <code>supplier_material_id</code> ile anahtarlanmış bir <code>order_map</code> oluşturur, böylece girişteki her lot otomatik olarak ilgili sipariş satırına bağlanabilir.</p>

        <h4>Malzeme Hesaplayıcı &mdash; Tedarikçi Malzemelerinden Yoğunluk</h4>
        <p>Plastik, katalizör, boya ve antirodent bileşikleri için <code>supplier_materials</code> tablosunda saklanan <code>density</code> alanı, Malzeme Hesaplayıcı servisi tarafından kullanılır. Sipariş modülü bir sipariş için plastik ağırlığı hesapladığında (<code>hacim &times; yoğunluk = kg</code>), yoğunluk burada kayıtlı tedarikçi malzeme özelliklerinden gelir.</p>

        <h4>Açılır Menüler İçin Benzersiz Özellikler</h4>
        <p><code>GET /suppliers/materials-list</code> endpoint&rsquo;i tüm tedarikçiler arasında malzeme özelliklerini tekilleştirir ve benzersiz girişleri döner. Bu, Malzeme Siparişleri ve Malzeme Girişi&rsquo;ndeki açılır menüleri besler &mdash; kullanıcılar <em>ne</em> sipariş edeceklerini veya gireceklerini seçerken aynı &ldquo;HF-500&rdquo;&rsquo;ü üç farklı tedarikçiden üç kez görmezler.</p>

        <div class="insight">
            <p style="margin-bottom: 0;"><strong>Bağımlılık zinciri:</strong> Tedarikçi &rarr; supplier_materials (ne satıyorlar) &rarr; material_orders (ne sipariş ettik, supplier_material_id referansıyla) &rarr; raw_materials (ne geldi, material_order_id ile siparişe bağlı, material_name supplier_materials&rsquo;dan çözümlenmiş). Bir tedarikçiyi kaldırın, tüm bu zincir kırılır. FK korumasının kalıcı silmede var olmasının ve yumuşak silmenin (aktif/pasif) tercih edilen yaklaşım olmasının nedeni budur.</p>
        </div>


        <!-- ============================================= -->
        <!--  6.2  HAMMADDE SİPARİŞ (Malzeme Siparişleri) -->
        <!-- ============================================= -->

        <h2 id="sec-6-2">6.2 &mdash; Hammadde Sipari&#351; (Malzeme Sipari&#351;leri)</h2>

        <h3>6.2.1 &mdash; Ama&ccedil; ve &#304;&#351; Ba&#287;lam&#305;</h3>
        <p>Bu resmi bir sat&#305;n alma sipari&#351;i sistemi <strong>de&#287;ildir</strong>. Solen&rsquo;in hangi hammaddeleri hangi tedarik&ccedil;iden sipari&#351; etti&#287;ini, teslimat&#305; ne zaman bekledi&#287;ini ve ger&ccedil;ekte neyin geldi&#287;ini kaydeden bir <em>dahili takip arac&#305;d&#305;r</em>. Amac&#305;, sat&#305;n alma ve depo ekiplerine neyin gelece&#287;i, neyin gecikti&#287;i ve her tedarik&ccedil;inin ne kadar iyi performans g&ouml;sterdi&#287;i konusunda net bir tablo sunmakt&#305;r.</p>
        <p>Mod&uuml;l, Tedarik&ccedil;i Y&ouml;netimi (tedarik&ccedil;ilerin ve &uuml;r&uuml;n kataloglar&#305;n&#305;n tan&#305;mland&#305;&#287;&#305; yer) ile Hammadde Giri&#351;i (fiziksel teslimatlar&#305;n al&#305;nd&#305;&#287;&#305; yer) aras&#305;nda konumlan&#305;r. Burada olu&#351;turulan sipari&#351;ler, Hammadde Giri&#351;i i&ccedil;in &ldquo;ba&#287;lanabilir hedefler&rdquo; haline gelir &mdash; bir kamyon geldi&#287;inde operat&ouml;r gelen malzemeyi ilgili sipari&#351;e ba&#287;layabilir, bu da teslim edilen miktar&#305; otomatik art&#305;r&#305;r ve tam izlenebilirlik sa&#287;lar.</p>

        <h3>6.2.2 &mdash; CRUD Akışı</h3>

        <p><strong>Oluşturma (Çoklu Öğe):</strong></p>
        <ol>
            <li>Araç çubuğundaki &ldquo;Yeni Sipariş&rdquo; butonuna tıkla</li>
            <li>Modal, kademeli seçimle açılır: Malzeme Tipi &rarr; Tedarikçi (tipe göre filtrelenir) &rarr; Ürün panelleri</li>
            <li>Malzeme tipi seç &rarr; tedarikçi dropdown&rsquo;u sadece o tipi taşıyan tedarikçileri gösterir</li>
            <li>Tedarikçi seç &rarr; ürün kataloğu katlanabilir paneller olarak belirir. Ürün seç, miktar gir (kg veya adet)</li>
            <li>Aynı sevkiyattaki aynı tedarikçiden daha fazla ürün eklemek için &ldquo;+&rdquo; tıkla</li>
            <li>Sipariş tarihi (varsayılan bugün) ve beklenen teslim tarihi ayarla. İsteğe bağlı notlar ekle</li>
            <li>Gönderimde: <code>POST /api/material-orders/create</code> &rarr; backend bir grup kodu üretir (R1, R2&hellip;) ve öğe başına bir DB satırı oluşturur, hepsi bu kodu paylaşır. Tek işlem &mdash; ya hepsi ya hiçbiri</li>
            <li>Başarılı: toast onayı &rarr; modal kapanır &rarr; tablo yeni sipariş grubunu göstererek yenilenir</li>
        </ol>

        <p><strong>Düzenleme (Tekli Satır):</strong></p>
        <ol>
            <li>Belirli bir sipariş satırında düzenle ikonuna tıkla (grup değil &mdash; bireysel satırları düzenlersiniz)</li>
            <li>Modal mevcut değerlerle önceden dolu açılır: tedarikçi, malzeme, miktar, tarihler, notlar</li>
            <li>Çoklu öğe &ldquo;+&rdquo; işlevi düzenleme modunda <strong>mevcut değildir</strong></li>
            <li><strong>Kritik davranış:</strong> beklenen teslim tarihi değiştirilirse, tarih seçici açık kalır ve zorunlu neden gerektiren bir <strong>yan panel</strong> belirir (Tedarikçi kaynaklı / Solen kaynaklı / Diğer). Bu, <code>material_order_date_changes</code>&rsquo;da bir denetim kaydı oluşturur</li>
            <li>Gönderimde: <code>PUT /api/material-orders/{id}</code> &rarr; sipariş güncellenir + varsa tarih değişikliği günlüğe kaydedilir</li>
            <li>Başarılı: toast &rarr; modal kapanır &rarr; tablo yenilenir</li>
        </ol>

        <p><strong>Silme:</strong></p>
        <ol>
            <li>Belirli bir sipariş satırında sil ikonuna tıkla</li>
            <li>Uyarılı Popconfirm</li>
            <li>Onayda: <code>DELETE /api/material-orders/{id}</code></li>
            <li>Kademeli: ilişkili <code>material_order_date_changes</code> kayıtları siparişle birlikte silinir</li>
            <li>Tablo yenilenir. Bu gruptaki son öğeyse, grup kodu kaybolur</li>
        </ol>

        <p><strong>Okuma (Tarih Geçmişi):</strong></p>
        <ol>
            <li>Herhangi bir sipariş satırındaki saat ikonuna (Tarih Geçmişi) tıkla</li>
            <li>Modal, tüm tarih değişikliklerinin dikey zaman çizelgesini göstererek açılır: eski tarih (üstü çizili) &rarr; yeni tarih, renkli neden etiketi, detay metni, kim değiştirdi ve ne zaman</li>
            <li>Salt okunur &mdash; geçmiş bağımsız olarak düzenlenemez veya silinemez</li>
        </ol>

        <h3>6.2.3 &mdash; Sipari&#351; Ya&#351;am D&ouml;ng&uuml;s&uuml;</h3>
        <p>Her sipari&#351; d&ouml;rt durumlu bir ya&#351;am d&ouml;ng&uuml;s&uuml; izler:</p>
        <div class="stat-grid" style="grid-template-columns: repeat(4, 1fr);">
            <div class="stat-card" style="border-left: 4px solid #fa8c16;">
                <div class="stat-value" style="font-size: 1.1rem;">Beklemede</div>
                <div class="stat-label">Sipari&#351; verildi, g&ouml;nderim bekleniyor</div>
            </div>
            <div class="stat-card" style="border-left: 4px solid #1890ff;">
                <div class="stat-value" style="font-size: 1.1rem;">Yolda</div>
                <div class="stat-label">Tedarik&ccedil;i g&ouml;nderimi onaylad&#305;</div>
            </div>
            <div class="stat-card" style="border-left: 4px solid #52c41a;">
                <div class="stat-value" style="font-size: 1.1rem;">Teslim Al&#305;nd&#305;</div>
                <div class="stat-label">Malzeme fabrikaya ula&#351;t&#305;</div>
            </div>
            <div class="stat-card" style="border-left: 4px solid #d9d9d9;">
                <div class="stat-value" style="font-size: 1.1rem;">&#304;ptal</div>
                <div class="stat-label">Sipari&#351; iptal edildi</div>
            </div>
        </div>
        <p>Durum ge&ccedil;i&#351;leri iki &#351;ekilde ger&ccedil;ekle&#351;ebilir. Birincisi, tablodaki durum s&uuml;tunu sat&#305;r i&ccedil;i bir a&ccedil;&#305;l&#305;r se&ccedil;icidir &mdash; kullan&#305;c&#305; mevcut durum etiketine t&#305;klar ve yenisini se&ccedil;er. &#304;kincisi ve daha &ouml;nemlisi, <strong>durum, gelen malzemeler bir sipari&#351;e ba&#287;land&#305;&#287;&#305;nda Hammadde Giri&#351;i mod&uuml;l&uuml; taraf&#305;ndan otomatik olarak &ldquo;Teslim Al&#305;nd&#305;&rdquo; yap&#305;l&#305;r</strong>. Hammadde Giri&#351;i &uuml;zerinden bir teslimat kaydedildi&#287;inde, backend sipari&#351;in durumunu otomatik olarak teslim edilmi&#351; yapar, bug&uuml;n&uuml;n tarihini teslimat tarihi olarak damgalar ve teslim edilen miktar&#305; art&#305;r&#305;r. Bu, en yayg&#305;n durum ge&ccedil;i&#351;inin (beklemede &rarr; teslim al&#305;nd&#305;) bu sayfadaki manuel etkile&#351;imle de&#287;il, malzeme alma i&#351; ak&#305;&#351;&#305;n&#305;n par&ccedil;as&#305; olarak otomatik ger&ccedil;ekle&#351;ti&#287;i anlam&#305;na gelir.</p>

        <h3>6.2.4 &mdash; Sipari&#351; Grup Kodlar&#305; (G&ouml;nderim Gruplama)</h3>
        <p>Bir tedarik&ccedil;iden gelen tek bir g&ouml;nderim genellikle birden fazla farkl&#305; malzeme i&ccedil;erir. &Ouml;rne&#287;in, Tedarik&ccedil;i X&rsquo;ten gelen bir kamyon 5 ton HF-500 plastik gran&uuml;l <em>ve</em> 2 ton kataliz&ouml;r ta&#351;&#305;yor olabilir. Bunlar&#305; tamamen ayr&#305; sipari&#351;ler olarak ele almak yerine, sistem onlar&#305; payla&#351;&#305;lan bir <strong>Sipari&#351; Grup Kodu</strong> alt&#305;nda gruplar.</p>
        <p>Grup kodlar&#305; <strong>R1, R2, R3, R4&hellip;</strong> kal&#305;b&#305;n&#305; izler (&ldquo;R&rdquo; &ouml;neki ard&#305;ndan s&#305;ral&#305; numara). Kullan&#305;c&#305; birden fazla kalem i&ccedil;eren yeni bir sipari&#351; olu&#351;turdu&#287;unda, backend tek bir grup kodu &uuml;retir ve o partideki her sipari&#351; sat&#305;r&#305;na atar. Tek kalemli sipari&#351;ler bile tutarl&#305;l&#305;k i&ccedil;in grup kodu al&#305;r.</p>
        <p>&Uuml;retim mant&#305;&#287;&#305; veritaban&#305;ndaki en y&uuml;ksek R-numaras&#305;n&#305; bulup bir art&#305;r&#305;r. Bu basit bir s&#305;ral&#305; saya&ccedil;t&#305;r, UUID de&#287;il &mdash; kodlar insanlar taraf&#305;ndan okunabilir ve s&ouml;zl&uuml; ileti&#351;imde kolay kullan&#305;labilir olacak &#351;ekilde tasarlanm&#305;&#351;t&#305;r (&ldquo;R47 g&ouml;nderimi yar&#305;n geliyor&rdquo;).</p>
        <p>Tabloda grup kodu ilk s&uuml;tun olarak (sola sabitlenmi&#351;) g&ouml;r&uuml;n&uuml;r ve mavi etiket olarak g&ouml;sterilir. G&ouml;rsel gruplama mekanizmas&#305; olarak hizmet eder &mdash; kullan&#305;c&#305;lar birden fazla sat&#305;rda &ldquo;R12&rdquo; g&ouml;rd&uuml;&#287;&uuml;nde, bu kalemlerin ayn&#305; g&ouml;nderimden oldu&#287;unu hemen anlarlar.</p>

        <h3>6.2.5 &mdash; Sipari&#351; Olu&#351;turma (&#199;ok Ad&#305;ml&#305; Form Ak&#305;&#351;&#305;)</h3>
        <p>Sipari&#351; olu&#351;turma, tedarik&ccedil;i veri hiyerar&#351;isini yans&#305;tan kademeli bir se&ccedil;im ak&#305;&#351;&#305; izler:</p>
        <ol>
            <li><strong>Malzeme Tipi Se&ccedil;</strong> &mdash; kullan&#305;c&#305; 8 tip aras&#305;ndan se&ccedil;er (bak&#305;r, kalay, plastik, kataliz&ouml;r, boya, antirodent, palet, makara). Bu ilk filtredir.</li>
            <li><strong>Tedarik&ccedil;i Se&ccedil;</strong> &mdash; tedarik&ccedil;i a&ccedil;&#305;l&#305;r men&uuml;s&uuml; tam liste <em>de&#287;ildir</em>. Yaln&#305;zca se&ccedil;ilen tipte aktif malzeme sa&#287;layan tedarik&ccedil;ileri g&ouml;sterir. &ldquo;Bak&#305;r&rdquo; se&ccedil;erseniz yaln&#305;zca bak&#305;r tedarik&ccedil;ilerini g&ouml;r&uuml;rs&uuml;n&uuml;z. Bu filtreleme istemci taraf&#305;nda her tedarik&ccedil;inin <code>materials_provided</code> dizisi kontrol edilerek ger&ccedil;ekle&#351;ir.</li>
            <li><strong>&Uuml;r&uuml;nler ve Miktarlar Ekle</strong> &mdash; tedarik&ccedil;i se&ccedil;ildikten sonra, kullan&#305;c&#305; o malzeme tipi i&ccedil;in tedarik&ccedil;inin &ouml;zel &uuml;r&uuml;n katalo&#287;unu g&ouml;r&uuml;r. Her &uuml;r&uuml;n, kullan&#305;c&#305;n&#305;n tam &uuml;r&uuml;n&uuml; se&ccedil;ip miktar girdi&#287;i a&ccedil;&#305;l&#305;r/kapan&#305;r bir paneldir. Birim otomatik uyarlan&#305;r: paletler ve makaralar &ldquo;adet&rdquo;, di&#287;er her &#351;ey &ldquo;kg&rdquo; kullan&#305;r.</li>
            <li><strong>Birden Fazla Kalem</strong> &mdash; kullan&#305;c&#305; &ldquo;+&rdquo; butonuyla daha fazla &uuml;r&uuml;n paneli ekleyebilir. Her panel ayr&#305; bir sipari&#351; kalemi temsil eder, ancak t&uuml;m kalemler kaydedildi&#287;inde ayn&#305; grup kodunu payla&#351;&#305;r. &ldquo;+&rdquo; butonu tedarik&ccedil;i se&ccedil;ilene kadar devre d&#305;&#351;&#305;d&#305;r.</li>
            <li><strong>Tarihleri Belirle</strong> &mdash; iki tarih zorunludur: sipari&#351; tarihi (varsay&#305;lan bug&uuml;n) ve beklenen teslim tarihi.</li>
            <li><strong>&#304;ste&#287;e Ba&#287;l&#305; Not</strong> &mdash; ek ba&#287;lam i&ccedil;in serbest metin alan&#305;.</li>
        </ol>
        <p>Kaydetme s&#305;ras&#305;nda frontend t&uuml;m kalemleri tek bir API &ccedil;a&#287;r&#305;s&#305;nda g&ouml;nderir. Backend tek bir grup kodu &uuml;retir ve her kalem i&ccedil;in o kodu payla&#351;an bir veritaban&#305; sat&#305;r&#305; olu&#351;turur. Bu tek bir i&#351;lemdir &mdash; ya t&uuml;m kalemler olu&#351;turulur ya da hi&ccedil;biri.</p>

        <h3>6.2.6 &mdash; Sipari&#351; D&uuml;zenleme</h3>
        <p>D&uuml;zenleme modu, olu&#351;turmadan farkl&#305; &ccedil;al&#305;&#351;&#305;r. D&uuml;zenlerken kullan&#305;c&#305; bir grup &uuml;zerinde de&#287;il, <strong>tek bir sipari&#351; sat&#305;r&#305;</strong> &uuml;zerinde &ccedil;al&#305;&#351;&#305;r. Form mevcut de&#287;erlerle y&uuml;klenir ve kullan&#305;c&#305; tedarik&ccedil;i, malzeme, miktar, tarih ve notlar&#305; de&#287;i&#351;tirebilir. &Ccedil;oklu kalem &ldquo;+&rdquo; i&#351;levselli&#287;i d&uuml;zenleme modunda mevcut de&#287;ildir &mdash; bir seferde bir sat&#305;r d&uuml;zenlenir.</p>
        <p>D&uuml;zenleme modundaki en &ouml;nemli davran&#305;&#351; a&#351;a&#287;&#305;da ayr&#305;nt&#305;l&#305; olarak ele al&#305;nan <strong>tarih de&#287;i&#351;ikli&#287;i takibidir</strong>.</p>

        <h3>6.2.7 &mdash; Tarih De&#287;i&#351;ikli&#287;i Takip Sistemi</h3>
        <p>Bu, mod&uuml;l&uuml;n en sofistike &ouml;zelliklerinden biridir. Ger&ccedil;ek d&uuml;nyada sat&#305;n alma s&uuml;re&ccedil;lerinde beklenen teslim tarihleri s&uuml;rekli de&#287;i&#351;ir &mdash; tedarik&ccedil;iler gecikir, Solen erteleme talep eder, lojistik sorunlar olu&#351;ur. Sistem tarihi sessizce &uuml;zerine yazmaz; kullan&#305;c&#305;dan tarihin <em>neden</em> de&#287;i&#351;ti&#287;ini a&ccedil;&#305;klamas&#305;n&#305; ister ve eksiksiz bir denetim izi saklar.</p>

        <h4>Nas&#305;l &Ccedil;al&#305;&#351;&#305;r</h4>
        <p>Kullan&#305;c&#305; mevcut bir sipari&#351;i d&uuml;zenlemek i&ccedil;in a&ccedil;t&#305;&#287;&#305;nda, sistem orijinal beklenen tarihi kaydeder. Kullan&#305;c&#305; tarih se&ccedil;icisinde bu tarihi de&#287;i&#351;tirirse, ola&#287;and&#305;&#351;&#305; bir &#351;ey olur: tarih se&ccedil;ici kapanmaz. Bunun yerine, takvim a&ccedil;&#305;l&#305;r penceresinin sa&#287; taraf&#305;na bir <strong>yan panel</strong> kay&#305;p girer. Bu panel &#351;unlar&#305; i&ccedil;erir:</p>
        <ul>
            <li><strong>Se&ccedil;ilen yeni tarih</strong> belirgin &#351;ekilde g&ouml;sterilir</li>
            <li><strong>Sebep se&ccedil;ici</strong> (zorunlu), &uuml;&ccedil; se&ccedil;enekli:
                <ul>
                    <li><em>Tedarik&ccedil;i kaynakl&#305;</em> &mdash; tedarik&ccedil;iden kaynaklanan gecikme</li>
                    <li><em>Solen kaynakl&#305;</em> &mdash; Solen&rsquo;den kaynaklanan gecikme (&ouml;rn. program nedeniyle erteleme)</li>
                    <li><em>Di&#287;er</em> &mdash; ba&#351;ka sebep (serbest metin alan&#305; a&ccedil;ar)</li>
                </ul>
            </li>
            <li><strong>Onayla / &#304;ptal butonlar&#305;</strong> &mdash; kullan&#305;c&#305; sebep se&ccedil;tikten sonra tarih de&#287;i&#351;ikli&#287;ini a&ccedil;&#305;k&ccedil;a onaylamal&#305;d&#305;r</li>
        </ul>
        <p>Kullan&#305;c&#305; &ldquo;Di&#287;er&rdquo; se&ccedil;erse, manuel a&ccedil;&#305;klama i&ccedil;in bir metin alan&#305; g&ouml;r&uuml;n&uuml;r ve bu a&ccedil;&#305;klama da zorunludur. Kullan&#305;c&#305; bu sebep ak&#305;&#351;&#305;n&#305; tamamlamadan sipari&#351;i kaydedemez.</p>
        <p>Kullan&#305;c&#305; fikrini de&#287;i&#351;tirip orijinal tarihi tekrar se&ccedil;erse, yan panel kaybolur ve sebep alanlar&#305; otomatik s&#305;f&#305;rlan&#305;r.</p>

        <h4>Backend Depolama</h4>
        <p>Sipari&#351; de&#287;i&#351;en tarihle kaydedildi&#287;inde, backend <code>material_order_date_changes</code> tablosunda yeni bir sat&#305;r olu&#351;turur: eski tarih, yeni tarih, sebep t&uuml;r&uuml;, iste&#287;e ba&#287;l&#305; a&ccedil;&#305;klama metni, de&#287;i&#351;ikli&#287;i yapan ki&#351;i ve zaman damgas&#305;. Bu tablo <code>CASCADE</code> silme kullan&#305;r &mdash; ana sipari&#351; silinirse tarih de&#287;i&#351;ikli&#287;i ge&ccedil;mi&#351;i de silinir.</p>

        <h4>Ge&ccedil;mi&#351;i G&ouml;r&uuml;nt&uuml;leme</h4>
        <p>Tablodaki her sipari&#351; sat&#305;r&#305;nda bir saat ikonu butonu (Tarih Ge&ccedil;mi&#351;i) vard&#305;r. T&#305;kland&#305;&#287;&#305;nda, o sipari&#351;te ya&#351;anm&#305;&#351; her tarih de&#287;i&#351;ikli&#287;ini dikey zaman &ccedil;izelgesi olarak g&ouml;steren bir modal a&ccedil;&#305;l&#305;r. Her giri&#351; &#351;unlar&#305; g&ouml;sterir:</p>
        <ul>
            <li>Eski tarih (&uuml;st&uuml; &ccedil;izili) ve yeni tarihe i&#351;aret eden ok</li>
            <li>Sebep renkli etiket olarak</li>
            <li>Varsa a&ccedil;&#305;klama metni italik olarak</li>
            <li>De&#287;i&#351;ikli&#287;in ne zaman yap&#305;ld&#305;&#287;&#305; ve kim taraf&#305;ndan (sa&#287;a hizal&#305; ikincil s&uuml;tunda)</li>
        </ul>
        <p>Bu modaldaki zaman damgalar&#305; do&#287;ru yerel g&ouml;sterim i&ccedil;in T&uuml;rkiye saat dilimine (Europe/Istanbul) d&ouml;n&uuml;&#351;t&uuml;r&uuml;l&uuml;r.</p>

        <h3>6.2.8 &mdash; Teslimat Takibi (Sipari&#351; ve Gelen Miktar)</h3>
        <p>Her sipari&#351; iki miktar takip eder: <strong>sipari&#351; miktar&#305;</strong> (talep edilen) ve <strong>gelen miktar</strong> (ger&ccedil;ekte teslim al&#305;nan). Gelen miktar bu sayfadan <em>manuel olarak g&uuml;ncellenmez</em>. Hammadde Giri&#351;i mod&uuml;l&uuml;nde gelen malzemeler bir sipari&#351;e ba&#287;land&#305;&#287;&#305;nda otomatik olarak art&#305;r&#305;l&#305;r.</p>
        <p>Tabloda her iki miktar yan yana g&ouml;sterilir. Gelen s&uuml;tunu durumu bir bak&#305;&#351;ta iletmek i&ccedil;in renk kodlamas&#305; kullan&#305;r:</p>
        <ul>
            <li><strong>Renksiz</strong> &mdash; hen&uuml;z hi&ccedil;bir &#351;ey teslim edilmedi (0)</li>
            <li><strong>Sar&#305;/uyar&#305;</strong> &mdash; k&#305;smen teslim edildi (bir miktar malzeme geldi ama sipari&#351;ten az)</li>
            <li><strong>Ye&#351;il</strong> &mdash; tamamen teslim edildi (gelen &ge; sipari&#351;)</li>
        </ul>

        <h3>6.2.9 &mdash; De&#287;erlendirme Sistemi</h3>
        <p>Bir sipari&#351; &ldquo;Teslim Al&#305;nd&#305;&rdquo; durumuna ula&#351;t&#305;&#287;&#305;nda, i&#351;lemler s&uuml;tununda bir y&#305;ld&#305;z ikonu g&ouml;r&uuml;n&uuml;r. Bu, <strong>tedarik&ccedil;i teslimat de&#287;erlendirmesi</strong> sistemini etkinle&#351;tirir. Kullan&#305;c&#305; teslimat&#305; 0,5&ndash;5 y&#305;ld&#305;z &ouml;l&ccedil;e&#287;inde (yar&#305;m y&#305;ld&#305;z art&#305;&#351;lar&#305;yla) puanlayabilir ve iste&#287;e ba&#287;l&#305; olarak de&#287;erlendirmeyi a&ccedil;&#305;klayan bir not ekleyebilir.</p>
        <p>De&#287;erlendirme modal&#305; sipari&#351; ba&#287;lam&#305;n&#305; g&ouml;sterir (grup kodu, tedarik&ccedil;i ad&#305;, malzeme, teslim edilen miktar) b&ouml;ylece kullan&#305;c&#305; tam olarak neyi de&#287;erlendirdi&#287;ini bilir. Puan ve not do&#287;rudan sipari&#351; kayd&#305;nda saklan&#305;r.</p>
        <p>Bu de&#287;erlendirme verileri tedarik&ccedil;i performans takibine katk&#305;da bulunur &mdash; zamanla Solen, hangi tedarik&ccedil;ilerin s&uuml;rekli zaman&#305;nda ve iyi durumda teslim etti&#287;ini, hangilerinin tekrarlayan sorunlar&#305; oldu&#287;unu g&ouml;rebilir.</p>

        <div class="insight">
            <p style="margin-bottom: 0;"><strong>&#304;&#351; mant&#305;&#287;&#305;:</strong> De&#287;erlendirme butonu yaln&#305;zca &ldquo;teslim al&#305;nd&#305;&rdquo; sipari&#351;leri i&ccedil;in g&ouml;r&uuml;n&uuml;r. Bekleyen bir sipari&#351;i de&#287;erlendiremezsiniz &ccedil;&uuml;nk&uuml; de&#287;erlendirilecek bir &#351;ey yoktur. Sipari&#351;in zaten bir de&#287;erlendirmesi varsa, y&#305;ld&#305;z ikonu dolu ve sar&#305; g&ouml;r&uuml;n&uuml;r ve &uuml;zerine gelindiğinde mevcut puanı tooltip olarak gösterir.</p>
        </div>

        <h3>6.2.10 &mdash; &#304;stemci Taraf&#305; Arama ve Yerelleştirme</h3>
        <p>Tablo, <em>tüm görünür sütunlar</em> üzerinde istemci tarafı filtreleme kullanarak siparişleri filtreleyen bir arama çubuğu içerir. Bunu önemsiz kılmayan şey, verilerin İngilizce saklanması (örn. &ldquo;copper&rdquo;, &ldquo;pending&rdquo;) ancak kullanıcıların Türkçe aramasıdır. Arama sistemi iki çeviri haritası tutar:</p>
        <ul>
            <li><strong>Malzeme tipleri:</strong> copper&rarr;bakır, tin&rarr;kalay, plastic&rarr;plastik, catalyst&rarr;katalizör, dye&rarr;boya, palette&rarr;palet, reel&rarr;makara</li>
            <li><strong>Durumlar:</strong> pending&rarr;beklemede, delivered&rarr;teslim alındı</li>
        </ul>
        <p>Kullanıcı &ldquo;bakır&rdquo; yazdığında, filtre <code>material_type === 'copper'</code> olan her satırı eşleştirir. Ayrıca tarihleri DD.MM.YYYY formatında arar (ISO değil), dolayısıyla &ldquo;15.03&rdquo; araması 15 Mart beklenen siparişleri bulur. Arama şunları kapsar: grup kodu, tedarikçi adı, malzeme adı, malzeme tipi (hem EN hem TR), durum (hem EN hem TR), miktarlar, tarihler (hem ham hem formatlanmış) ve notlar.</p>

        <h3>6.2.11 &mdash; Tablo Düzeni ve Sütunlar</h3>
        <p>ProTable, kaydırılabilir düzende 11 sütun gösterir:</p>
        <table style="width: 100%; border-collapse: collapse; margin: 16px 0;">
            <thead>
                <tr style="background: var(--bg-secondary);">
                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid var(--border-color);">Sütun</th>
                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid var(--border-color);">Açıklama</th>
                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid var(--border-color);">Davranış</th>
                </tr>
            </thead>
            <tbody>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Sipariş No</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Sipariş grup kodu (R1, R2&hellip;)</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Sola sabit, mavi etiket</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Malzeme</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Malzeme tipi</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Tipe göre renkli etiket</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Ürün</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Tedarikçi kataloğundan ürün adı</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Mavi etiket</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Tedarikçi</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Tedarikçi adı</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Mavi etiket</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Sipariş Miktarı</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Sipariş edilen miktar + birim</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Türkçe sayı formatı</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Gelen Miktar</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Teslim edilen miktar + birim</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Tamam olunca yeşil, kısmi sarı</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Sipariş Tarihi</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Siparişin verildiği tarih</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">GG.AA.YYYY formatı</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Beklenen Tarih</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Beklenen teslim tarihi</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><strong>Gecikmiş ise kırmızı</strong> (bugünden önce)</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Geliş Tarihi</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Gerçek teslim tarihi</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Yeşil metin, veya teslim edilmediyse &ldquo;-&rdquo;</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Durum</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Sipariş durumu</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><strong>Satır içi açılır menü</strong> &mdash; tıklanarak değiştirilebilir</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">İşlem</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">İşlem butonları</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Sağa sabit: geçmiş, değerlendirme, düzenle, sil</td></tr>
            </tbody>
        </table>
        <p>Beklenen tarih sütunu özel ilgiyi hak eder: tarihi bugünle karşılaştırır ve geçmişte ise <strong>kırmızı</strong> olarak gösterir. Bu, herhangi bir manuel işaretleme olmadan gecikmiş siparişler hakkında anında görsel geri bildirim sağlar.</p>

        <h3>6.2.12 &mdash; API Endpoint&rsquo;leri</h3>
        <table style="width: 100%; border-collapse: collapse; margin: 16px 0;">
            <thead>
                <tr style="background: var(--bg-secondary);">
                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid var(--border-color);">Metot</th>
                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid var(--border-color);">Endpoint</th>
                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid var(--border-color);">Amaç</th>
                </tr>
            </thead>
            <tbody>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>GET</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/material-orders/list</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Tüm siparişleri getirir, beklenen tarihe göre artan sırayla. Opsiyonel filtreler: durum, malzeme tipi. İlişkili tablolardan çözümlenmiş tedarikçi adı ve malzeme adıyla zenginleştirilmiş veri döner.</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>GET</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/material-orders/pending-by-type/{type}</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Bekleyen siparişleri tedarikçi + beklenen tarih bazında gruplanmış döner. Operatörlerin teslimatları siparişlere bağlaması için Hammadde Girişi tarafından tüketilir. Sipariş sayfasının kendisi tarafından kullanılmaz.</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>POST</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/material-orders/create</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Paylaşılan grup koduyla bir veya daha fazla sipariş satırı oluşturur. <code>items</code> dizisi kabul eder; yeni R-kodu üretir; malzeme tipinden birimi otomatik belirler (kg vs adet).</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>PUT</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/material-orders/update/{id}</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Tek bir siparişi günceller. Durum değişikliklerini (delivered_date otomatik damgalar), denetim izi kaydıyla tarih değişikliklerini ve miktar/not güncellemelerini yönetir.</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>GET</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/material-orders/date-changes/{id}</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Bir sipariş için eksiksiz tarih değişikliği geçmişini getirir. Tüm değişiklikleri en yeniden eskiye sıralı, her değişikliği kimin yaptığı kullanıcı adıyla döner.</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>PUT</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/material-orders/rate/{id}</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">0,5&ndash;5 yıldız puanı ve opsiyonel not kaydeder. Aralığı backend&rsquo;de doğrular. Yalnızca teslim alınmış siparişler için anlamlıdır (butonu koşullu göstererek frontend&rsquo;de zorunlu kılınır).</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>DELETE</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/material-orders/delete/{id}</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Siparişi kalıcı olarak siler. CASCADE ilişkisi, ilişkili tarih değişikliği geçmişi kayıtlarını otomatik kaldırır.</td></tr>
            </tbody>
        </table>

        <h3>6.2.13 &mdash; Veritabanı Şeması</h3>
        <p>Modül iki tablo kullanır:</p>
        <p><strong><code>material_orders</code></strong> &mdash; ana sipariş takip tablosu. Her satır bir satın alma siparişindeki bir malzeme kalemini temsil eder. Önemli alanlar:</p>
        <ul>
            <li><code>order_group_code</code> (indeksli) &mdash; aynı gönderimden birden fazla kalemi gruplar (R1, R2&hellip;)</li>
            <li><code>supplier_id</code> &rarr; <code>suppliers</code> tablosuna FK</li>
            <li><code>supplier_material_id</code> &rarr; <code>supplier_materials</code> tablosuna FK &mdash; sipariş edilen spesifik ürün</li>
            <li><code>quantity</code> / <code>delivered_quantity</code> &mdash; sipariş edilen ve gerçekte alınan</li>
            <li><code>unit</code> &mdash; otomatik belirlenir: palet/makara için &ldquo;adet&rdquo;, diğer her şey için &ldquo;kg&rdquo;</li>
            <li><code>order_date</code> / <code>expected_date</code> / <code>delivered_date</code> &mdash; üç tarih kilometre taşı</li>
            <li><code>status</code> &mdash; pending / shipped / delivered / cancelled</li>
            <li><code>rating</code> / <code>rating_note</code> &mdash; teslimat sonrası değerlendirme</li>
            <li><code>created_by</code> &rarr; <code>users</code> tablosuna FK &mdash; siparişi kimin oluşturduğunun denetim izi</li>
        </ul>

        <p><strong><code>material_order_date_changes</code></strong> &mdash; beklenen tarih değişikliklerinin denetim izi. Her satır bir değişiklik olayını yakalar:</p>
        <ul>
            <li><code>order_id</code> &rarr; <code>material_orders</code> tablosuna <code>CASCADE</code> silmeli FK</li>
            <li><code>old_date</code> / <code>new_date</code> &mdash; ne değişti</li>
            <li><code>reason_type</code> &mdash; supplier, solen veya other</li>
            <li><code>reason_detail</code> &mdash; serbest metin (yalnızca &ldquo;other&rdquo; tipi için)</li>
            <li><code>changed_by</code> &rarr; <code>users</code> tablosuna FK</li>
        </ul>

        <h3>6.2.14 &mdash; Malzeme Siparişlerinin Hammadde Girişiyle Bağlantısı</h3>
        <p>Bu en kritik alt akış bağlantısıdır. <code>pending-by-type</code> endpoint&rsquo;i özellikle Hammadde Girişi için mevcuttur. Bir operatör örneğin bakır tel teslimatı girmeye başladığında, Hammadde Girişi sayfası bu endpoint&rsquo;i <code>material_type=copper</code> ile çağırır. Yanıt, tedarikçi + beklenen tarih bazında organize edilmiş gruplar halinde, her bekleyen sipariş satırının ürün adı ve miktarıyla birlikte döner.</p>
        <p>Operatör eşleşen sipariş grubunu seçer ve sistem <code>supplier_material_id</code> ile anahtarlanmış dahili bir <code>order_map</code> oluşturur. Her lot girildiğinde, otomatik olarak ilgili sipariş satırına bağlanır. Bu bağlantı <code>raw_materials.material_order_id</code> alanında saklanır.</p>
        <p>Bir malzeme girişi sipariş bağlantısıyla kaydedildiğinde, backend siparişin <code>delivered_quantity</code> değerini artırır. Bu, sipariş rotalarında değil malzeme giriş rotalarında gerçekleşir &mdash; sipariş modülü bu açıdan pasiftir. Takip kayıtlarını oluşturur; giriş modülü teslimat sırasında onları günceller.</p>

        <div class="insight">
            <p style="margin-bottom: 0;"><strong>Varsayılan sıralama bir hikaye anlatır:</strong> siparişler <code>expected_date ASC</code> ile sıralanır &mdash; en yakın teslimatlar en üstte görünür. Kırmızı gecikme vurgulamasıyla birleşince, tablo doğal olarak en acil kalemleri en üste iter. Depo müdürü bu sayfayı açtığında neyin geciktiğini ve sırada neyin olduğunu anında görür.</p>
        </div>

        <h3>6.2.15 &mdash; Malzeme Sipari&#351;lerinin Stok Projeksiyon Sistemini (Projeksiyon) Beslemesi</h3>
        <p>Bu, Malzeme Sipari&#351;leri verisinin muhtemelen en &ouml;nemli alt ak&#305;&#351; t&uuml;keticisidir ve sipari&#351; sayfas&#305;n&#305;n kendisinden tamamen farkl&#305; bir soyutlama seviyesinde &ccedil;al&#305;&#351;&#305;r.</p>
        <p><strong>Projeksiyon</strong> (Stok Projeksiyon) sistemi, t&uuml;m fabrika genelinde hammadde kullan&#305;labilirli&#287;inin haftal&#305;k tahminini sa&#287;lar. Şu soruyu cevaplar: &ldquo;Hafta hafta, her malzemeden yeterince olacak m&#305;, yoksa eksik mi kalaca&#287;&#305;z?&rdquo; Bunu cevaplamak i&ccedil;in iki veri ak&#305;&#351;&#305;na ihtiyac&#305; vard&#305;r:</p>
        <ul>
            <li><strong>EKS&#304; (&#304;htiya&ccedil;)</strong> &mdash; &uuml;retimin her hafta ne kadar malzeme <em>t&uuml;ketece&#287;i</em>. Bu İş Kartlar&#305;ndan (üretim planlarından) gelir &mdash; bakır için KC kartları, kalay için KL kartları, plastik/katalizör/boya/antirodent için EX kartları, makara için Aktarma kartları, palet için Paletleme kartları.</li>
            <li><strong>ARTI (Gelen)</strong> &mdash; her hafta ne kadar malzemenin <em>gelece&#287;i</em>. <strong>Bu tamamen Malzeme Sipari&#351;lerinden gelir.</strong></li>
        </ul>
        <p>Projeksiyon servisi iptal edilmemi&#351; her malzeme sipari&#351;ini okur ve kritik bir karara g&ouml;re do&#287;ru haftaya yerle&#351;tirir: sipari&#351; teslim edilmi&#351;se <code>delivered_date</code> (ger&ccedil;ek var&#305;&#351;) kullan&#305;r. Hâlâ beklemede veya yoldaysa <code>expected_date</code> (planlanm&#305;&#351; var&#305;&#351;) kullan&#305;r. Benzer &#351;ekilde, teslim edilmi&#351; sipari&#351;ler i&ccedil;in <code>delivered_quantity</code> (ger&ccedil;ekte gelen), bekleyen sipari&#351;ler i&ccedil;in <code>quantity</code> (sipari&#351; edilen) kullan&#305;r.</p>
        <p>Bu, kullan&#305;c&#305;n&#305;n Malzeme Sipari&#351;leri sayfas&#305;nda yapt&#305;&#287;&#305; her de&#287;i&#351;ikli&#287;in projeksiyonu do&#287;rudan etkiledi&#287;i anlam&#305;na gelir:</p>
        <ul>
            <li><strong>Yeni sipari&#351; olu&#351;turma</strong> &rarr; beklenen haftaya bir ARTI giri&#351;i ekler</li>
            <li><strong>Beklenen tarihi de&#287;i&#351;tirme</strong> &rarr; o ARTI&rsquo;y&#305; bir haftadan di&#287;erine ta&#351;&#305;r (tarih de&#287;i&#351;ikli&#287;i takibinin bu kadar &ouml;nemli olmas&#305;n&#305;n nedeni budur &mdash; projeksiyonu kayd&#305;r&#305;r)</li>
            <li><strong>Miktar&#305; de&#287;i&#351;tirme</strong> &rarr; o haftan&#305;n ARTI de&#287;erini art&#305;r&#305;r veya azalt&#305;r</li>
            <li><strong>Sipari&#351;i iptal etme</strong> &rarr; ARTI&rsquo;y&#305; tamamen kald&#305;r&#305;r (iptal edilen sipari&#351;ler hari&ccedil; tutulur)</li>
            <li><strong>Sipari&#351;in teslim edilmesi</strong> &rarr; ARTI, expected_date/quantity&rsquo;den delivered_date/delivered_quantity&rsquo;ye ge&ccedil;er, ger&ccedil;e&#287;i yans&#305;t&#305;r</li>
        </ul>

        <p>Projeksiyon kod tabanındaki yorumlarda &ldquo;kalıcı bir plan&rdquo; olarak tanımlanır, ancak gerçek uygulama daha nüanslı bir hikaye anlatır. Üretim tamamlandığında <strong>değişmez</strong> (tamamlanmış iş kartları hâlâ planlanan tüketim olarak sayılır). Ancak malzeme teslimatlarına <strong>tepki verir</strong>: Hammadde Girişi bir siparişi teslim edildi olarak işaretlediğinde, projeksiyon <code>expected_date</code> + <code>quantity</code> (plan) kullanmaktan <code>delivered_date</code> + <code>delivered_quantity</code> (gerçek) kullanmaya geçer. Bu, teslimat beklenenden farklı bir tarihte geldiyse ARTI girişinin farklı bir haftaya kayabileceği ve teslim edilen miktar sipariş edilenden farklıysa miktarın değişebileceği anlamına gelir. Dolayısıyla projeksiyon, planlanan ve gerçek verileri harmanlayan canlı bir görünümdür &mdash; bekleyen siparişler neyin <em>gelmesi gerektiğini</em>, teslim edilmiş siparişler neyin <em>gerçekten geldiğini</em> gösterir.</p>

        <p>Servis ayr&#305;ca her sipari&#351;i <code>supplier_material</code> ili&#351;kisi &uuml;zerinden <strong>spesifik malzeme ad&#305;na</strong> kadar &ccedil;&ouml;z&uuml;mler. Dolay&#305;s&#305;yla projeksiyon sadece &ldquo;Hafta 12&rsquo;de +500 kg plastik&rdquo; g&ouml;stermez &mdash; &ldquo;Hafta 12&rsquo;de +500 kg HFX-500P&rdquo; g&ouml;sterir. Bu malzeme ba&#351;&#305;na gran&uuml;larite, projeksiyonun yaln&#305;zca kategori d&uuml;zeyinde de&#287;il, bireysel malzeme d&uuml;zeyinde eksiklikleri tespit etmesini sa&#287;lar.</p>

        <p>Projeksiyon t&uuml;m haftalar boyunca <strong>k&uuml;m&uuml;latif bakiye</strong> hesaplar. E&#287;er Hafta 10&rsquo;da +500 kg bak&#305;r geliyorsa ama Hafta 11&rsquo;de &uuml;retim i&ccedil;in -800 kg gerekiyorsa, k&uuml;m&uuml;latif negatife d&ouml;ner ve eksiklik i&#351;aretlenir. Frontend bu eksiklikleri g&ouml;rsel olarak vurgular. Malzeme Sipari&#351;leri ARTI taraf&#305;n&#305; sa&#287;lamazsa, t&uuml;m projeksiyon yaln&#305;zca t&uuml;ketim g&ouml;sterir ve gelen yoktur &mdash; bu da planlama i&ccedil;in kullan&#305;&#351;s&#305;z hale getirir.</p>

        <div class="insight">
            <p style="margin-bottom: 0;"><strong>Malzeme Sipari&#351;lerinin ikili rol&uuml;:</strong> Y&uuml;zeysel olarak bu mod&uuml;l basit bir takip tablosudur. Ama alt&#305;nda, fabrikan&#305;n stok projeksiyon sisteminin iki temel veri kayna&#287;&#305;ndan biridir. Her sipari&#351;, her tarih de&#287;i&#351;ikli&#287;i, her miktar g&uuml;ncellemesi haftal&#305;k projeksiyona yay&#305;l&#305;r ve t&uuml;m planlama ufku boyunca eksiklik tespitini etkiler. Bu y&uuml;zden do&#287;ru sipari&#351; giri&#351;i ve &ouml;zenli tarih de&#287;i&#351;ikli&#287;i takibi idari y&uuml;k de&#287;il &mdash; fabrikan&#305;n &uuml;retim planlama do&#287;rulu&#287;u i&ccedil;in kritik girdilerdir.</p>
        </div>

        <h3>6.2.16 &mdash; Silme Davranışı</h3>
        <p>Siparişler bir onay diyalogu aracılığıyla kalıcı olarak silinebilir. Yumuşak silme / arşivleme mekanizması yoktur. <code>material_order_date_changes</code> üzerindeki CASCADE ilişkisi, bir siparişin silinmesinin tarih değişikliği geçmişini de kaldırmasını sağlar. Ancak, bir <code>raw_material</code> girişi bu siparişe <code>material_order_id</code> aracılığıyla zaten bağlıysa, bu bağlantı asılı bir referans olur (raw_materials üzerindeki foreign key nullable olduğu için kısıtlama ihlali yaratmaz, ancak izlenebilirlik zinciri kırılır).</p>

        <h3>6.2.17 &mdash; Bu Modülün YAPMADIĞI Şeyler</h3>
        <ul>
            <li>Resmi satın alma siparişleri veya faturalar <strong>üretmez</strong></li>
            <li>Fiyatlandırma veya maliyet <strong>yönetmez</strong> &mdash; fiyat alanları yoktur</li>
            <li>Tedarikçilere bildirim veya e-posta <strong>göndermez</strong></li>
            <li>WebSocket <strong>kullanmaz</strong> &mdash; tablo açık kullanıcı işlemlerinde yenilenir (kaydetme, silme, durum değişikliği)</li>
            <li>İzin sistemini <strong>kullanmaz</strong> &mdash; kimliği doğrulanmış her kullanıcı tüm özelliklere erişebilir</li>
            <li>Fiyatlandırma, faturalama veya herhangi bir finansal takip <strong>yapmaz</strong></li>
        </ul>


        <!-- ============================================= -->
        <!--  6.3  HAMMADDE GİRİŞİ (Malzeme Girişi)       -->
        <!-- ============================================= -->

        <h2 id="sec-6-3">6.3 &mdash; Hammadde Giri&#351;i (Malzeme Giri&#351;i)</h2>

        <h3>6.3.1 &mdash; Ama&ccedil; ve &#304;&#351; Ba&#287;lam&#305;</h3>
        <p>Fiziksel ger&ccedil;ekli&#287;in dijital sistemle bulu&#351;tu&#287;u yer buras&#305;d&#305;r. Solen fabrikas&#305;na hammadde y&uuml;kl&uuml; bir kamyon geldi&#287;inde, depo operat&ouml;r&uuml; neyin geldi&#287;ini kaydetmek i&ccedil;in bu mod&uuml;l&uuml; kullan&#305;r. Her kilogram bak&#305;r, her varil plastik, her palet &mdash; hepsi sisteme bu tek sayfadan girer.</p>
        <p>Mod&uuml;l yaln&#305;zca envanter kaydetmez; &uuml;&ccedil; ba&#351;ka sistem aras&#305;ndaki <strong>k&ouml;pr&uuml;d&uuml;r</strong>. Tedarik&ccedil;i Y&ouml;netimi&rsquo;nden veri t&uuml;ketir (kim teslim etti), teslimatlar&#305; Malzeme Sipari&#351;lerine ba&#287;lar (ne bekleniyordu), Hammaddeler Listesi&rsquo;nde g&ouml;r&uuml;nen QR kodlar&#305; ve veritaban&#305; kay&#305;tlar&#305;n&#305; &uuml;retir ve sipari&#351; durumunu ve teslim edilen miktarlar&#305; de&#287;i&#351;tirerek Projeksiyon&rsquo;u (stok projeksiyonu) dolayl&#305; olarak g&uuml;nceller.</p>
        <p>Sayfa men&uuml;de <code>/hammadde/hammadde-girisi</code> alt&#305;nda yer al&#305;r, ancak frontend bile&#351;eni asl&#305;nda <code>Lab/MaterialEntry</code> konumundad&#305;r &mdash; malzeme giri&#351;inin bir laboratuvar/depo operasyonu oldu&#287;unu yans&#305;t&#305;r.</p>

        <h3>6.3.2 &mdash; CRUD Akışı</h3>

        <p><strong>Oluşturma (Birincil Operasyon):</strong></p>
        <ol>
            <li>Açılış sayfasındaki 8 malzeme tipi kartından birine tıkla (Bakır, Kalay, Plastik, Katalizör, Boya, Antirodent, Palet, Makara)</li>
            <li><strong>Adım 1 &mdash; Sipariş Seçimi:</strong> O malzeme tipi için bekleyen siparişleri gösteren modal belirir, <code>GET /material-orders/pending-by-type/{type}</code> ile getirilir. Kullanıcı bir sipariş grubu seçer (tedarikçi + malzemeleri önceden doldurur) veya &ldquo;Manuel Giriş&rdquo;e tıklar (boş form)</li>
            <li><strong>Adım 2 &mdash; Giriş Formu:</strong> Malzeme tipi arketipine göre dinamik form açılır:
                <ul>
                    <li><em>Bakır:</em> katlanabilir palet panelleri (lot no + form ağırlık + ölçülen ağırlık + durum/palet) &rarr; daha fazla palet için &ldquo;+&rdquo;</li>
                    <li><em>Kalay:</em> tekli form (net ağırlık + durum)</li>
                    <li><em>Lot bazlı:</em> katlanabilir lot panelleri (malzeme tipi dropdown + lot no + ağırlıklar + miktar + fotoğraflar/lot) &rarr; daha fazla lot için &ldquo;+&rdquo;</li>
                    <li><em>Sayı bazlı:</em> katlanabilir tip panelleri (tip dropdown + miktar + fotoğraflar/tip) &rarr; daha fazla tip için &ldquo;+&rdquo;</li>
                </ul>
            </li>
            <li>İrsaliye fotoğrafları ve isteğe bağlı test/hasar fotoğrafları yükle (lot bazlılar için lot başına)</li>
            <li>Gönderimde: tipe özel endpoint çağrılır (<code>POST /api/materials/copper-entry</code>, <code>/tin-entry</code>, <code>/lot-entry</code>, <code>/palette-entry</code> veya <code>/reel-entry</code>)</li>
            <li>Backend, deterministik QR koduyla (A1, B1, C1&hellip;) palet/lot/tip başına bir <code>raw_materials</code> satırı oluşturur. Siparişe bağlıysa: siparişte otomatik olarak <code>delivered_quantity</code>, <code>status</code>=DELIVERED ve <code>delivered_date</code>=bugün günceller</li>
            <li>Başarılı: tüm üretilen QR kodlarını gösteren <strong>başarı modalı</strong> belirir, QR başına &ldquo;Yazdır&rdquo; butonu ile. WebSocket <code>materials</code> ve <code>all</code> odalarına yayın yapar</li>
        </ol>

        <p><strong>Güncelleme (Sadece Super Admin):</strong></p>
        <ol>
            <li>Bu sayfada doğrudan mevcut değil &mdash; güncellemeler Hammaddeler Listesi (6.4) düzenleme modalı üzerinden yapılır</li>
            <li>Backend endpoint mevcut: <code>PUT /api/materials/{id}</code>, super_admin veya <code>edit_material</code> yetkisi gerektiren <code>check_permission_smart</code> ile</li>
        </ol>

        <p><strong>Silme (Sadece Super Admin):</strong></p>
        <ol>
            <li>Bu sayfada doğrudan mevcut değil &mdash; silme Hammaddeler Listesi (6.4) üzerinden yapılır</li>
            <li>Backend endpoint&rsquo;leri: <code>DELETE /api/materials/{id}</code> (pasif) ve <code>DELETE /api/materials/{id}/hard</code> (kalıcı)</li>
            <li>Kalıcı silme ayrıca ilişkili <code>material_photos</code> kayıtlarını da kaldırır</li>
        </ol>

        <h3>6.3.3 &mdash; A&ccedil;&#305;l&#305;&#351; Sayfas&#305;: Sekiz Malzeme Kart&#305;</h3>
        <p>Kullan&#305;c&#305; sayfay&#305; a&ccedil;t&#305;&#287;&#305;nda, fabrikan&#305;n i&#351;ledi&#287;i her hammadde t&uuml;r&uuml; i&ccedil;in birer tane olmak &uuml;zere <strong>8 t&#305;klanabilir kart</strong> g&ouml;r&uuml;r:</p>
        <div class="stat-grid" style="grid-template-columns: repeat(4, 1fr);">
            <div class="stat-card" style="border-left: 4px solid #fa8c16;">
                <div class="stat-value" style="font-size: 1rem;">Bak&#305;r (A)</div>
                <div class="stat-label">Filma&#351;in &mdash; bak&#305;r tel &ccedil;ubuk</div>
            </div>
            <div class="stat-card" style="border-left: 4px solid #13c2c2;">
                <div class="stat-value" style="font-size: 1rem;">Kalay (B)</div>
                <div class="stat-label">Tekli a&#287;&#305;rl&#305;k giri&#351;i</div>
            </div>
            <div class="stat-card" style="border-left: 4px solid #722ed1;">
                <div class="stat-value" style="font-size: 1rem;">Plastik (C)</div>
                <div class="stat-label">Plastik gran&uuml;l &mdash; lot bazl&#305;</div>
            </div>
            <div class="stat-card" style="border-left: 4px solid #eb2f96;">
                <div class="stat-value" style="font-size: 1rem;">Kataliz&ouml;r (D)</div>
                <div class="stat-label">Kataliz&ouml;r &mdash; lot bazl&#305;</div>
            </div>
            <div class="stat-card" style="border-left: 4px solid #f5222d;">
                <div class="stat-value" style="font-size: 1rem;">Boya (E)</div>
                <div class="stat-label">Boya &mdash; lot bazl&#305;</div>
            </div>
            <div class="stat-card" style="border-left: 4px solid #2f54eb;">
                <div class="stat-value" style="font-size: 1rem;">Antirodent (F)</div>
                <div class="stat-label">Kemirgen &ouml;nleyici &mdash; lot bazl&#305;</div>
            </div>
            <div class="stat-card" style="border-left: 4px solid #a0d911;">
                <div class="stat-value" style="font-size: 1rem;">Palet (I)</div>
                <div class="stat-label">Ah&#351;ap paletler &mdash; adet bazl&#305;</div>
            </div>
            <div class="stat-card" style="border-left: 4px solid #faad14;">
                <div class="stat-value" style="font-size: 1rem;">Makara (H)</div>
                <div class="stat-label">Kablo makaralar&#305; &mdash; adet bazl&#305;</div>
            </div>
        </div>
        <p>Her kart, koyu/a&ccedil;&#305;k temaya uyum sa&#287;layan benzersiz bir arka plan rengine, b&uuml;y&uuml;k bir ikona ve malzeme ad&#305;na sahiptir. Parantez i&ccedil;indeki harf, o malzeme t&uuml;r&uuml;n&uuml;n QR kod &ouml;nekidir. Herhangi bir karta t&#305;klamak giri&#351; formunu <strong>do&#287;rudan a&ccedil;maz</strong> &mdash; &ouml;nce Sipari&#351; Se&ccedil;imi ak&#305;&#351;&#305;n&#305; tetikler.</p>

        <h3>6.3.4 &mdash; &#304;ki Ad&#305;ml&#305; Giri&#351; Ak&#305;&#351;&#305;</h3>
        <p>Bu kritik bir tasar&#305;m karar&#305;d&#305;r. Malzeme giri&#351;i iki ad&#305;ml&#305; bir s&uuml;re&ccedil; izler:</p>
        <ol>
            <li><strong>Ad&#305;m 1: Sipari&#351; Se&ccedil;im Modal&#305;</strong> &mdash; Kullan&#305;c&#305; bir malzeme kart&#305;na t&#305;klad&#305;&#287;&#305;nda, sistem o malzeme t&uuml;r&uuml; i&ccedil;in bekleyen sipari&#351;leri <code>GET /material-orders/pending-by-type/{type}</code> &uuml;zerinden an&#305;nda getirir. G&ouml;r&uuml;nen modal:
                <ul>
                    <li>Bekleyen sipari&#351; gruplar&#305;n&#305;n listesi &mdash; her biri tedarik&ccedil;i ad&#305;, g&ouml;nderimdeki malzeme adlar&#305;, toplam miktar ve beklenen tarihi g&ouml;sterir</li>
                    <li>Altta &ldquo;Manuel Giri&#351;&rdquo; butonu &mdash; kar&#351;&#305;l&#305;k gelen sipari&#351;i olmayan teslimatlar i&ccedil;in</li>
                </ul>
            </li>
            <li><strong>Ad&#305;m 2: Giri&#351; Formu</strong> &mdash; Kullan&#305;c&#305; ya bir sipari&#351; grubu se&ccedil;er (tedarik&ccedil;i, malzeme tipleri ve miktarlar&#305; otomatik doldurulur) ya da Manuel Giri&#351;&rsquo;e t&#305;klar (bo&#351; form a&ccedil;&#305;l&#305;r). Giri&#351; formu, malzeme t&uuml;r&uuml;ne g&ouml;re t&uuml;m yap&#305;s&#305;n&#305; de&#287;i&#351;tiren dinamik bir modald&#305;r.</li>
        </ol>
        <p>Bu iki ad&#305;ml&#305; ak&#305;&#351; kritik bir amaca hizmet eder: operat&ouml;rleri teslimatlar&#305; sipari&#351;lere ba&#287;lamaya te&#351;vik eder, bu da takip zincirini sa&#287;lam tutar. Sipari&#351;ler varsa belirgin &#351;ekilde g&ouml;sterilir. Manuel giri&#351; bir yedek olarak vard&#305;r, varsay&#305;lan de&#287;il.</p>

        <h3>6.3.5 &mdash; Sipari&#351; &Ouml;n Doldurma Mant&#305;&#287;&#305;</h3>
        <p>Kullan&#305;c&#305; Ad&#305;m 1&rsquo;de bir sipari&#351; grubu se&ccedil;ti&#287;inde, otomatik olarak &#351;unlar ger&ccedil;ekle&#351;ir:</p>
        <ul>
            <li><strong>Tedarik&ccedil;i</strong> alan&#305; otomatik doldurulur ve <strong>devre d&#305;&#351;&#305; b&#305;rak&#305;l&#305;r</strong> &mdash; bir sipari&#351;e kar&#351;&#305; giri&#351; yaparken tedarik&ccedil;iyi de&#287;i&#351;tiremezsiniz</li>
            <li><strong>Lot bazl&#305; malzemeler</strong> (plastik, kataliz&ouml;r, boya, antirodent) i&ccedil;in: sistem her sipari&#351; kalemi ba&#351;&#305;na bir lot paneli &ouml;nceden olu&#351;turur, <code>material_type_id</code> (spesifik &uuml;r&uuml;n) sipari&#351;in <code>supplier_material_id</code> de&#287;erinden zaten se&ccedil;ilmi&#351; olarak</li>
            <li><strong>Paletler ve makaralar</strong> i&ccedil;in: sistem her sipari&#351; kalemi ba&#351;&#305;na bir tip paneli &ouml;nceden olu&#351;turur, palet/makara tipi ve miktar sipari&#351;ten &ouml;n doldurulmu&#351; olarak</li>
            <li><strong>Bak&#305;r ve kalay</strong> i&ccedil;in: tedarik&ccedil;i &ouml;n doldurulur; geri kalan&#305; (palet a&#287;&#305;rl&#305;klar&#305;, lot numaralar&#305;) manuel girilmelidir &ccedil;&uuml;nk&uuml; sipari&#351;ler toplam kg takip eder, palet ba&#351;&#305;na detay de&#287;il</li>
        </ul>
        <p>Sipari&#351; grubu ayr&#305;ca <code>order_ids</code> dizisini ta&#351;&#305;r, bu kaydetme s&#305;ras&#305;nda backend&rsquo;e g&ouml;nderilir b&ouml;ylece sistem hangi sipari&#351;leri teslim edildi olarak i&#351;aretleyece&#287;ini bilir.</p>

        <h3>6.3.6 &mdash; D&ouml;rt Form Arketipi</h3>
        <p>Giri&#351; formu tek bir form de&#287;ildir. Se&ccedil;ilen malzeme t&uuml;r&uuml;ne g&ouml;re ko&#351;ullu olarak render edilen <strong>d&ouml;rt tamamen farkl&#305; form yap&#305;s&#305;d&#305;r</strong>. Hepsi iki ortak alan&#305; (tedarik&ccedil;i ve teslim alan ki&#351;i) ve ortak bir foto&#287;raf b&ouml;l&uuml;m&uuml;n&uuml; payla&#351;&#305;r, ancak aradaki her &#351;ey benzersizdir.</p>

        <h4>Arketip 1: Bak&#305;r (&Ccedil;oklu Palet)</h4>
        <p>Bak&#305;r b&uuml;y&uuml;k paletler halinde gelir (Filma&#351;in &mdash; paletler &uuml;zerinde tel &ccedil;ubuk bobinleri). Tek bir teslimat birden fazla palet i&ccedil;erebilir, her birinin kendi a&#287;&#305;rl&#305;&#287;&#305; vard&#305;r. Form, dinamik bir <strong>a&ccedil;&#305;l&#305;r/kapan&#305;r palet panelleri</strong> listesi sunar:</p>
        <ul>
            <li>Her panel i&ccedil;erir: <strong>Lot Numaras&#305;</strong> (klavye ge&ccedil;i&#351;iyle), <strong>Form A&#287;&#305;rl&#305;&#287;&#305;</strong> (tedarik&ccedil;inin irsaliyesindeki a&#287;&#305;rl&#305;k), <strong>&Ouml;l&ccedil;&uuml;len A&#287;&#305;rl&#305;k</strong> (Solen&rsquo;de &ouml;l&ccedil;&uuml;len ger&ccedil;ek a&#287;&#305;rl&#305;k) ve <strong>Durum</strong> (teslim al&#305;nd&#305; veya reddedildi)</li>
            <li>Kullan&#305;c&#305; &ldquo;+&rdquo; butonuyla daha fazla palet ekleyebilir ve sonuncu hari&ccedil; herhangi bir paneli kald&#305;rabilir</li>
            <li>Form bir bo&#351; palet paneliyle ba&#351;lar</li>
            <li>Kaydetmede backend <strong>palet ba&#351;&#305;na bir <code>raw_materials</code> sat&#305;r&#305;</strong> olu&#351;turur, her biri kendi QR koduyla (A1, A2, A3&hellip;)</li>
            <li>Hem form_weight hem measured_weight saklan&#305;r &mdash; aradaki fark, tedarik&ccedil;inin iddia etti&#287;i ile ger&ccedil;ekte gelenin tutars&#305;zl&#305;klar&#305;n&#305; belirlemeye yard&#305;mc&#305; olur</li>
            <li><code>remaining_weight</code> ba&#351;lang&#305;&ccedil;ta <code>measured_weight</code> olarak ayarlan&#305;r ve &uuml;retim taraf&#305;ndan sonra azalt&#305;l&#305;r</li>
        </ul>

        <h4>Arketip 2: Kalay (Tekli Giri&#351;)</h4>
        <p>Kalay en basit giri&#351; t&uuml;r&uuml;d&uuml;r. Tek bir teslimat, tek bir a&#287;&#305;rl&#305;k &ouml;l&ccedil;&uuml;m&uuml;d&uuml;r:</p>
        <ul>
            <li>Form yaln&#305;zca iki alan g&ouml;sterir: <strong>Net A&#287;&#305;rl&#305;k (kg)</strong> ve <strong>Durum</strong></li>
            <li><code>raw_materials</code>&rsquo;da bir sat&#305;r, bir QR kodu (B1, B2&hellip;)</li>
            <li>Lot numaras&#305; otomatik olarak <code>TIN-{s&#305;ra}</code> &#351;eklinde &uuml;retilir</li>
            <li><code>remaining_weight</code> girilen a&#287;&#305;rl&#305;&#287;a e&#351;it olarak ba&#351;lat&#305;l&#305;r</li>
        </ul>

        <h4>Arketip 3: Lot Bazl&#305; (Plastik, Kataliz&ouml;r, Boya, Antirodent)</h4>
        <p>Bu d&ouml;rt malzeme t&uuml;r&uuml; ayn&#305; form yap&#305;s&#305;n&#305; payla&#351;&#305;r &ccedil;&uuml;nk&uuml; hepsi lotlar halinde gelir (tedarik&ccedil;ideki bir &uuml;retim serisinden partiler). Form, dinamik bir <strong>a&ccedil;&#305;l&#305;r/kapan&#305;r lot panelleri</strong> listesi sunar:</p>
        <ul>
            <li>Her panel i&ccedil;erir: <strong>Malzeme Tipi</strong> (tedarik&ccedil;inin katalo&#287;undan spesifik &uuml;r&uuml;nlerin a&ccedil;&#305;l&#305;r listesi, &ouml;rn. &ldquo;HFX-500P&rdquo;), <strong>Lot Numaras&#305;</strong> (klavye ge&ccedil;i&#351;iyle), <strong>Form A&#287;&#305;rl&#305;&#287;&#305;</strong>, <strong>&Ouml;l&ccedil;&uuml;len A&#287;&#305;rl&#305;k</strong>, <strong>Adet</strong> (bas&#305;lacak etiket say&#305;s&#305; &mdash; bu lottaki ka&ccedil; kap), <strong>Durum</strong> ve <strong>Test/Hasar Foto&#287;raflar&#305;</strong> (lot ba&#351;&#305;na, en fazla 3)</li>
            <li>Malzeme Tipi a&ccedil;&#305;l&#305;r listesi <strong>ba&#287;lama duyarl&#305;d&#305;r</strong>: giri&#351; bir sipari&#351;e ba&#287;l&#305;ysa yaln&#305;zca o sipari&#351;in kalemlerindeki malzemeleri g&ouml;sterir. Manuelse, tedarik&ccedil;inin o t&uuml;rdeki t&uuml;m malzemelerini g&ouml;sterir</li>
            <li>Kaydetmede backend <strong>lot ba&#351;&#305;na bir sat&#305;r</strong> olu&#351;turur, kendi QR koduyla (C1/D1/E1/F1&hellip;)</li>
            <li>Backend spesifik <code>material_name</code>&rsquo;i <code>SupplierMaterial</code>&rsquo;dan &ccedil;&ouml;z&uuml;mler ve varsa <code>boyut</code>&rsquo;u ekler, &ldquo;HFX-500P - 2mm&rdquo; gibi isimler olu&#351;turur</li>
        </ul>

        <h4>Arketip 4: Adet Bazl&#305; (Palet, Makara)</h4>
        <p>Paletler ve makaralar tart&#305;lmaz, say&#305;l&#305;r. Form <strong>a&ccedil;&#305;l&#305;r/kapan&#305;r tip panelleri</strong> sunar:</p>
        <ul>
            <li>Her panel i&ccedil;erir: <strong>Tip</strong> (tedarik&ccedil;i katalo&#287;undan a&ccedil;&#305;l&#305;r liste, &ouml;rn. &ldquo;Euro Palet - 120 cm&rdquo; veya &ldquo;500m Makara - 40 cm - Plastik&rdquo;), <strong>Adet</strong> (say&#305;), <strong>Durum</strong> ve <strong>Hasar Foto&#287;raflar&#305;</strong> (tip ba&#351;&#305;na, en fazla 3)</li>
            <li>Tip a&ccedil;&#305;l&#305;r listesi tedarik&ccedil;inin <code>materials_provided</code> listesinden palet veya makara tipine g&ouml;re filtrelenerek doldurulur</li>
            <li>Makaralar i&ccedil;in g&ouml;sterim <code>material_name - boyut cm - reel_type</code> &#351;eklinde tam &ouml;zelli&#287;i i&ccedil;erir</li>
            <li>Kaydetmede backend <strong>tip ba&#351;&#305;na bir sat&#305;r</strong> olu&#351;turur, QR koduyla (I1/H1&hellip;). Lot numaras&#305; otomatik olarak <code>PALET-{s&#305;ra}</code> veya <code>REEL-{s&#305;ra}</code> &#351;eklinde &uuml;retilir</li>
            <li><code>weight</code> alan&#305; miktar&#305; (say&#305;y&#305;) saklamak i&ccedil;in kullan&#305;l&#305;r ve <code>quantity</code> de say&#305;y&#305; saklar &mdash; geriye d&ouml;n&uuml;k uyumluluk i&ccedil;in &ccedil;ift ama&ccedil;l&#305; aland&#305;r</li>
        </ul>

        <h3>6.3.7 &mdash; Lot Numaras&#305; Klavye Ge&ccedil;i&#351;i</h3>
        <p>K&uuml;&ccedil;&uuml;k ama &ouml;nemli bir UX &ouml;zelli&#287;idir. Lot numaralar&#305; tamamen say&#305;sal (&ouml;rn. &ldquo;24081901&rdquo;) veya alfan&uuml;merik (&ouml;rn. &ldquo;LOT-A24-081&rdquo;) olabilir. Mobil cihazlarda g&ouml;r&uuml;nen klavye <code>inputMode</code> &ouml;zelli&#287;ine ba&#287;l&#305;d&#305;r. Sistem varsay&#305;lan olarak <code>numeric</code> (say&#305; tu&#351;tak&#305;m&#305;) kullan&#305;r ancak giri&#351; alan&#305; i&ccedil;inde say&#305; tu&#351;tak&#305;m&#305; ile tam klavye aras&#305;nda ge&ccedil;i&#351; yapan bir buton sa&#287;lar. Her lot giri&#351;i kendi klavye modunu ba&#287;&#305;ms&#305;z olarak takip eder.</p>

        <h3>6.3.8 &mdash; QR Kod Sistemi</h3>
        <p>Her malzeme giri&#351;i benzersiz, deterministik bir QR kodu &uuml;retir. Sistem basit ama etkili bir &#351;ema kullan&#305;r: malzeme t&uuml;r&uuml;n&uuml; belirleyen bir <strong>harf &ouml;neki</strong>, ard&#305;ndan t&uuml;r ba&#351;&#305;na artan bir <strong>s&#305;ra numaras&#305;</strong>.</p>
        <table style="width: 100%; border-collapse: collapse; margin: 16px 0;">
            <thead>
                <tr style="background: var(--bg-secondary);">
                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid var(--border-color);">&Ouml;nek</th>
                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid var(--border-color);">Malzeme</th>
                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid var(--border-color);">&Ouml;rnekler</th>
                </tr>
            </thead>
            <tbody>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><strong>A</strong></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Bak&#305;r</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">A1, A2, A3&hellip;</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><strong>B</strong></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Kalay</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">B1, B2, B3&hellip;</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><strong>C</strong></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Plastik</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">C1, C2, C3&hellip;</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><strong>D</strong></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Kataliz&ouml;r</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">D1, D2, D3&hellip;</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><strong>E</strong></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Boya</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">E1, E2, E3&hellip;</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><strong>F</strong></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Antirodent</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">F1, F2, F3&hellip;</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><strong>I</strong></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Palet</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">I1, I2, I3&hellip;</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><strong>H</strong></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Makara</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">H1, H2, H3&hellip;</td></tr>
            </tbody>
        </table>
        <p>S&#305;ra numaras&#305;, o malzeme t&uuml;r&uuml; i&ccedil;in mevcut en y&uuml;ksek <code>sequence_number</code> sorgulanarak ve bir art&#305;r&#305;larak belirlenir. Her malzeme t&uuml;r&uuml;n&uuml;n kendi sayac&#305; vard&#305;r &mdash; bak&#305;r A847&rsquo;de olabilirken kalay B23&rsquo;tedir. QR kodu <code>qr_code</code> s&uuml;tununda <strong>benzersiz k&#305;s&#305;tlama</strong> ile saklan&#305;r, &ccedil;ift olu&#351;mamas&#305;n&#305; garanti eder.</p>
        <p>Birden fazla paletli bak&#305;r giri&#351;lerinde, backend ayn&#305; i&#351;lem i&ccedil;inde her palet i&ccedil;in s&#305;ray&#305; art&#305;r&#305;r (3 paletli bir giri&#351; i&ccedil;in A45, A46, A47).</p>

        <h3>6.3.9 &mdash; Foto&#287;raf Mimarisi</h3>
        <p>Foto&#287;raf sistemi iki katmana sahiptir:</p>
        <ul>
            <li><strong>Ortak teslimat foto&#287;raflar&#305; (&#304;rsaliye)</strong> &mdash; bunlar teslimat belgesinin (irsaliye) foto&#287;raflar&#305;d&#305;r. Bireysel kalemlere de&#287;il, t&uuml;m teslimat&#305;n geneline uygulan&#305;r. En fazla 3 foto&#287;raf, giri&#351;teki t&uuml;m malzemeler aras&#305;nda payla&#351;&#305;l&#305;r. T&uuml;m malzeme tipleri i&ccedil;in g&ouml;sterilir.</li>
            <li><strong>Kalem ba&#351;&#305;na foto&#287;raflar (Test/Hasar)</strong> &mdash; bireysel kalemler i&ccedil;in test raporlar&#305; veya hasar dok&uuml;mantasyonu:
                <ul>
                    <li><strong>Bak&#305;r ve kalay</strong> i&ccedil;in: teslimat foto&#287;raflar&#305;n&#305;n yan&#305;nda ortak bir &ldquo;Test Raporu Foto&#287;raf&#305;&rdquo; b&ouml;l&uuml;m&uuml; (en fazla 3) g&ouml;r&uuml;n&uuml;r</li>
                    <li><strong>Lot bazl&#305; malzemeler</strong> i&ccedil;in: her lot panelinin kendi &ldquo;Test/Hasar Foto&#287;raflar&#305;&rdquo; b&ouml;l&uuml;m&uuml; vard&#305;r (lot ba&#351;&#305;na en fazla 3)</li>
                    <li><strong>Palet ve makara</strong> i&ccedil;in: her tip panelinin kendi &ldquo;Hasar Foto&#287;raflar&#305;&rdquo; b&ouml;l&uuml;m&uuml; vard&#305;r (tip ba&#351;&#305;na en fazla 3)</li>
                </ul>
            </li>
        </ul>
        <p>Foto&#287;raflar g&ouml;ndermeden &ouml;nce frontend&rsquo;de base64&rsquo;e d&ouml;n&uuml;&#351;t&uuml;r&uuml;l&uuml;r. Backend bunlar&#305; <code>material_photos</code> tablosunda (malzeme sat&#305;r&#305;nda de&#287;il) <code>photo_type</code> ay&#305;r&#305;c&#305;s&#305; (&ldquo;delivery&rdquo; veya &ldquo;test&rdquo;) ve <code>sequence</code> numaras&#305;yla saklar. Bu ayr&#305; tablo <strong>tembel y&uuml;klemeyi</strong> m&uuml;mk&uuml;n k&#305;lar &mdash; malzemeleri listelerken yaln&#305;zca foto&#287;raf ID&rsquo;leri d&ouml;ner; ger&ccedil;ek base64 verisi talep &uuml;zerine <code>GET /materials/photo/{id}</code> ile getirilir.</p>

        <h3>6.3.10 &mdash; Sipari&#351; Ba&#287;lama ve Otomatik Teslimat G&uuml;ncellemeleri</h3>
        <p>Malzeme Giri&#351;i&rsquo;nin Malzeme Sipari&#351;lerine ve oradan Projeksiyon sistemine geri ba&#287;land&#305;&#287;&#305; yer buras&#305;d&#305;r.</p>
        <p>Bir teslimat sipari&#351;lere ba&#287;land&#305;&#287;&#305;nda, backend malzeme sat&#305;rlar&#305;n&#305; olu&#351;turduktan sonra &#351;u ek ad&#305;mlar&#305; ger&ccedil;ekle&#351;tirir:</p>
        <ul>
            <li><strong>Bak&#305;r/kalay</strong> i&ccedil;in: <code>material_order_ids</code>&rsquo;den ilk sipari&#351; ID&rsquo;si kullan&#305;l&#305;r. Toplam teslim edilen a&#287;&#305;rl&#305;k (bak&#305;r i&ccedil;in t&uuml;m palet a&#287;&#305;rl&#305;klar&#305;n&#305;n toplam&#305; veya kalay i&ccedil;in tekli a&#287;&#305;rl&#305;k) sipari&#351;in <code>delivered_quantity</code> de&#287;erine eklenir. Sipari&#351; durumu &ldquo;delivered&rdquo; yap&#305;l&#305;r ve <code>delivered_date</code> bug&uuml;nle damgalan&#305;r.</li>
            <li><strong>Lot bazl&#305; malzemeler</strong> i&ccedil;in: sistem <code>supplier_material_id</code> ile anahtarlanm&#305;&#351; bir <code>order_map</code> olu&#351;turur. Her lot i&ccedil;in, lotun <code>material_type_id</code> de&#287;erinin haritada bir anahtarla e&#351;le&#351;ip e&#351;le&#351;medi&#287;ini kontrol eder ve e&#351;le&#351;irse o lotu ilgili sipari&#351;e ba&#287;lar. Her sipari&#351;in <code>delivered_quantity</code> de&#287;eri kendi lotlar&#305;n&#305;n a&#287;&#305;rl&#305;klar&#305;yla art&#305;r&#305;l&#305;r.</li>
            <li><strong>Palet/makara</strong> i&ccedil;in: ayn&#305; order_map mant&#305;&#287;&#305;, ama palet/makara tip ID&rsquo;sini <code>supplier_material_id</code> ile e&#351;le&#351;tirmek i&ccedil;in kullan&#305;l&#305;r. Teslim edilen miktar kalem say&#305;s&#305;yla art&#305;r&#305;l&#305;r.</li>
        </ul>
        <p>Ba&#287;lanan her sipari&#351; <code>status = delivered</code>, <code>delivered_date = bug&uuml;n</code> ve <code>delivered_quantity += miktar</code> al&#305;r. Bu, B&ouml;l&uuml;m 6.2&rsquo;de tart&#305;&#351;&#305;lan otomatik durum ge&ccedil;i&#351;idir.</p>

        <h3>6.3.11 &mdash; Ba&#351;ar&#305; Modal&#305; ve QR Yazd&#305;rma</h3>
        <p>Ba&#351;ar&#305;l&#305; bir kaydetmeden sonra sistem formu basit&ccedil;e kapatmaz. &Uuml;retilen QR kodlar&#305;n&#305; listeleyen (&ouml;rn. &ldquo;A45, A46, A47&rdquo;) bir <strong>ba&#351;ar&#305; modal&#305;</strong> g&ouml;sterir:</p>
        <ul>
            <li>&Uuml;retilen QR kodlar&#305;yla bir onay mesaj&#305;</li>
            <li>&#304;ki buton: <strong>OK</strong> (kapat ve d&ouml;n) ve <strong>Yazd&#305;r</strong> (QR etiket yazd&#305;rma ak&#305;&#351;&#305;n&#305; tetikler)</li>
        </ul>
        <p>Yazd&#305;r butonu <code>POST /materials/print/{material_id}</code>&rsquo;yi &ccedil;a&#287;&#305;r&#305;r ve yazd&#305;rma kuyruk sistemine y&ouml;nlendirir. Birden fazla lotlu lot bazl&#305; giri&#351;lerde sistem t&uuml;m olu&#351;turulan malzeme ID&rsquo;lerini dola&#351;&#305;r ve her birini s&#305;rayla yazd&#305;r&#305;r.</p>
        <p>Kaydet buton metni ba&#287;lamsald&#305;r: palet ve makara giri&#351;leri i&ccedil;in &ldquo;Kaydet (QR Yok)&rdquo; yazar &ccedil;&uuml;nk&uuml; paletler ve makaralar bas&#305;l&#305; QR etiketleri yerine fiziksel tan&#305;mlama kullan&#305;r. Di&#287;er t&uuml;m tipler i&ccedil;in &ldquo;Kaydet ve QR Kod Olu&#351;tur&rdquo; yazar.</p>

        <h3>6.3.12 &mdash; Tedarik&ccedil;i Filtreleme</h3>
        <p>Bir malzeme kart&#305;na t&#305;klan&#305;p giri&#351; formu a&ccedil;&#305;ld&#305;&#287;&#305;nda, tedarik&ccedil;i a&ccedil;&#305;l&#305;r listesi t&uuml;m tedarik&ccedil;ileri g&ouml;stermez. Se&ccedil;ilen tipte <code>materials_provided</code> katalo&#287;unda aktif malzemeleri olan tedarik&ccedil;ileri g&ouml;sterecek &#351;ekilde filtrelenir. Bu filtreleme istemci taraf&#305;nda her tedarik&ccedil;inin malzeme dizisi kontrol edilerek ger&ccedil;ekle&#351;ir. Bir malzeme tipi i&ccedil;in tedarik&ccedil;i bulunamazsa, a&ccedil;&#305;l&#305;r liste yard&#305;mc&#305; bir mesaj g&ouml;sterir: &ldquo;Bu malzeme i&ccedil;in tedarik&ccedil;i bulunamad&#305;. &Ouml;nce tedarik&ccedil;i ekleyin.&rdquo;</p>

        <h3>6.3.13 &mdash; &#304;zin Sistemi</h3>
        <p>Malzeme Giri&#351;i, ultra-gran&uuml;ler izin sistemiyle <strong>13 sayfa d&uuml;zeyi butonu</strong> kaydeder:</p>
        <ul>
            <li><code>access_page</code> &mdash; sayfay&#305; g&ouml;rebilme yetene&#287;i</li>
            <li><code>add_copper</code>, <code>add_tin</code>, <code>add_plastic</code>, <code>add_catalyst</code>, <code>add_dye</code>, <code>add_antirodent</code>, <code>add_palette</code>, <code>add_reel</code> &mdash; malzeme kart&#305; ba&#351;&#305;na bir izin</li>
            <li><code>submit_form</code> &mdash; kaydet butonu</li>
            <li><code>upload_delivery_photo</code>, <code>upload_test_photo</code> &mdash; foto&#287;raf y&uuml;kleme yetenekleri</li>
            <li><code>print_qr_modal</code> &mdash; ba&#351;ar&#305; modalindeki yazd&#305;r butonu</li>
        </ul>
        <p>Backend ayr&#305;ca rol bazl&#305; eri&#351;im zorlar: yaln&#305;zca <code>lab_user</code> ve <code>super_admin</code> kullan&#305;c&#305; tipleri malzeme giri&#351;i olu&#351;turabilir. Di&#287;er kullan&#305;c&#305; tipleri 403 Forbidden yan&#305;t&#305; al&#305;r.</p>

        <h3>6.3.14 &mdash; WebSocket Yay&#305;n&#305;</h3>
        <p>Malzeme giri&#351;leri olu&#351;turulduktan sonra (bak&#305;r/kalay yolu), backend olu&#351;turulan her malzeme i&ccedil;in malzeme ID&rsquo;si, QR kodu ve tipiyle birlikte &ldquo;materials:create&rdquo; olay t&uuml;r&uuml;nde bir WebSocket g&uuml;ncellemesi yay&#305;nlar. Bu, ba&#351;ka bir oturumdan yeni malzemeler girildi&#287;inde Hammaddeler Listesi sayfas&#305;n&#305;n manuel yenileme olmadan ger&ccedil;ek zamanl&#305; g&uuml;ncellenmesini sa&#287;lar.</p>
        <p>G&uuml;ncelleme ve kal&#305;c&#305; silme i&#351;lemleri de s&#305;ras&#305;yla &ldquo;materials:update&rdquo; ve &ldquo;materials:delete&rdquo; olaylar&#305;n&#305; yay&#305;nlar.</p>

        <h3>6.3.15 &mdash; Malzeme G&uuml;ncelleme (Yaln&#305;zca S&uuml;per Admin)</h3>
        <p>Mevcut bir malzeme kayd&#305; <code>PUT /materials/update/{id}</code> &uuml;zerinden g&uuml;ncellenebilir, ancak bu <strong>yaln&#305;zca super_admin</strong> ile s&#305;n&#305;rl&#305;d&#305;r. G&uuml;ncellenebilir alanlar: QR kodu (benzersizlik do&#287;rulamal&#305;), lot numaras&#305;, a&#287;&#305;rl&#305;k, form a&#287;&#305;rl&#305;&#287;&#305;, kalan a&#287;&#305;rl&#305;k, adet, durum, notlar ve foto&#287;raflar. Bu d&uuml;zeltmeler i&ccedil;in kullan&#305;l&#305;r &mdash; bir operat&ouml;r yanl&#305;&#351; a&#287;&#305;rl&#305;k girdiyse, s&uuml;per admin d&uuml;zeltebilir. QR kodu de&#287;i&#351;tirilebilir ama t&uuml;m malzemeler aras&#305;nda benzersiz kalmal&#305;d&#305;r.</p>

        <h3>6.3.16 &mdash; Malzeme Silme</h3>
        <p>Kal&#305;c&#305; silme <code>DELETE /materials/{id}/hard-delete</code> &uuml;zerinden yap&#305;labilir (yaln&#305;zca s&uuml;per admin). Silmeden &ouml;nce sistem kontrol eder:</p>
        <ul>
            <li>Malzeme durumu &ldquo;in_use&rdquo; ise silme <strong>engellenir</strong> &mdash; &uuml;retimde olan malzemeyi kald&#305;ramazs&#305;n&#305;z</li>
            <li>&#304;lgili yazd&#305;rma i&#351;leri &ouml;nce silinir</li>
            <li>&#304;lgili foto&#287;raflar silinir (CASCADE bunu halledebilir ama kod a&ccedil;&#305;k&ccedil;a yapar)</li>
        </ul>
        <p>Silme sonras&#305; bir WebSocket yay&#305;n&#305; t&uuml;m ba&#287;l&#305; istemcileri bilgilendirir.</p>

        <h3>6.3.17 &mdash; Malzeme Durum Ya&#351;am D&ouml;ng&uuml;s&uuml;</h3>
        <p>Her malzeme kayd&#305;, fabrikadaki yolculu&#287;unu takip eden bir duruma sahiptir:</p>
        <div class="stat-grid" style="grid-template-columns: repeat(5, 1fr);">
            <div class="stat-card" style="border-left: 4px solid #1890ff;">
                <div class="stat-value" style="font-size: 0.9rem;">received</div>
                <div class="stat-label">Yeni geldi, sisteme girildi</div>
            </div>
            <div class="stat-card" style="border-left: 4px solid #52c41a;">
                <div class="stat-value" style="font-size: 0.9rem;">approved</div>
                <div class="stat-label">Kalite kontrolden ge&ccedil;ti</div>
            </div>
            <div class="stat-card" style="border-left: 4px solid #faad14;">
                <div class="stat-value" style="font-size: 0.9rem;">in_use</div>
                <div class="stat-label">&#350;u an &uuml;retimde</div>
            </div>
            <div class="stat-card" style="border-left: 4px solid #d9d9d9;">
                <div class="stat-value" style="font-size: 0.9rem;">consumed</div>
                <div class="stat-label">Tamamen t&uuml;ketildi</div>
            </div>
            <div class="stat-card" style="border-left: 4px solid #ff4d4f;">
                <div class="stat-value" style="font-size: 0.9rem;">rejected</div>
                <div class="stat-label">Kalitesiz, iade</div>
            </div>
        </div>
        <p>Giri&#351; formu yaln&#305;zca iki ba&#351;lang&#305;&ccedil; durumu sunar: &ldquo;received&rdquo; (varsay&#305;lan) ve &ldquo;rejected&rdquo;. Di&#287;er durumlar (approved, in_use, consumed) alt sistemler taraf&#305;ndan ayarlan&#305;r &mdash; kalite kontrol ve &uuml;retim mod&uuml;lleri. Ayr&#305;ca malzemenin <code>is_active</code> bayra&#287;&#305;n&#305; ge&ccedil;i&#351; yapan bir <code>toggle-status</code> endpoint&rsquo;i de vard&#305;r.</p>

        <h3>6.3.18 &mdash; API Endpoint&rsquo;leri</h3>
        <table style="width: 100%; border-collapse: collapse; margin: 16px 0;">
            <thead>
                <tr style="background: var(--bg-secondary);">
                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid var(--border-color);">Metot</th>
                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid var(--border-color);">Endpoint</th>
                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid var(--border-color);">Ama&ccedil;</th>
                </tr>
            </thead>
            <tbody>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>POST</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/materials/entry</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Bak&#305;r (&ccedil;oklu palet) veya kalay (tekli) giri&#351;leri olu&#351;turur. QR kodlar&#305; &uuml;retir, foto&#287;raflar&#305; kaydeder, sipari&#351;leri ba&#287;lar, WebSocket yay&#305;nlar.</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>POST</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/materials/lot-entry</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Lot bazl&#305; giri&#351;ler (plastik, kataliz&ouml;r, boya, antirodent) olu&#351;turur. Lot ba&#351;&#305;na bir sat&#305;r, malzeme ad&#305; SupplierMaterial&rsquo;dan &ccedil;&ouml;z&uuml;mlenir. Lot ba&#351;&#305;na ba&#287;lama i&ccedil;in order_map olu&#351;turur.</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>POST</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/materials/palette-entry</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Palet giri&#351;leri olu&#351;turur. Palet tipi ba&#351;&#305;na bir sat&#305;r, I &ouml;nekli QR kodlar&#305;yla. PALET-{s&#305;ra} lot numaralar&#305;n&#305; otomatik &uuml;retir.</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>POST</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/materials/reel-entry</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Makara giri&#351;leri olu&#351;turur. Makara tipi ba&#351;&#305;na bir sat&#305;r, H &ouml;nekli QR kodlar&#305;yla. Malzeme ad&#305; boyut ve reel_type i&ccedil;erir. REEL-{s&#305;ra} lot numaralar&#305;.</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>GET</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/materials/list</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">T&uuml;m malzemeleri tedarik&ccedil;i adlar&#305;, foto&#287;raf ID&rsquo;leri (tembel) ve sipari&#351; grup kodlar&#305;yla d&ouml;ner. Hammaddeler Listesi taraf&#305;ndan kullan&#305;l&#305;r.</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>GET</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/materials/photo/{id}</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Talep &uuml;zerine tekli foto&#287;raf base64 verisi d&ouml;ner (tembel y&uuml;kleme).</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>PUT</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/materials/update/{id}</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">QR kodu dahil malzeme alanlar&#305;n&#305; g&uuml;nceller (yaln&#305;zca s&uuml;per admin). G&uuml;ncellemede t&uuml;m foto&#287;raflar&#305; de&#287;i&#351;tirir.</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>DELETE</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/materials/{id}/hard-delete</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Kal&#305;c&#305; silme (s&uuml;per admin). in_use ise engeller. Foto&#287;raflar&#305; ve yazd&#305;rma i&#351;lerini temizler.</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>PUT</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/materials/{id}/toggle-status</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Yumu&#351;ak devre d&#305;&#351;&#305;/etkin i&ccedil;in is_active bayra&#287;&#305;n&#305; ge&ccedil;i&#351; yapar.</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>GET</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/materials/print/preview/{id}</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Yazd&#305;rmadan &ouml;nce etiket &ouml;nizleme g&ouml;r&uuml;nt&uuml;s&uuml; (base64) &uuml;retir.</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>POST</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/materials/print/{id}</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">QR etiketini fiziksel yazd&#305;rma i&ccedil;in yazd&#305;rma kuyru&#287;una g&ouml;nderir.</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>POST</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/materials/print/update-printer-ip</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Yaz&#305;c&#305; IP/port g&uuml;nceller (s&uuml;per admin). G&uuml;ncellemeden sonra ba&#287;lant&#305;y&#305; test eder.</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>GET</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><code>/materials/print/test-connection</code></td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Yaz&#305;c&#305; ba&#287;lant&#305;s&#305;n&#305; test eder (lab kullan&#305;c&#305; + s&uuml;per admin).</td></tr>
            </tbody>
        </table>

        <h3>6.3.19 &mdash; Veritaban&#305; &#350;emas&#305;: raw_materials</h3>
        <p>T&uuml;m 8 malzeme tipi tek bir tabloda saklan&#305;r. &Ouml;nemli alanlar:</p>
        <ul>
            <li><code>material_type</code> &mdash; ay&#305;r&#305;c&#305;: raw_copper, raw_tin, raw_plastic, raw_catalyst, raw_dye, raw_antirodent, raw_palette, raw_reel</li>
            <li><code>material_name</code> &mdash; SupplierMaterial&rsquo;dan &ccedil;&ouml;z&uuml;mlenen spesifik &uuml;r&uuml;n ad&#305; (&ouml;rn. &ldquo;HFX-500P - 2mm&rdquo;). Bak&#305;r ve kalay i&ccedil;in NULL.</li>
            <li><code>sequence_number</code> &mdash; QR kod &uuml;retimi i&ccedil;in t&uuml;r ba&#351;&#305;na artan saya&ccedil;</li>
            <li><code>qr_code</code> &mdash; benzersiz, deterministik tan&#305;mlay&#305;c&#305; (A1, B5, C23, vb.)</li>
            <li><code>supplier_id</code> &rarr; <code>suppliers</code> tablosuna FK</li>
            <li><code>material_order_id</code> &rarr; <code>material_orders</code> tablosuna nullable FK &mdash; sat&#305;n alma sipari&#351;ine geri izlenebilirlik ba&#287;lant&#305;s&#305;</li>
            <li><code>lot_number</code> &mdash; bak&#305;r/lot bazl&#305; i&ccedil;in kullan&#305;c&#305; taraf&#305;ndan girilir, kalay/palet/makara i&ccedil;in otomatik &uuml;retilir</li>
            <li><code>weight</code> &mdash; a&#287;&#305;rl&#305;k bazl&#305; malzemeler i&ccedil;in &ouml;l&ccedil;&uuml;len a&#287;&#305;rl&#305;k, paletler/makaralar i&ccedil;in say&#305;</li>
            <li><code>remaining_weight</code> &mdash; weight olarak ba&#351;lat&#305;l&#305;r, &uuml;retim t&uuml;ketimi taraf&#305;ndan azalt&#305;l&#305;r</li>
            <li><code>form_weight</code> &mdash; tedarik&ccedil;inin irsaliyesindeki a&#287;&#305;rl&#305;k (yaln&#305;zca bak&#305;r ve lot bazl&#305;)</li>
            <li><code>quantity</code> &mdash; lot bazl&#305; malzemeler i&ccedil;in kap/etiket say&#305;s&#305;, palet/makara i&ccedil;in adet</li>
            <li><code>status</code> &mdash; received / approved / in_use / consumed / rejected</li>
            <li><code>entered_by</code> &rarr; <code>users</code> tablosuna FK</li>
        </ul>

        <h3>6.3.20 &mdash; Malzeme Giri&#351;inin Her &#350;eyle Ba&#287;lant&#305;s&#305;</h3>
        <p>Bu, Hammadde sistemindeki en &ccedil;ok ba&#287;lant&#305;l&#305; mod&uuml;ld&uuml;r. &#304;&#351;te her &uuml;st ve alt ak&#305;&#351; ba&#287;lant&#305;s&#305;:</p>
        <ul>
            <li><strong>Tedarik&ccedil;i Y&ouml;netimi (&uuml;st ak&#305;&#351;)</strong> &mdash; tedarik&ccedil;i listesini, malzeme kataloglar&#305;n&#305; ve &uuml;r&uuml;n adlar&#305;n&#305; sa&#287;lar. Giri&#351; formunun a&ccedil;&#305;l&#305;r listeleri tamamen tedarik&ccedil;i verisinden doldurulur.</li>
            <li><strong>Malzeme Sipari&#351;leri (&uuml;st + alt ak&#305;&#351;)</strong> &mdash; Ad&#305;m 1 modal&#305; i&ccedil;in bekleyen sipari&#351;leri sa&#287;lar. Kaydetmede Malzeme Giri&#351;i sipari&#351;lere geri yazar: durumu teslim edildi yapar, tarihi damgalar, teslim edilen miktar&#305; art&#305;r&#305;r.</li>
            <li><strong>Projeksiyon (dolayl&#305; alt ak&#305;&#351;)</strong> &mdash; sipari&#351; durumunu beklemedenden teslim edildi&rsquo;ye de&#287;i&#351;tirerek ve delivered_date/delivered_quantity ayarlayarak, Malzeme Giri&#351;i Projeksiyon&rsquo;u bu sipari&#351;ler i&ccedil;in planlanan veriden ger&ccedil;ek veriye kayd&#305;r&#305;r.</li>
            <li><strong>Hammaddeler Listesi (alt ak&#305;&#351;)</strong> &mdash; burada olu&#351;turulan her sat&#305;r an&#305;nda malzeme listesinde g&ouml;r&uuml;n&uuml;r. Liste sayfas&#305; <code>/materials/list</code>&rsquo;i t&uuml;ketir ve t&uuml;m giri&#351;leri QR kodlar&#305;, a&#287;&#305;rl&#305;klar&#305;, durumlar&#305; ve foto&#287;raflar&#305;yla g&ouml;sterir.</li>
            <li><strong>&Uuml;retim Sistemi (alt ak&#305;&#351;)</strong> &mdash; &uuml;retim mod&uuml;lleri malzemeleri QR kodlar&#305;na referans vererek t&uuml;ketir, <code>remaining_weight</code>&rsquo;i azalt&#305;r ve durumu in_use/consumed olarak de&#287;i&#351;tirir.</li>
            <li><strong>Yazd&#305;rma Kuyru&#287;u (alt ak&#305;&#351;)</strong> &mdash; ba&#351;ar&#305; modal&#305; yazd&#305;rma kuyruk sistemi arac&#305;l&#305;&#287;&#305;yla etiket yazd&#305;rmay&#305; tetikler.</li>
        </ul>

        <div class="insight">
            <p style="margin-bottom: 0;"><strong>Form neden &#351;ekil de&#287;i&#351;tirir:</strong> Her malzeme t&uuml;r&uuml; temelden farkl&#305; fiziksel &ouml;zelliklere sahiptir. Bak&#305;r tek tek tart&#305;lmas&#305; gereken paletlerde gelir. Kalay tek bir bloktur. Plastikler bireysel takip gerektiren numaral&#305; lotlarda gelir. Paletler ve makaralar tart&#305;lmaz, say&#305;l&#305;r. Tek bir genel form ya &ccedil;ok karma&#351;&#305;k olurdu (alakas&#305;z alanlar g&ouml;stererek) ya da &ccedil;ok basit (gerekli verileri ka&ccedil;&#305;rarak). D&ouml;rt arketip yakla&#351;&#305;m&#305;, her malzemenin tam olarak ihtiya&ccedil; duydu&#287;u alanlar&#305; almas&#305;n&#305; sa&#287;lar &mdash; ne eksik ne fazla.</p>
        </div>


        <!-- ============================================= -->
        <!--  6.4  HAMMADDELER L&#304;STES&#304;               -->
        <!-- ============================================= -->

        <h2 id="sec-6-4">6.4 &mdash; Hammaddeler Listesi</h2>

        <h3>6.4.1 &mdash; Ama&ccedil; ve &#304;&#351; Ba&#287;lam&#305;</h3>
        <p>Bu mod&uuml;l, fabrikaya giren <strong>her hammaddenin envanter g&ouml;r&uuml;n&uuml;m&uuml;d&uuml;r</strong>. Hammadde Giri&#351;i teslimatlar&#305; kaydetmekle ilgiliyken, bu mod&uuml;l envanterin g&ouml;r&uuml;nt&uuml;lenmesi, aranmas&#305;, y&ouml;netilmesi ve &uuml;zerinde i&#351;lem yap&#305;lmas&#305;yla ilgilidir. Okuma a&#287;&#305;rl&#305;kl&#305; bir mod&uuml;ld&uuml;r &mdash; birincil kullan&#305;m senaryosu malzemelerin QR koduna g&ouml;re aranmas&#305;, kalan a&#287;&#305;rl&#305;klar&#305;n kontrol edilmesi, foto&#287;raflar&#305;n g&ouml;r&uuml;nt&uuml;lenmesi ve etiket yeniden yazd&#305;r&#305;lmas&#305;d&#305;r. Ancak s&uuml;per adminler i&ccedil;in d&uuml;zenleme ve silme yetenekleri de sa&#287;lar.</p>
        <p>Sayfa, Hammadde Giri&#351;inin &ccedil;&#305;kt&#305;s&#305;n&#305; t&uuml;ketir: d&ouml;rt giri&#351; arketipinden herhangi biri arac&#305;l&#305;&#287;&#305;yla olu&#351;turulan her sat&#305;r burada g&ouml;r&uuml;n&uuml;r. &ldquo;Hangi hammaddelerimiz var ve ne durumda?&rdquo; sorusunun tek do&#287;ruluk kayna&#287;&#305;d&#305;r.</p>

        <h3>6.4.2 &mdash; CRUD Akışı</h3>

        <p><strong>Okuma (Birincil Operasyon):</strong></p>
        <ol>
            <li>Sayfa yüklenir &rarr; <code>GET /api/materials/list</code> tüm malzemeleri getirir (sadece fotoğraf ID&rsquo;leri, base64 verisi değil)</li>
            <li>Tablo 14 sütunla render edilir. Küçük resim fotoğrafları <code>GET /api/materials/{id}/photos/first</code> ile tembel yüklenir</li>
            <li>Fotoğraf küçük resmine tıkla &rarr; önizleme modalı açılır, kalan fotoğraflar <code>GET /api/materials/{id}/photos</code> ile talep üzerine getirilir</li>
            <li>Arama çubuğu, QR kod, malzeme tipi, tedarikçi, lot numarası, durum genelinde istemci tarafında filtreler (Türkçe çevirileri dahil)</li>
            <li>WebSocket bağlantısı tabloyu senkronize tutar &mdash; Hammadde Girişi&rsquo;nden yeni malzemeler otomatik olarak belirir</li>
        </ol>

        <p><strong>Düzenleme (Üç Form Varyantı):</strong></p>
        <ol>
            <li>Malzeme satırında düzenle ikonuna tıkla (<code>edit_material</code> yetkisi gerekir)</li>
            <li>Düzenleme modalı, <strong>malzeme tipine uyarlanmış</strong> alanlarla açılır:
                <ul>
                    <li><em>Bakır/Kalay:</em> QR kod, lot no, form ağırlık, ölçülen ağırlık, kalan ağırlık (düzenlenebilir), durum (received/available/in_use/consumed), fotoğraflar, notlar</li>
                    <li><em>Lot bazlı:</em> QR kod, lot no, form ağırlık, ölçülen ağırlık, miktar (etiket sayısı), durum (received/rejected), fotoğraflar, notlar</li>
                    <li><em>Palet/Makara:</em> QR kod, miktar (adet), durum (received/rejected) &mdash; en basit varyant</li>
                </ul>
            </li>
            <li>QR kod alanı uyarı gösterir: &ldquo;Dikkat: QR kodunu değiştirmek sistemdeki kayıtları etkileyebilir&rdquo;</li>
            <li>Mevcut fotoğraflar modala tembel yüklenir; kullanıcı yeni ekleyebilir veya mevcutları kaldırabilir</li>
            <li>Gönderimde: <code>PUT /api/materials/{id}</code> &rarr; toast &ldquo;Hammadde başarıyla güncellendi&rdquo; &rarr; modal kapanır &rarr; WebSocket yayını &rarr; tablo yenilenir</li>
        </ol>

        <p><strong>Yazdırma (Etiket Tekrar Yazdırma):</strong></p>
        <ol>
            <li>Malzeme satırında yazdır ikonuna tıkla (<code>print_qr</code> yetkisi gerekir; palet/makara için tooltip ile devre dışı)</li>
            <li>QR kodu, etiket sayısı ve konumlarıyla aktif yazıcı dropdown&rsquo;u gösteren yazıcı seçim modalı açılır</li>
            <li>Yazıcı seç &rarr; <code>POST /print-queue/queue/{material_id}?printer_id={id}</code></li>
            <li>İş, Admin&rsquo;in yazdırma kuyruğuna QUEUED durumunda girer</li>
        </ol>

        <p><strong>Silme:</strong></p>
        <ol>
            <li>Sil ikonuna tıkla (<code>delete_material</code> yetkisi gerekir)</li>
            <li>Uyarılı Popconfirm</li>
            <li>Onayda: <code>DELETE /api/materials/{id}</code> (pasif silme &mdash; inactive olarak işaretler)</li>
            <li>Kalıcı kaldırma için: <code>DELETE /api/materials/{id}/hard</code> (<code>hard_delete_material</code> yetkisi gerekir, <em>kritik</em> olarak işaretli). İlişkili <code>material_photos</code> kayıtlarını da kaldırır</li>
            <li>WebSocket yayını &rarr; tablo yenilenir</li>
        </ol>

        <h3>6.4.3 &mdash; WebSocket ile Ger&ccedil;ek Zamanl&#305; G&uuml;ncellemeler</h3>
        <p>Hammadde Sipari&#351;lerinin aksine (kullan&#305;c&#305; eylemlerinde yenilenen), bu sayfa <code>materials</code> ve <code>all</code> WebSocket odalar&#305;na abone olur. Herhangi bir kullan&#305;c&#305; herhangi bir cihaz veya oturumdan bir malzeme olu&#351;turdu&#287;unda, g&uuml;ncelledi&#287;inde veya sildi&#287;inde tablo otomatik olarak yenilenir. Bu, depodan tablet &uuml;zerinden Hammadde Giri&#351;i yapan bir operat&ouml;r oldu&#287;unda, masa&uuml;st&uuml;nde listeyi g&ouml;r&uuml;nt&uuml;leyen y&ouml;neticinin yeni sat&#305;rlar&#305; yenilemek d&uuml;&#287;mesine basmadan an&#305;nda g&ouml;rmesi anlam&#305;na gelir.</p>

        <h3>6.4.4 &mdash; Tablo: 14 S&uuml;tun</h3>
        <p>ProTable, her malzeme kayd&#305;n&#305;n kapsaml&#305; bir g&ouml;r&uuml;n&uuml;m&uuml;n&uuml; sunar:</p>
        <table style="width: 100%; border-collapse: collapse; margin: 16px 0;">
            <thead>
                <tr style="background: var(--bg-secondary);">
                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid var(--border-color);">S&uuml;tun</th>
                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid var(--border-color);">A&ccedil;&#305;klama</th>
                    <th style="padding: 8px; text-align: left; border-bottom: 2px solid var(--border-color);">Davran&#305;&#351;</th>
                </tr>
            </thead>
            <tbody>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">QR Kod</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Benzersiz tan&#305;mlay&#305;c&#305; (A1, B5, C23&hellip;)</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Sola sabit, mavi etiket</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Sipari&#351; No</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Ba&#287;l&#305; sipari&#351; grup kodu (R1, R2&hellip;)</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Cyan etiket, veya sipari&#351; ba&#287;lant&#305;s&#305; yoksa &ldquo;-&rdquo;</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Tip</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Malzeme t&uuml;r&uuml;</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">T&uuml;rk&ccedil;e ad&#305;yla renkli etiket (Bak&#305;r, Kalay, Plastik&hellip;)</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Malzeme Ad&#305;</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Spesifik &uuml;r&uuml;n ad&#305;</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">&Ccedil;&ouml;z&uuml;mlenmi&#351; ad&#305; g&ouml;sterir, bak&#305;r i&ccedil;in &ldquo;Filma&#351;in&rdquo;, kalay i&ccedil;in &ldquo;Kalay K&uuml;l&ccedil;e&rdquo; varsay&#305;lan</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Tedarik&ccedil;i</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Tedarik&ccedil;i ad&#305;</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">D&uuml;z metin</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Lot No</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Lot/parti numaras&#305;</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Palet/makara i&ccedil;in &ldquo;&mdash;&rdquo; g&ouml;sterir (uygulanmaz)</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Form Miktar</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Tedarik&ccedil;inin beyan etti&#287;i miktar</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">T&uuml;re g&ouml;re kg veya adet</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">&Ouml;l&ccedil;&uuml;len Miktar</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Fiili &ouml;l&ccedil;&uuml;len miktar</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">T&uuml;re g&ouml;re kg veya adet</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Kalan</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">&Uuml;retim sonras&#305; kalan a&#287;&#305;rl&#305;k</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);"><strong>Renk kodlu:</strong> orijinalin %95&rsquo;inden azsa sar&#305;, %20&rsquo;sinden azsa k&#305;rm&#305;z&#305;. Palet/makara i&ccedil;in &ldquo;&mdash;&rdquo;.</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Giri&#351; Tarihi</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Malzemenin girildi&#287;i tarih</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">GG.AA.YYYY T&uuml;rk&ccedil;e format</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">&#304;rsaliye</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Teslimat belgesi foto&#287;raflar&#305;</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Lazy-load k&uuml;&ccedil;&uuml;k resim, birden fazlaysa &ldquo;+N&rdquo; rozeti</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Test</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Test/hasar foto&#287;raflar&#305;</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Lazy-load k&uuml;&ccedil;&uuml;k resim, birden fazlaysa &ldquo;+N&rdquo; rozeti</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Durum</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Malzeme durumu</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Renkli etiket: ye&#351;il=teslim al&#305;nd&#305;, k&#305;rm&#305;z&#305;=reddedildi, mavi=mevcut, sar&#305;=kullan&#305;mda, gri=t&uuml;kendi</td></tr>
                <tr><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">&#304;&#351;lemler</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Eylem d&uuml;&#287;meleri</td><td style="padding: 6px 8px; border-bottom: 1px solid var(--border-color);">Sa&#287;a sabit: yazd&#305;r, d&uuml;zenle, sil</td></tr>
            </tbody>
        </table>

        <h3>6.4.5 &mdash; &ldquo;Kalan&rdquo; (Kalan A&#287;&#305;rl&#305;k) S&uuml;tunu</h3>
        <p>Bu, operasyonel olarak en &ouml;nemli s&uuml;tunlardan biridir. &Uuml;retim malzemenin bir k&#305;sm&#305;n&#305; t&uuml;kettikten sonra orijinal malzemeden ne kadar kald&#305;&#287;&#305;n&#305; g&ouml;sterir. Renk kodlamas&#305; anl&#305;k g&ouml;rsel geri bildirim sa&#287;lar:</p>
        <ul>
            <li><strong>Renk yok</strong> &mdash; kalan a&#287;&#305;rl&#305;k orijinale yak&#305;n (%5 tolerans i&ccedil;inde)</li>
            <li><strong>Sar&#305; / kal&#305;n</strong> &mdash; malzeme k&#305;smen t&uuml;ketilmi&#351; (kalan orijinalin %95&rsquo;inden az)</li>
            <li><strong>K&#305;rm&#305;z&#305; / kal&#305;n</strong> &mdash; malzeme neredeyse t&uuml;kenmi&#351; (kalan orijinalin %20&rsquo;sinden az)</li>
        </ul>
        <p>Palet ve makara malzemeler i&ccedil;in bu s&uuml;tun &ldquo;&mdash;&rdquo; g&ouml;sterir &ccedil;&uuml;nk&uuml; say&#305;lan &ouml;&#287;eler kalan a&#287;&#305;rl&#305;k kavram&#305;na sahip de&#287;ildir &mdash; b&uuml;t&uuml;n birim olarak ya mevcuttur ya da t&uuml;kenmi&#351;tir.</p>
        <p>E&#287;er <code>remaining_weight</code> ayarlanmam&#305;&#351;sa (eski kay&#305;tlar), sistem geriye d&ouml;n&uuml;k uyumluluk i&ccedil;in orijinal <code>weight</code> de&#287;erine d&ouml;ner.</p>

        <h3>6.4.6 &mdash; Lazy Photo Y&uuml;kleme Sistemi</h3>
        <p>Foto&#287;raf s&uuml;tunlar&#305; bu sayfan&#305;n teknik olarak en ilgin&ccedil; k&#305;sm&#305;d&#305;r. Potansiyel olarak binlerce malzeme ve her biri i&ccedil;in 6&rsquo;ya kadar foto&#287;raf (3 irsaliye + 3 test) ile, t&uuml;m foto&#287;raf verilerini tabloyla birlikte y&uuml;klemek felaket olurdu. Sistem <strong>iki katmanl&#305; lazy loading</strong> yakla&#351;&#305;m&#305; kullan&#305;r:</p>
        <ol>
            <li><strong>Tablo y&uuml;kleme:</strong> <code>/materials/list</code> endpoint&rsquo;i yaln&#305;zca foto&#287;raf <em>ID&rsquo;lerini</em> (k&uuml;&ccedil;&uuml;k tamsay&#305;lar) d&ouml;nd&uuml;r&uuml;r, foto&#287;raf verisini de&#287;il. Bu, API yan&#305;t&#305;n&#305; h&#305;zl&#305; tutar.</li>
            <li><strong>K&uuml;&ccedil;&uuml;k resim y&uuml;kleme:</strong> her foto&#287;raf h&uuml;cresi ba&#287;&#305;ms&#305;z olarak <code>GET /materials/photo/{id}</code> &uuml;zerinden ilk foto&#287;raf&#305;n base64 verisini getiren bir <code>LazyPhotoThumbnail</code> bile&#351;eni olu&#351;turur. K&uuml;&ccedil;&uuml;k resim i&ccedil;in yaln&#305;zca ilk foto&#287;raf y&uuml;klenir.</li>
            <li><strong>&Ouml;nizleme y&uuml;kleme:</strong> kullan&#305;c&#305; &ouml;nizleme i&ccedil;in bir k&uuml;&ccedil;&uuml;k resme t&#305;klad&#305;&#287;&#305;nda, bile&#351;en o gruptaki t&uuml;m kalan foto&#287;raflar&#305; getirir. Yani bir malzemenin 3 irsaliye foto&#287;raf&#305; varsa, ba&#351;lang&#305;&ccedil;ta yaln&#305;zca ilki y&uuml;klenir; di&#287;er ikisi t&#305;klama &uuml;zerine y&uuml;klenir.</li>
        </ol>
        <p>K&uuml;&ccedil;&uuml;k resim 40x40 piksel, yuvarlatilm&#305;&#351; k&ouml;&#351;elerle g&ouml;sterilir. Birden fazla foto&#287;raf varsa, sa&#287; altta &ldquo;+N&rdquo; g&ouml;steren mavi bir rozet belirir (3 foto&#287;raf i&ccedil;in &ldquo;+2&rdquo;). T&#305;klama, sol/sa&#287; gezinme ve sayfa say&#305;c&#305;s&#305;yla tam boyutlu &ouml;nizlemeyi a&ccedil;ar.</p>

        <h3>6.4.7 &mdash; &#304;stemci Taraf&#305; Arama</h3>
        <p>Arama &ccedil;ubu&#287;u y&uuml;klenen t&uuml;m verileri istemci taraf&#305;nda filtreler. Hammadde Sipari&#351;leri aramas&#305; gibi, hem malzeme t&uuml;rleri hem de durumlar i&ccedil;in EN&rarr;TR &ccedil;eviri haritalar&#305;yla iki dilli e&#351;le&#351;meyi destekler. Aranabilir alanlar: QR kod, malzeme ad&#305;, malzeme t&uuml;r&uuml; (raw_copper&rarr;bak&#305;r, vb.), tedarik&ccedil;i ad&#305;, lot numaras&#305;, sipari&#351; grup kodu, durum (received&rarr;teslim al&#305;nd&#305;, vb.) ve t&uuml;m a&#287;&#305;rl&#305;k/miktar de&#287;erleri metin olarak.</p>
        <p>Arama, t&uuml;m <code>allMaterials</code> dizisine kar&#351;&#305; her tu&#351; vurusunda yeniden hesaplanan bir <code>useMemo</code> olarak uygulanm&#305;&#351;t&#305;r. Tablo filtrelenmi&#351; sonu&ccedil;lar&#305; <code>dataSource={filteredData}</code> arac&#305;l&#305;&#287;&#305;yla g&ouml;sterir.</p>

        <h3>6.4.8 &mdash; D&uuml;zenleme Modal&#305;: &Uuml;&ccedil; Form Varyant&#305;</h3>
        <p>D&uuml;zenleme modal&#305;, d&uuml;zenlenen malzeme t&uuml;r&uuml;ne g&ouml;re alanlar&#305;n&#305; uyarlar ve &uuml;&ccedil; varyant kullan&#305;r:</p>
        <ul>
            <li><strong>Bak&#305;r/Kalay:</strong> QR kod, lot numaras&#305;, form a&#287;&#305;rl&#305;k, &ouml;l&ccedil;&uuml;len a&#287;&#305;rl&#305;k, <strong>kalan a&#287;&#305;rl&#305;k</strong> (d&uuml;zeltmeler i&ccedil;in d&uuml;zenlenebilir, amac&#305;n&#305; a&ccedil;&#305;klayan yard&#305;mc&#305; metinle), durum (4 se&ccedil;enek: teslim al&#305;nd&#305;, mevcut, kullan&#305;mda, t&uuml;kendi), foto&#287;raflar, notlar</li>
            <li><strong>Lot bazl&#305; (plastik, kataliz&ouml;r, boya, antirodent):</strong> QR kod, lot numaras&#305;, form a&#287;&#305;rl&#305;k, &ouml;l&ccedil;&uuml;len a&#287;&#305;rl&#305;k, <strong>adet</strong> (etiket say&#305;s&#305;), durum (2 se&ccedil;enek: teslim al&#305;nd&#305;, reddedildi), foto&#287;raflar, notlar</li>
            <li><strong>Palet/Makara:</strong> QR kod, <strong>miktar (adet)</strong>, durum (2 se&ccedil;enek: teslim al&#305;nd&#305;, reddedildi) &mdash; en basit form, a&#287;&#305;rl&#305;k veya lot numaras&#305; yok</li>
        </ul>
        <p>Her varyant, bir uyar&#305; i&ccedil;eren QR kod alan&#305;n&#305; i&ccedil;erir: &ldquo;Dikkat: QR kodunu de&#287;i&#351;tirmek sistemdeki kay&#305;tlar&#305; etkileyebilir.&rdquo;</p>
        <p>D&uuml;zenleme modal&#305; a&ccedil;&#305;l&#305;rken foto&#287;raflar lazy-load edilir: sistem API&rsquo;den her foto&#287;raf&#305; ID ile getirir ve upload bile&#351;eni i&ccedil;in Ant Design <code>UploadFile</code> nesnelerine d&ouml;n&uuml;&#351;t&uuml;r&uuml;r. Bu, modal&#305;n mevcut foto&#287;raflar&#305; g&ouml;stermesini ve yenilerinin eklenmesini veya mevcutlar&#305;n kald&#305;r&#305;lmas&#305;n&#305; sa&#287;lar.</p>

        <h3>6.4.9 &mdash; Yaz&#305;c&#305; Se&ccedil;imli Yazd&#305;rma</h3>
        <p>&#304;&#351;lemler s&uuml;tunundaki yazd&#305;r d&uuml;&#287;mesi, yazd&#305;rmadan &ouml;nce bir <strong>yaz&#305;c&#305; se&ccedil;im modal&#305;</strong> a&ccedil;ar. Bu modal &#351;unlar&#305; g&ouml;sterir:</p>
        <ul>
            <li>Onay i&ccedil;in malzemenin QR kodu</li>
            <li>Etiket say&#305;s&#305; (lot bazl&#305; malzemelerde <code>quantity &gt; 1</code> ise birden fazla etiket yazd&#305;r&#305;l&#305;r)</li>
            <li><code>GET /printers/list?active_only=true</code>&rsquo;den getirilen aktif yaz&#305;c&#305;lar&#305;n bir a&ccedil;&#305;l&#305;r listesi, her yaz&#305;c&#305;n&#305;n ad&#305; ve konumuyla</li>
        </ul>
        <p>Yazd&#305;rma i&#351;i <code>POST /print-queue/queue/{material_id}?printer_id={id}</code>&rsquo;ye g&ouml;nderilir. Yazd&#305;r d&uuml;&#287;mesi palet ve makara malzemeleri i&ccedil;in <strong>devre d&#305;&#351;&#305;d&#305;r</strong> (&ccedil;&uuml;nk&uuml; QR etiket kullanmazlar), nedenini a&ccedil;&#305;klayan bir tooltip ile.</p>

        <h3>6.4.10 &mdash; Yetki Sistemi</h3>
        <p>Sayfa <strong>12 sayfa d&uuml;zeyi d&uuml;&#287;mesi</strong> kaydeder:</p>
        <ul>
            <li><code>access_page</code>, <code>view_table</code>, <code>view_photos</code>, <code>search_filter</code> &mdash; okuma yetenekleri</li>
            <li><code>print_qr</code> &mdash; yazd&#305;rma</li>
            <li><code>edit_material</code> &mdash; d&uuml;zenleme modal&#305;n&#305; a&ccedil;ma</li>
            <li><code>delete_material</code>, <code>hard_delete_material</code> (<em>kritik</em> i&#351;aretli) &mdash; silme</li>
            <li><code>update_qr_code</code>, <code>update_weight</code>, <code>update_status</code>, <code>update_photos</code> &mdash; gran&uuml;ler d&uuml;zenleme alan&#305; yetkileri</li>
        </ul>
        <p>&ldquo;hard_delete_material&rdquo; yetkisi <code>critical: true</code> olarak i&#351;aretlenmi&#351;tir, bu y&ouml;neticilere bunun y&#305;k&#305;c&#305; ve geri d&ouml;n&uuml;&#351;&uuml; olmayan bir eylem oldu&#287;unu bildirir.</p>

        <h3>6.4.11 &mdash; Tablo Yerelle&#351;tirmesi</h3>
        <p>ProTable ara&ccedil; &ccedil;ubu&#287;u d&uuml;&#287;meleri (yenile, yo&#287;unluk, s&uuml;tun ayarlar&#305;) dahili mesaj ID&rsquo;lerini T&uuml;rk&ccedil;e dizelere e&#351;leyen &ouml;zel bir <code>ProConfigProvider</code> arac&#305;l&#305;&#287;&#305;yla T&uuml;rk&ccedil;e&rsquo;ye yerellendirilmi&#351;tir. Buna &ldquo;Yenile&rdquo;, &ldquo;Sat&#305;r Yo&#287;unlu&#287;u&rdquo;, &ldquo;Tablo Ayarlar&#305;&rdquo;, &ldquo;S&uuml;tun G&ouml;r&uuml;n&uuml;m&uuml;&rdquo;, sabitleme y&ouml;nleri ve daha fazlas&#305; dahildir. Ant Design dili de tarih/say&#305; bi&ccedil;imlendirmesi i&ccedil;in <code>trTR</code> olarak ayarlanm&#305;&#351;t&#305;r.</p>

        <h3>6.4.12 &mdash; Bu Mod&uuml;l&uuml;n Sisteme Ba&#287;lant&#305;s&#305;</h3>
        <ul>
            <li><strong>Hammadde Giri&#351;i (&uuml;st ak&#305;&#351;)</strong> &mdash; tek veri kayna&#287;&#305;. Bu tablodaki her sat&#305;r, d&ouml;rt giri&#351; endpoint&rsquo;inden biri taraf&#305;ndan olu&#351;turulmu&#351;tur.</li>
            <li><strong>Hammadde Sipari&#351;leri (dolayl&#305;)</strong> &mdash; &ldquo;Sipari&#351; No&rdquo; s&uuml;tunu sipari&#351; grup kodunu g&ouml;stererek, envanterden sat&#305;n alma sipari&#351;ine g&ouml;rsel izlenebilirlik sa&#287;lar.</li>
            <li><strong>&Uuml;retim Sistemi (alt ak&#305;&#351;)</strong> &mdash; &uuml;retim mod&uuml;lleri bu envanterdeki verileri (<code>/materials/list</code> veya do&#287;rudan veritaban&#305; sorgular&#305; &uuml;zerinden) okur, QR koduna g&ouml;re malzeme se&ccedil;er ve malzeme t&uuml;kettik&ccedil;e <code>remaining_weight</code> ve <code>status</code>&rsquo;&uuml; g&uuml;nceller. Bu sayfa bu de&#287;i&#351;iklikleri WebSocket &uuml;zerinden ger&ccedil;ek zamanl&#305; yans&#305;t&#305;r.</li>
            <li><strong>Yazd&#305;rma Kuyru&#287;u (alt ak&#305;&#351;)</strong> &mdash; yazd&#305;rma eylemi fiziksel etiket &ccedil;&#305;kt&#305;s&#305; i&ccedil;in yazd&#305;rma kuyru&#287;una i&#351; g&ouml;nderir.</li>
        </ul>

        <div class="insight">
            <p style="margin-bottom: 0;"><strong>Tek sat&#305;rda g&ouml;r&uuml;nen tam izlenebilirlik zinciri:</strong> Bu tablodaki tek bir sat&#305;r size &#351;unlar&#305; s&ouml;yler: ne oldu&#287;unu (QR kod + tip + malzeme ad&#305;), nereden geldi&#287;ini (tedarik&ccedil;i + sipari&#351; grup kodu), ne kadar oldu&#287;unu (form a&#287;&#305;rl&#305;k vs. &ouml;l&ccedil;&uuml;len a&#287;&#305;rl&#305;k), ne kadar kald&#305;&#287;&#305;n&#305; (renk kodlu kalan a&#287;&#305;rl&#305;k), neye benzedi&#287;ini (irsaliye ve test foto&#287;raflar&#305;) ve &#351;u anki durumunun ne oldu&#287;unu (durum). Bu, bir hammaddenin tam ya&#351;am d&ouml;ng&uuml;s&uuml; g&ouml;r&uuml;n&uuml;m&uuml;d&uuml;r &mdash; teslimattan t&uuml;kenmeye kadar &mdash; hepsi tek bir sat&#305;rda.</p>
        </div>


        <!-- ============================================= -->
        <!--  7.  SONU&Ccedil;                                  -->
        <!-- ============================================= -->

        <h2 id="sec-7" style="margin-top: 64px;">7. SONU&Ccedil;</h2>

        <div class="abstract">
            <p style="margin-bottom: 0;"><strong>Hammadde, fiziksel d&uuml;nyan&#305;n dijital sistemle bulu&#351;tu&#287;u noktad&#305;r.</strong> Fabrika kap&#305;s&#305;ndan giren her gram bak&#305;r, her kalay k&uuml;t&uuml;k, her plastik parti, her palet ve makara bu mod&uuml;lden ge&ccedil;er. Kimli&#287;i atar (QR kod), kan&#305;t&#305; kaydeder (foto&#287;raflar), miktarlar&#305; takip eder (a&#287;&#305;rl&#305;k) ve durumu y&ouml;netir (durum ya&#351;am d&ouml;ng&uuml;s&uuml;). Bu mod&uuml;l olmadan &uuml;retim sisteminin t&uuml;ketece&#287;i malzeme, stok sisteminin raporlayaca&#287;&#305; envanter ve projeksiyon sisteminin tahmin i&ccedil;in kullanaca&#287;&#305; giri&#351; verisi yoktur.</p>
        </div>

        <h3>7.1 Bu Dok&uuml;man&#305;n Kapsam&#305;</h3>

        <p>Bu derinlemesine analiz, Hammadde mod&uuml;l&uuml;n&uuml; d&ouml;rt alt mod&uuml;l &uuml;zerinden inceledi &mdash; tedarik&ccedil;i tan&#305;mlar&#305;ndan sat&#305;n alma takibine, malzeme giri&#351;inden envanter g&ouml;r&uuml;nt&uuml;lemeye:</p>

        <table>
            <tr><th>B&ouml;l&uuml;m</th><th>Alt Mod&uuml;l</th><th>Derinlik</th><th>Temel &Ouml;ng&ouml;r&uuml;</th></tr>
            <tr><td>6.1</td><td>Tedarik&ccedil;i Y&ouml;netimi</td><td>Tam</td><td>Bire-&ccedil;ok tedarik&ccedil;i&rarr;malzeme, malzemeye &ouml;zel &ouml;zellikler (yo&#287;unluk, boyut, makara tipi); sil-ve-yeniden-olu&#351;tur g&uuml;ncelleme stratejisi; Giri&#351;, Sipari&#351; ve Hesap Makinesi taraf&#305;ndan t&uuml;ketilir</td></tr>
            <tr><td>6.2</td><td>Hammadde Sipari&#351;</td><td>Tam</td><td>Sevkiyat grupland&#305;rmas&#305; i&ccedil;in sipari&#351; grup kodlar&#305; (R1, R2&hellip;); zorunlu nedenlere sahip tarih de&#287;i&#351;ikli&#287;i denetim izi; Hammadde Giri&#351;i taraf&#305;ndan otomatik durum g&uuml;ncellemesi; Projeksiyon&rsquo;u &ldquo;ARTI&rdquo; taraf&#305; olarak besler</td></tr>
            <tr><td>6.3</td><td>Hammadde Giri&#351;i</td><td>Kapsaml&#305;</td><td>D&ouml;rt dinamik form arketipi (bak&#305;r/kalay/lot bazl&#305;/say&#305; bazl&#305;); deterministik QR kodlar (A&ndash;H &ouml;nekleri); iki katmanl&#305; tembel foto&#287;raf y&uuml;kleme; otomatik sipari&#351; teslimat g&uuml;ncellemeleri</td></tr>
            <tr><td>6.4</td><td>Hammaddeler Listesi</td><td>Tam</td><td>Renk kodlu kalan a&#287;&#305;rl&#305;kl&#305; 14 s&uuml;tunlu envanter g&ouml;r&uuml;n&uuml;m&uuml;; &uuml;&ccedil; d&uuml;zenleme formu varyant&#305;; tembel foto&#287;raf k&uuml;&ccedil;&uuml;k resimleri ve &ouml;nizleme; ger&ccedil;ek zamanl&#305; WebSocket g&uuml;ncellemeleri</td></tr>
        </table>

        <h3>7.2 Mimari Prensipler</h3>

        <div class="arch-grid">
            <div class="arch-box">
                <h4>Fiziksel-&Ouml;ncelikli Tasar&#305;m</h4>
                <p>Her malzeme t&uuml;r&uuml;n&uuml;n temelde farkl&#305; fiziksel &ouml;zellikleri vard&#305;r. Tek bir genel form dayatmak yerine, sistem d&ouml;rt farkl&#305; arketip kullan&#305;r &mdash; bak&#305;r paletlerin tek tek tart&#305;lmas&#305;n&#305;, kalay&#305;n otomatik lot numaras&#305; almas&#305;n&#305;, plastiklerin etiketler i&ccedil;in lot say&#305;lar&#305;n&#305; takip etmesini ve palet/makaralar&#305;n sadece say&#305;lmas&#305;n&#305; sa&#287;lar. Aray&uuml;z malzemeye uyum sa&#287;lar, tersi de&#287;il.</p>
            </div>
            <div class="arch-box">
                <h4>Tembel Y&uuml;kleme</h4>
                <p>Foto&#287;raflar ayr&#305; depolanarak talep &uuml;zerine y&uuml;klenir. Malzeme listesi yaln&#305;zca foto&#287;raf kimliklerini d&ouml;nd&uuml;r&uuml;r, base64 verisini de&#287;il. K&uuml;&ccedil;&uuml;k resimler birer foto&#287;raf y&uuml;kler; &ouml;nizlemeler geri kalanlar&#305; t&#305;kland&#305;&#287;&#305;nda getirir. Bu desen, binlerce sat&#305;rl&#305; ve potansiyel olarak on binlerce foto&#287;rafl&#305; bir tabloyu duyarl&#305; tutar.</p>
            </div>
            <div class="arch-box">
                <h4>Otomatik Kademelendirme</h4>
                <p>Malzeme teslimat&#305; kaydedildi&#287;inde, ba&#287;lant&#305;l&#305; sat&#305;n alma sipari&#351;inin teslim_miktar&#305;, durumu ve teslim_tarihi otomatik olarak g&uuml;ncellenir. Bu, Projeksiyon&rsquo;a da yans&#305;r &mdash; planlanm&#305;&#351; veriden ger&ccedil;ek veriye ge&ccedil;ilir. Hammadde Giri&#351;i&rsquo;ndeki tek bir eylem, Sipari&#351;ler &uuml;zerinden projeksiyon sistemine manuel m&uuml;dahaleye gerek kalmadan yay&#305;l&#305;r.</p>
            </div>
            <div class="arch-box">
                <h4>Deterministik Kimlik</h4>
                <p>QR kodlar kat&#305; bir &ouml;nek+s&#305;ra deseni izler (A=bak&#305;r, B=kalay, C=plastik&hellip;). UUID yok, rastgelelik yok. S&#305;ra tipe &ouml;zeldir ve otomatik artan. Bu, QR kodlar&#305;n&#305;n insan taraf&#305;ndan okunabilir, s&#305;ralanabilir ve tahmin edilebilir olmas&#305;n&#305; sa&#287;lar &mdash; operat&ouml;rlerin el tipi cihazlarla etiket tarad&#305;&#287;&#305; bir fabrika zemininde kritik &ouml;neme sahiptir.</p>
            </div>
        </div>

        <h3>7.3 Rakamlarla</h3>

        <div class="stat-grid">
            <div class="stat-box">
                <div class="value" style="color: var(--accent);">4</div>
                <div class="label">ALT MOD&Uuml;L</div>
            </div>
            <div class="stat-box">
                <div class="value" style="color: var(--turquoise);">~30</div>
                <div class="label">API ENDPOINT</div>
            </div>
            <div class="stat-box">
                <div class="value">6</div>
                <div class="label">VER&#304;TABANI TABLOSU</div>
            </div>
            <div class="stat-box">
                <div class="value" style="color: var(--positive);">~2.200</div>
                <div class="label">SATIR BACKEND</div>
            </div>
            <div class="stat-box">
                <div class="value" style="color: var(--negative);">~5.100</div>
                <div class="label">SATIR FRONTEND</div>
            </div>
            <div class="stat-box">
                <div class="value">8</div>
                <div class="label">MALZEME T&#304;P&#304;</div>
            </div>
        </div>

        <h3>7.4 Hammadde Fabrikay&#305; Nas&#305;l Besler</h3>

        <div class="flow">
            <span class="flow-step">Tedarik&ccedil;i</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">Sipari&#351;</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">Hammadde Giri&#351;i</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">Hammaddeler Listesi</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">&Uuml;retim</span>
        </div>

        <p>Tedarik&ccedil;iler hangi malzemelerin mevcut oldu&#287;unu ve &ouml;zelliklerini tan&#305;mlar. Sipari&#351;ler nelerin sat&#305;n al&#305;nd&#305;&#287;&#305;n&#305; ve ne zaman gelece&#287;ini takip eder. Hammadde Giri&#351;i fiziksel var&#305;&#351;&#305; kaydeder &mdash; tartma, foto&#287;raflama, QR kodlama ve sipari&#351;e ba&#287;lama. Hammaddeler Listesi, &uuml;retimin t&uuml;ketti&#287;i canl&#305; envanter haline gelir. &Uuml;retim malzeme kulland&#305;k&ccedil;a kalan a&#287;&#305;rl&#305;klar d&uuml;&#351;er, durumlar de&#287;i&#351;ir ve malzeme tamamen t&uuml;kenene kadar d&ouml;ng&uuml; devam eder.</p>

        <p>Paralel olarak, her sipari&#351; <strong>Projeksiyon</strong> sistemini planlanm&#305;&#351; ve ger&ccedil;ek teslimat verileriyle besleyerek, fabrikan&#305;n malzeme mevcudiyetini haftalarca &ouml;nceden tahmin etmesini sa&#287;lar.</p>

        <h3>7.5 Son S&ouml;z</h3>

        <div class="abstract">
            <p style="margin-bottom: 0;">Hammadde mod&uuml;l&uuml;, kaotik bir fiziksel s&uuml;reci &mdash; bak&#305;r tel, kalay k&uuml;t&uuml;k, plastik varil ve tahta palet ta&#351;&#305;yan kamyonlar&#305;n gel&#305;&#351;&#305;ni &mdash; yap&#305;land&#305;r&#305;lm&#305;&#351;, izlenebilir, aranabilir dijital kay&#305;tlara d&ouml;n&uuml;&#351;t&uuml;r&uuml;r. Her malzeme bir kimlik, bir ge&ccedil;mi&#351; ve bir durum kazan&#305;r. Bir tedarik&ccedil;inin tan&#305;mlanmas&#305;ndan bak&#305;r&#305;n son gram&#305;n&#305;n &uuml;retimde t&uuml;ketilmesine kadar, bu mod&uuml;l veri izini sa&#287;lar. D&ouml;rt arketipli form tasar&#305;m&#305;, tembel foto&#287;raf mimarisi, otomatik sipari&#351; kademelendirmesi ve ger&ccedil;ek zamanl&#305; WebSocket g&uuml;ncellemeleri tek bir hedefe hizmet eder: fiziksel ger&ccedil;eklik ile dijital kay&#305;t aras&#305;ndaki bo&#351;lu&#287;u m&uuml;mk&uuml;n oldu&#287;unca k&uuml;&ccedil;&uuml;k tutmak. Bu dok&uuml;man, tedarik&ccedil;i tan&#305;m&#305;ndan envanter t&uuml;kenme noktas&#305;na kadar t&uuml;m bu zinciri &mdash; her API endpoint&rsquo;i, her veritaban&#305; s&uuml;tunu, her &ouml;ny&uuml;z etkile&#351;imi ve her mod&uuml;ller aras&#305; ba&#287;lant&#305;y&#305; &mdash; takip etmi&#351;tir.</p>
        </div>

    </main>
</body>
</html>
