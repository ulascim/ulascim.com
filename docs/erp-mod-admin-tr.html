<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="../favicon.png">
    <link rel="apple-touch-icon" href="../apple-touch-icon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Mod&uuml;l&uuml; | Kablo Fabrikas&inodot; ERP</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg: #f3f3f3;
            --fg: #000000;
            --gray-100: #f3f4f6;
            --gray-300: #d1d5db;
            --positive: #16a34a;
            --negative: #dc2626;
            --accent: #2563eb;
            --turquoise: #00b5ad;
        }
        body { font-family: 'IBM Plex Mono', monospace; background: var(--bg); color: var(--fg); font-size: 12px; line-height: 1.3; }
        .nav { position: sticky; top: 0; z-index: 50; border-bottom: 2px solid var(--fg); background: var(--bg); }
        .nav-container { max-width: 1400px; margin: 0 auto; padding: 0 64px; height: 56px; display: flex; align-items: center; }
        .nav-left { display: flex; align-items: center; gap: 12px; }
        .nav-logo { font-size: 18px; font-weight: 700; letter-spacing: 2px; text-decoration: none; color: var(--fg); }
        .nav-right { margin-left: auto; }
        .nav-link-small { color: var(--fg); text-decoration: underline; font-size: 11px; }
        .nav-divider { color: var(--fg); font-size: 14px; font-weight: 300; }
        .report { max-width: 1400px; margin: 0 auto; padding: 24px 64px; }
        .report h1 { font-size: 28px; margin-bottom: 8px; letter-spacing: 2px; }
        .report h2 { font-size: 18px; margin-top: 36px; margin-bottom: 12px; border-bottom: 2px solid #000; padding-bottom: 4px; scroll-margin-top: 72px; }
        .report h3 { font-size: 14px; margin-top: 20px; margin-bottom: 8px; }
        .report h4 { font-size: 12px; margin-top: 14px; margin-bottom: 6px; }
        .report p { font-size: 13px; line-height: 1.6; margin-bottom: 12px; }
        .report ul { font-size: 13px; margin: 12px 0; padding-left: 20px; }
        .report li { margin-bottom: 6px; line-height: 1.5; }
        .report ol { font-size: 13px; margin: 12px 0; padding-left: 20px; }
        .report ol li { margin-bottom: 6px; line-height: 1.5; }
        .report .subtitle { font-size: 14px; color: #666; margin-bottom: 4px; }
        .report .authors { font-size: 12px; color: #888; margin-bottom: 32px; }
        .report code { background: #e5e5e0; padding: 1px 5px; font-size: 12px; }
        .report pre { background: #1a1a2e; color: #e0e0e0; padding: 16px; margin: 12px 0; overflow-x: auto; font-size: 12px; line-height: 1.5; border: 2px solid #000; }
        .report pre .comment { color: #6a9955; }
        .report pre .keyword { color: #569cd6; }
        .report pre .string { color: #ce9178; }
        .report pre .decorator { color: #dcdcaa; }
        .report .abstract { background: #f5f5f0; padding: 16px; margin: 20px 0; border-left: 3px solid #000; }
        .report .finding { background: #fffbe6; padding: 12px; margin: 12px 0; border: 1px solid #e6d600; }
        .report .warning { background: #fee2e2; padding: 12px; margin: 12px 0; border: 1px solid #dc2626; }
        .report .discovery { background: #e6ffe6; padding: 12px; margin: 12px 0; border: 1px solid #0a0; }
        .report .insight { background: #eff6ff; padding: 12px; margin: 12px 0; border: 1px solid #2563eb; }
        .report .philosophy { background: #faf5ff; padding: 12px; margin: 12px 0; border: 1px solid #7c3aed; }
        .stat-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin: 16px 0; }
        .stat-grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin: 16px 0; }
        .stat-box { background: #f3f4f6; padding: 12px; text-align: center; border: 2px solid #000; }
        .stat-box .value { font-size: 24px; font-weight: bold; }
        .stat-box .label { font-size: 10px; color: #666; margin-top: 2px; }
        .report table { width: auto; border-collapse: collapse; border: 2px solid #000; margin: 16px 0; }
        .report tr:first-child { background: #f3f4f6; border-bottom: 2px solid #000; }
        .report th { padding: 4px 10px; text-align: left; font-size: 0.65rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.03em; white-space: nowrap; border-right: 2px solid #000; background: #f3f4f6; }
        .report th:last-child { border-right: none; }
        .report tr:not(:first-child) { border-bottom: 1px solid #d1d5db; }
        .report tr:last-child { border-bottom: none; }
        .report td { padding: 4px 10px; font-size: 0.75rem; border-right: 2px solid #000; }
        .report td:last-child { border-right: none; }
        .report tr:not(:first-child):hover { background: rgba(0,0,0,0.02); }
        .flow { display: flex; align-items: center; gap: 8px; margin: 16px 0; flex-wrap: wrap; }
        .flow-box { padding: 8px 14px; border: 2px solid #000; font-size: 12px; font-weight: 700; text-align: center; min-width: 100px; }
        .flow-arrow { font-size: 18px; font-weight: 700; }
        .flow-box.done { background: #dcfce7; border-color: #16a34a; }
        .flow-box.active { background: #dbeafe; border-color: #2563eb; }
        .flow-box.pending { background: #f3f4f6; }
        .arch-box { background: #fff; border: 2px solid #000; padding: 16px; margin: 12px 0; }
        .arch-box h4 { font-size: 14px; margin-bottom: 8px; margin-top: 0; }
        .arch-box p { font-size: 12px; line-height: 1.5; }
        .arch-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 16px; margin: 16px 0; }
        .back-link { display: inline-block; font-size: 12px; color: #666; text-decoration: none; margin-bottom: 24px; padding: 8px 0; }
        .back-link:hover { color: #000; }
        .back-link::before { content: "\2190  "; }
        .good { color: #16a34a; font-weight: 700; }
        .bad { color: #dc2626; font-weight: 700; }

        .submod-card { background: #fff; border: 2px solid #000; padding: 16px; margin: 10px 0; display: flex; align-items: flex-start; gap: 16px; }
        .submod-num { background: #000; color: #fff; font-size: 13px; font-weight: 700; min-width: 36px; height: 36px; padding: 0 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .submod-body { flex: 1; }
        .submod-body h4 { font-size: 14px; margin: 0 0 4px 0; }
        .submod-body p { font-size: 12px; color: #555; margin: 0 0 6px 0; line-height: 1.4; }
        .submod-tags { display: flex; gap: 6px; flex-wrap: wrap; }
        .submod-tag { font-size: 10px; padding: 2px 6px; background: #f3f4f6; border: 1px solid #d1d5db; }

        @media (max-width: 768px) {
            .report { padding: 16px; }
            .nav-container { padding: 0 16px; }
            .stat-grid, .stat-grid-3 { grid-template-columns: repeat(2, 1fr); }
            .flow { flex-direction: column; align-items: stretch; }
            .flow-arrow { transform: rotate(90deg); text-align: center; }
            .arch-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <nav class="nav">
        <div class="nav-container">
            <div class="nav-left">
                <a href="erp-system.html" class="nav-logo">ERP SYSTEM</a>
            </div>
            <div class="nav-right">
                <a href="erp-mod-admin-tr.html" class="nav-link-small" style="font-weight: 700;">TR</a>
                <span class="nav-divider">|</span>
                <a href="erp-mod-admin.html" class="nav-link-small">EN</a>
            </div>
        </div>
    </nav>

    <main class="report">
        <a href="erp-deep-dives.html" class="back-link">Mod&uuml;llere D&ouml;n</a>
        <h1>ADMIN &mdash; S&Idot;STEM Y&Ouml;NET&Idot;M&Idot;</h1>
        <p class="subtitle">T&uuml;m ERP&rsquo;nin kontrol merkezi. Kullan&inodot;c&inodot; kimlikleri, yetkiler, kimlik do&gbreve;rulama, yaz&inodot;c&inodot; donan&inodot;m&inodot;, yazd&inodot;rma kuyru&gbreve;u izleme, AI asistan yap&inodot;land&inodot;rmas&inodot; ve aktivite denetimi &mdash; sistemi g&uuml;venli, yap&inodot;land&inodot;r&inodot;lm&inodot;&#351; ve g&ouml;zlemlenebilir tutan her &#351;ey.</p>
        <p class="authors">&#350;ubat 2026 &bull; Solen Kablo &bull; Ya&#351;ayan Dok&uuml;man</p>

        <div class="abstract">
            <p style="margin-bottom: 0;"><strong>Admin, kap&inodot; bekçisi ve kontrol odas&inodot;d&inodot;r.</strong> Herhangi bir operat&ouml;r QR kod tarayabilmeden, herhangi bir lab kullan&inodot;c&inodot;s&inodot; bir testi onaylayabilmeden, herhangi bir m&uuml;hendis kablo tasarlayabilmeden &ouml;nce &mdash; bu mod&uuml;lde do&gbreve;ru yetkilerle bir kullan&inodot;c&inodot; olarak var olmalar&inodot; gerekir. Admin, sisteme <em>kimin</em> eri&#351;ebilece&gbreve;ini, içeri girdikten sonra <em>ne</em> yapabileceklerini, <em>nas&inodot;l</em> kimlik do&gbreve;rulamas&inodot; yapacaklar&inodot;n&inodot; ve sistemin <em>hangi donan&inodot;mla</em> konu&#351;aca&gbreve;&inodot;n&inodot; tan&inodot;mlar. Rol tabanl&inodot; eri&#351;imi (super_admin, lab_user, operator) JSON olarak saklanan ultra-gran&uuml;ler sayfa-ve-buton d&uuml;zeyinde yetkilerle birle&#351;tiren hibrit bir yetki sistemi y&ouml;netir. Fabrikan&inodot;n etiket yaz&inodot;c&inodot;lar&inodot;n&inodot; kontrol eder, yazd&inodot;rma kuyru&gbreve;unu ger&ccedil;ek zamanl&inodot; izler ve AI asistan i&ccedil;in tam bir yap&inodot;land&inodot;rma aray&uuml;z&uuml; sa&gbreve;lar. Her kullan&inodot;c&inodot;n&inodot;n her eylemi bir denetim izine kaydedilir. Bu mod&uuml;l olmadan kimse giri&#351; yapamaz, hi&ccedil;bir etiket yazd&inodot;r&inodot;lamaz ve hi&ccedil;bir yetki uygulanamaz.</p>
        </div>

        <div class="stat-grid">
            <div class="stat-box">
                <div class="value" style="color: var(--accent);">4</div>
                <div class="label">ALT MOD&Uuml;L</div>
            </div>
            <div class="stat-box">
                <div class="value" style="color: var(--turquoise);">~36</div>
                <div class="label">API ENDPOINT</div>
            </div>
            <div class="stat-box">
                <div class="value">10</div>
                <div class="label">VER&Idot;TABANI TABLOSU</div>
            </div>
            <div class="stat-box">
                <div class="value" style="color: var(--positive);">3500+</div>
                <div class="label">SATIR KOD</div>
            </div>
        </div>

        <!-- TABLE OF CONTENTS -->
        <div style="background: #fff; border: 2px solid #000; padding: 20px 28px; margin: 24px 0;">
            <h3 style="margin: 0 0 12px 0; font-size: 14px; letter-spacing: 1px;">TABLE OF CONTENTS</h3>
            <div style="columns: 2; column-gap: 32px; font-size: 12px; line-height: 2;">
                <a href="#sec-1" style="text-decoration: none; color: var(--fg); display: block;"><strong>1.</strong> Admin Ne Yapar</a>
                <a href="#sec-2" style="text-decoration: none; color: var(--fg); display: block;"><strong>2.</strong> Veri Ak&inodot;&#351;&inodot;</a>
                <a href="#sec-3" style="text-decoration: none; color: var(--fg); display: block;"><strong>3.</strong> Veritaban&inodot; Katman&inodot;</a>
                <a href="#sec-4" style="text-decoration: none; color: var(--fg); display: block;"><strong>4.</strong> Backend Mimarisi</a>
                <a href="#sec-5" style="text-decoration: none; color: var(--fg); display: block;"><strong>5.</strong> &Ouml;ny&uuml;z</a>
                <a href="#sec-6" style="text-decoration: none; color: var(--fg); display: block;"><strong>6.</strong> Alt Mod&uuml;ller</a>
                <a href="#sec-6-1" style="text-decoration: none; color: #555; display: block; padding-left: 16px;">6.1 Yaz&inodot;c&inodot; Y&ouml;netimi</a>
                <a href="#sec-6-2" style="text-decoration: none; color: #555; display: block; padding-left: 16px;">6.2 Yazd&inodot;rma &Idot;zleme</a>
                <a href="#sec-6-3" style="text-decoration: none; color: #555; display: block; padding-left: 16px;">6.3 AI Ayarlar&inodot;</a>
                <a href="#sec-6-4" style="text-decoration: none; color: #555; display: block; padding-left: 16px;">6.4 Kullan&inodot;c&inodot; Y&ouml;netimi</a>
                <a href="#sec-7" style="text-decoration: none; color: var(--fg); display: block;"><strong>7.</strong> Sonu&ccedil;</a>
            </div>
        </div>

        <!-- ============================================ -->
        <h2 id="sec-1">1. ADMIN NE YAPAR</h2>
        <!-- ============================================ -->

        <p>Admin mod&uuml;l&uuml;, t&uuml;m ERP sisteminin ba&gbreve;l&inodot; oldu&gbreve;u alt&inodot; soruyu yan&inodot;tlar:</p>

        <table>
            <tr><th>Soru</th><th>Kim Yan&inodot;tlar</th><th>Nas&inodot;l</th></tr>
            <tr><td>Sistemi kim kullanabilir?</td><td>Kullan&inodot;c&inodot; Y&ouml;netimi</td><td>Rol atamas&inodot;yla kullan&inodot;c&inodot; hesaplar&inodot; olu&#351;tur/d&uuml;zenle/ask&inodot;ya al/sil</td></tr>
            <tr><td>Her kullan&inodot;c&inodot; ne yapabilir?</td><td>Yetki Sistemi</td><td>Hibrit rol tabanl&inodot; + gran&uuml;ler sayfa.buton JSON yetkileri</td></tr>
            <tr><td>Kullan&inodot;c&inodot;lar kimliklerini nas&inodot;l kan&inodot;tlar?</td><td>Kimlik Do&gbreve;rulama</td><td>Kullan&inodot;c&inodot; ad&inodot;/&#351;ifre &rarr; JWT eri&#351;im + yenileme token&rsquo;lar&inodot; ve oturum takibi</td></tr>
            <tr><td>Hangi yaz&inodot;c&inodot;lar var ve nerede?</td><td>Yaz&inodot;c&inodot; Y&ouml;netimi</td><td>IP, port, malzeme atamalar&inodot;, ba&gbreve;lant&inodot; testi ile a&gbreve; yaz&inodot;c&inodot; kayd&inodot;</td></tr>
            <tr><td>Yazd&inodot;rma kuyru&gbreve;unda ne oluyor?</td><td>Yazd&inodot;rma &Idot;zleme</td><td>4 yaz&inodot;c&inodot; genelinde t&uuml;m yazd&inodot;rma i&#351;lerinin ger&ccedil;ek zamanl&inodot; panosu, yeniden deneme/iptal</td></tr>
            <tr><td>AI asistan nas&inodot;l yap&inodot;land&inodot;r&inodot;l&inodot;r?</td><td>AI Ayarlar&inodot;</td><td>&Ccedil;oklu sa&gbreve;lay&inodot;c&inodot; API anahtar y&ouml;netimi, model se&ccedil;imi, denetim g&uuml;nl&uuml;&gbreve;&uuml;</td></tr>
        </table>

        <h3>1.1 &Uuml;&ccedil; Kullan&inodot;c&inodot; Tipi</h3>

        <p>Sistem, her biri farkl&inodot; eri&#351;im kapsam&inodot;na ve farkl&inodot; fiziksel kullan&inodot;m ba&gbreve;lam&inodot;na sahip &uuml;&ccedil; temel kullan&inodot;c&inodot; tipi tan&inodot;r:</p>

        <div class="arch-grid">
            <div class="arch-box">
                <h4>Super Admin</h4>
                <p>Tam sistem eri&#351;imi. Kullan&inodot;c&inodot;lar&inodot; y&ouml;netebilir, yaz&inodot;c&inodot;lar&inodot; yap&inodot;land&inodot;rabilir, AI ayarlar&inodot;n&inodot; de&gbreve;i&#351;tirebilir, aktivite g&uuml;nl&uuml;klerini g&ouml;r&uuml;nt&uuml;leyebilir ve her mod&uuml;le eri&#351;ebilir. Bu, fabrika m&uuml;d&uuml;r&uuml; veya IT y&ouml;neticisidir. Genellikle ofiste masa&uuml;st&uuml; bilgisayardan &ccedil;al&inodot;&#351;&inodot;r.</p>
            </div>
            <div class="arch-box">
                <h4>Lab Kullan&inodot;c&inodot;s&inodot;</h4>
                <p>Lab panosu, test y&ouml;netimi, kalite kontrol, uyar&inodot; y&ouml;netimi ve test raporlar&inodot;. Ayr&inodot;ca yaz&inodot;c&inodot; ba&gbreve;lant&inodot;lar&inodot;n&inodot; test edebilir ve ba&#351;ar&inodot;s&inodot;z yazd&inodot;rma i&#351;lerini yeniden deneyebilir. Bu, laboratuvarda &ccedil;al&inodot;&#351;an kalite m&uuml;hendisidir. Genellikle lab&rsquo;a &ouml;zel bir i&#351; istasyonundan &ccedil;al&inodot;&#351;&inodot;r.</p>
            </div>
            <div class="arch-box">
                <h4>Operat&ouml;r</h4>
                <p>Makine operasyonu, &uuml;retim formlar&inodot;, malzeme tarama, temel pano ve i&#351; emri g&ouml;r&uuml;nt&uuml;leme. Bu, fabrika zemininde &ccedil;al&inodot;&#351;an i&#351;&ccedil;idir. Genellikle &uuml;retim hatt&inodot;n&inodot;n yan&inodot;na monte edilmi&#351; bir <strong>kiosk telefondan</strong> &ccedil;al&inodot;&#351;&inodot;r &mdash; bu y&uuml;zden operat&ouml;r hesaplar&inodot; standart 12 saatlik s&uuml;re yerine 6 ayl&inodot;k JWT token al&inodot;r.</p>
            </div>
        </div>

        <h3>1.2 Hibrit Yetki Modeli</h3>

        <p>Yetki sistemi ayn&inodot; anda iki katmanda &ccedil;al&inodot;&#351;&inodot;r:</p>

        <div class="finding">
            <p style="margin-bottom: 8px;"><strong>Katman 1 &mdash; Rol Tabanl&inodot; (Eski):</strong> Kullan&inodot;c&inodot; kayd&inodot;ndaki <code>user_type</code> alan&inodot;. <code>is_permitted_user(user, ["super_admin", "lab_user"])</code> ile kontrol edilir. Bu kaba filtredir: &ldquo;en az&inodot;ndan lab kullan&inodot;c&inodot;s&inodot; m&inodot;s&inodot;n?&rdquo;</p>
            <p style="margin-bottom: 0;"><strong>Katman 2 &mdash; Gran&uuml;ler (Modern):</strong> Kullan&inodot;c&inodot; kayd&inodot;ndaki <code>permissions</code> JSON alan&inodot;. <code>check_user_permission(user, page_id, button_id)</code> ile kontrol edilir. Bu ince filtredir: &ldquo;Hammaddeler Listesi sayfas&inodot;nda Sil butonuna t&inodot;klayabilir misin?&rdquo;</p>
        </div>

        <p>Her iki katman, <code>check_permission_smart</code> ad&inodot;nda geriye uyumlu bir fonksiyon arac&inodot;l&inodot;&gbreve;&inodot;yla bir arada bulunur. &Ouml;nce eski rol tabanl&inodot; sistemi kontrol eder, sonra gran&uuml;ler JSON sistemine d&uuml;&#351;er. Super admin&rsquo;ler her ikisini de atlar &mdash; her zaman ge&ccedil;erler.</p>

        <h3>1.3 Kullan&inodot;c&inodot; Y&ouml;netiminin &Ouml;tesinde</h3>

        <p>Admin sadece kullan&inodot;c&inodot;larla ilgili de&gbreve;ildir. <strong>Fiziksel donan&inodot;m&inodot;</strong> (fabrika zeminindeki a&gbreve; yaz&inodot;c&inodot;lar&inodot;) y&ouml;neten, <strong>ger&ccedil;ek zamanl&inodot; operasyonel izleme</strong> (yazd&inodot;rma kuyru&gbreve;u panosu) sa&gbreve;layan ve di&gbreve;er kullan&inodot;c&inodot;lar&inodot;n etkile&#351;imde bulundu&gbreve;u <strong>AI asistan&inodot;</strong> kontrol eden tek mod&uuml;ld&uuml;r. Ayr&inodot;ca <code>user_activity_logs</code> tablosuna yazan tek mod&uuml;ld&uuml;r ve sistemde al&inodot;nan her y&ouml;netimsel eylemin denetim izini olu&#351;turur.</p>

        <!-- ============================================ -->
        <h2 id="sec-2">2. VER&Idot; AKI&#350;I</h2>
        <!-- ============================================ -->

        <p>Admin&rsquo;in veri ak&inodot;&#351;lar&inodot;, Hammadde veya Teknik gibi &uuml;retim mod&uuml;llerinden temelden farkl&inodot;d&inodot;r. Bu mod&uuml;llerin do&gbreve;rusal bir hatt&inodot; vard&inodot;r (tedarik&ccedil;i &rarr; sipari&#351; &rarr; giri&#351; &rarr; envanter). Admin ise bir <strong>g&ouml;bek-ve-kol (hub-and-spoke)</strong> desenine sahiptir: merkezde oturur ve di&gbreve;er her mod&uuml;l ona ba&gbreve;l&inodot;d&inodot;r.</p>

        <h3>2.1 Kimlik Do&gbreve;rulama Ak&inodot;&#351;&inodot;</h3>

        <div class="flow">
            <div class="flow-box">User opens app</div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box active">POST /auth/login</div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box">bcrypt verify</div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box done">JWT tokens issued</div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box">Session recorded</div>
        </div>

        <p>Bundan sonraki <em>t&uuml;m sistemdeki</em> her API &ccedil;a&gbreve;r&inodot;s&inodot;, <code>Authorization: Bearer</code> ba&#351;l&inodot;&gbreve;&inodot;nda JWT eri&#351;im token&rsquo;&inodot;n&inodot; ta&#351;&inodot;r. Token, kullan&inodot;c&inodot;n&inodot;n ID&rsquo;sini, kullan&inodot;c&inodot; ad&inodot;n&inodot;, user_type&rsquo;&inodot;n&inodot; ve yetkilerini i&ccedil;erir &mdash; bu da her mod&uuml;ldeki her route&rsquo;un ek bir veritaban&inodot; sorgusu olmadan kimli&gbreve;i do&gbreve;rulayabilece&gbreve;i ve yetkileri kontrol edebilece&gbreve;i anlam&inodot;na gelir.</p>

        <h3>2.2 Yetki Uygulama Ak&inodot;&#351;&inodot;</h3>

        <div class="flow">
            <div class="flow-box">API request arrives</div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box">JWT decoded</div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box active">check_permission_smart()</div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box">Role check OR page.button check</div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box done">Allow / 403 Forbidden</div>
        </div>

        <p>&Ouml;ny&uuml;zde ayn&inodot; kontrol proaktif olarak &ccedil;al&inodot;&#351;&inodot;r: route&rsquo;lar men&uuml;den gizlenir, butonlar devre d&inodot;&#351;&inodot; b&inodot;rak&inodot;l&inodot;r veya g&ouml;r&uuml;nmez yap&inodot;l&inodot;r ve do&gbreve;rudan URL eri&#351;imi denenirse t&uuml;m sayfalar kullan&inodot;c&inodot;n&inodot;n izin verilen panosuna y&ouml;nlendirilir.</p>

        <h3>2.3 Yazd&inodot;rma &Idot;&#351;i Ak&inodot;&#351;&inodot;</h3>

        <div class="flow">
            <div class="flow-box">Material Entry / Materials List</div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box active">POST /print-queue/queue/{id}</div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box">Job &rarr; QUEUED</div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box">Printer processes</div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box done">COMPLETED / FAILED</div>
        </div>

        <p>Yazd&inodot;rma i&#351;leri di&gbreve;er mod&uuml;ller taraf&inodot;ndan olu&#351;turulur (Hammadde Giri&#351;i teslimat kaydettikten sonra QR etiketleri yazd&inodot;r&inodot;r, Hammaddeler Listesi talep &uuml;zerine etiket yeniden yazd&inodot;r&inodot;r) ancak kuyru&gbreve;un kendisi Admin&rsquo;de ya&#351;ar. Yazd&inodot;rma &Idot;zleme, super admin&rsquo;lere d&ouml;rt fabrika yaz&inodot;c&inodot;s&inodot;ndaki t&uuml;m i&#351;lerin ger&ccedil;ek zamanl&inodot; g&ouml;r&uuml;n&uuml;m&uuml;n&uuml;, ba&#351;ar&inodot;s&inodot;z i&#351;leri yeniden deneme ve kuyruktakileri iptal etme yetene&gbreve;iyle sa&gbreve;lar.</p>

        <h3>2.4 AI Etkile&#351;im Ak&inodot;&#351;&inodot;</h3>

        <div class="flow">
            <div class="flow-box">User asks AI question</div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box active">POST /api/ai/chat</div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box">AI processes query</div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box">Response returned</div>
            <span class="flow-arrow">&rarr;</span>
            <div class="flow-box done">Audit log written</div>
        </div>

        <p>Her AI etkile&#351;imi kapsaml&inodot; olarak g&uuml;nl&uuml;&gbreve;e kaydedilir: kullan&inodot;c&inodot;n&inodot;n sorgusu, alg&inodot;lanan dil, kullan&inodot;lan AI modeli, ak&inodot;l y&uuml;r&uuml;tme ad&inodot;mlar&inodot;, ara&ccedil; &ccedil;a&gbreve;r&inodot;lar&inodot;, API yan&inodot;tlar&inodot;, zamanlama metrikleri ve g&uuml;venlik bayraklar&inodot;. Bu, AI&rsquo;n&inodot;n ne yapt&inodot;&gbreve;&inodot;n&inodot;n ve nedeninin tam bir adli izini olu&#351;turur.</p>

        <h3>2.5 G&ouml;bek-ve-Kol Ba&gbreve;&inodot;ml&inodot;l&inodot;&gbreve;&inodot;</h3>

        <div class="insight">
            <p style="margin-bottom: 0;"><strong>Sistemdeki her mod&uuml;l bir koldur; Admin g&ouml;bektir.</strong> Hammadde, her API &ccedil;a&gbreve;r&inodot;s&inodot;nda kullan&inodot;c&inodot; kimlik do&gbreve;rulamas&inodot; i&ccedil;in, QR etiketleri yazd&inodot;r&inodot;rken yaz&inodot;c&inodot; eri&#351;imi i&ccedil;in ve her buton t&inodot;klamas&inodot;nda yetki kontrol&uuml; i&ccedil;in Admin&rsquo;e ihtiya&ccedil; duyar. Teknik, operat&ouml;r kay&inodot;tlar&inodot; ve kullan&inodot;c&inodot; kimli&gbreve;i i&ccedil;in Admin&rsquo;e ihtiya&ccedil; duyar. &Uuml;retim, Lab, Sipari&#351;ler &mdash; hepsi her istekte <code>get_current_user_dependency</code>&rsquo;yi &ccedil;a&gbreve;&inodot;r&inodot;r ve bu, Admin&rsquo;in verdi&gbreve;i JWT token&rsquo;&inodot;n&inodot; &ccedil;&ouml;zer. Admin &ccedil;&ouml;kerse, t&uuml;m sistem kilitlenir.</p>
        </div>

        <!-- ============================================ -->
        <h2 id="sec-3">3. VER&Idot;TABANI KATMANI</h2>
        <!-- ============================================ -->

        <p>Admin mod&uuml;l&uuml; <strong>10 veritaban&inodot; tablosuna</strong> sahiptir, bu di&gbreve;er t&uuml;m mod&uuml;llerden fazlad&inodot;r. Bu tablolar d&ouml;rt gruba ayr&inodot;l&inodot;r: kimlik, oturumlar, donan&inodot;m ve denetim.</p>

        <h3>3.1 Kimlik Tablolar&inodot;</h3>

        <table>
            <tr><th>Tablo</th><th>Ama&ccedil;</th><th>Anahtar S&uuml;tunlar</th><th>&Idot;li&#351;kiler</th></tr>
            <tr>
                <td><code>users</code></td>
                <td>Sistemdeki her ki&#351;inin temel kimli&gbreve;i</td>
                <td>id, username (unique), email (unique), hashed_password, user_type, status, is_active, is_superuser, permissions (JSON text), force_password_change, last_login, preferred_interface, device_info</td>
                <td>1&mdash;N user_sessions, 0..1 super_admins, 0..1 lab_users, 0..1 operators</td>
            </tr>
            <tr>
                <td><code>super_admins</code></td>
                <td>Super admin kullan&inodot;c&inodot;lar i&ccedil;in ek veriler</td>
                <td>id, user_id (FK, unique), admin_level, permissions (JSON), access_logs (JSON)</td>
                <td>N&mdash;1 users</td>
            </tr>
            <tr>
                <td><code>lab_users</code></td>
                <td>Laboratuvar kullan&inodot;c&inodot;lar&inodot; i&ccedil;in ek veriler</td>
                <td>id, user_id (FK, unique), lab_department, certifications (JSON), test_specializations (JSON), shift_schedule (JSON)</td>
                <td>N&mdash;1 users</td>
            </tr>
            <tr>
                <td><code>operators</code></td>
                <td>Fabrika zemini operat&ouml;rleri i&ccedil;in ek veriler</td>
                <td>id, user_id (FK, unique), assigned_machines (JSON), shift_schedule (JSON), skill_level, certifications (JSON)</td>
                <td>N&mdash;1 users</td>
            </tr>
            <tr>
                <td><code>user_roles</code></td>
                <td>Yeniden kullan&inodot;labilir yetki &#351;ablonlar&inodot;</td>
                <td>id, name (unique), description, permissions (JSON text), is_system (silmeyi engeller)</td>
                <td>Ba&gbreve;&inodot;ms&inodot;z (&#351;ablon deposu)</td>
            </tr>
        </table>

        <div class="finding">
            <p style="margin-bottom: 0;"><strong>Kal&inodot;t&inodot;m Deseni:</strong> Sistem, nullable s&uuml;tunlu tek tablo kal&inodot;t&inodot;m&inodot; yerine bir <strong>birle&#351;ik tablo deseni</strong> kullan&inodot;r. <code>users</code> tablosu ortak alanlar&inodot; (giri&#351; bilgileri, durum, yetkiler) tutar. Uzant&inodot; tablolar&inodot; (<code>super_admins</code>, <code>lab_users</code>, <code>operators</code>), <code>users.id</code>&rsquo;ye unique FK arac&inodot;l&inodot;&gbreve;&inodot;yla tipe &ouml;zel alanlar&inodot; tutar. Bu, temel <code>users</code> tablosunu yalın tutarken her kullan&inodot;c&inodot; tipinin &ouml;zel veri depolamas&inodot;na izin verir (&ouml;rn. operat&ouml;rlerin <code>assigned_machines</code>&rsquo;i, lab kullan&inodot;c&inodot;lar&inodot;n&inodot;n <code>certifications</code>&rsquo;&inodot; vard&inodot;r).</p>
        </div>

        <h3>3.2 Oturum Tablosu</h3>

        <table>
            <tr><th>Tablo</th><th>Ama&ccedil;</th><th>Anahtar S&uuml;tunlar</th><th>&Idot;li&#351;kiler</th></tr>
            <tr>
                <td><code>user_sessions</code></td>
                <td>Aktif ve ge&ccedil;mi&#351; giri&#351; oturumlar&inodot;</td>
                <td>id, user_id (FK), session_token (unique, indexed), refresh_token (unique, indexed), login_time, logout_time, expires_at, ip_address (IPv6-ready, 45 chars), user_agent, device_type, status</td>
                <td>N&mdash;1 users (cascade delete)</td>
            </tr>
        </table>

        <p>Oturumlar sadece token do&gbreve;rulama i&ccedil;in de&gbreve;ildir. Tam bir giri&#351; ge&ccedil;mi&#351;i sa&gbreve;larlar: hangi cihaz kullan&inodot;ld&inodot;, hangi IP&rsquo;den, ne zaman giri&#351; yap&inodot;ld&inodot;, ne zaman &ccedil;&inodot;k&inodot;&#351; yap&inodot;ld&inodot; (veya oturum s&uuml;resi doldu mu). <code>users</code> ili&#351;kisindeki cascade delete, bir kullan&inodot;c&inodot;y&inodot; silmenin t&uuml;m oturumlar&inodot;n&inodot; otomatik olarak temizlemesi anlam&inodot;na gelir.</p>

        <h3>3.3 Donan&inodot;m Tablolar&inodot;</h3>

        <table>
            <tr><th>Tablo</th><th>Ama&ccedil;</th><th>Anahtar S&uuml;tunlar</th><th>&Idot;li&#351;kiler</th></tr>
            <tr>
                <td><code>printers</code></td>
                <td>Fabrika zeminindeki a&gbreve; etiket yaz&inodot;c&inodot;lar&inodot;</td>
                <td>id, name, description, ip_address, port (default 9100), status (ONLINE/OFFLINE/ERROR/MAINTENANCE), is_active, assigned_materials (JSON array), location, last_checked</td>
                <td>Standalone</td>
            </tr>
            <tr>
                <td><code>print_jobs</code></td>
                <td>Etiket yazd&inodot;rma i&#351; kuyru&gbreve;u ve ge&ccedil;mi&#351;i</td>
                <td>id, material_id (FK &rarr; raw_materials), qr_code, printer_id (1&ndash;4), copies, status (QUEUED/PRINTING/COMPLETED/FAILED/CANCELLED), retry_count, error_message, requested_by (FK &rarr; users), requested_at, started_at, completed_at, material_type, lot_number, supplier_name</td>
                <td>N&mdash;1 raw_materials, N&mdash;1 users</td>
            </tr>
        </table>

        <div class="finding">
            <p style="margin-bottom: 0;"><strong>G&ouml;r&uuml;nt&uuml;leme i&ccedil;in denormalize:</strong> <code>print_jobs</code> tablosu, <code>material_type</code>, <code>lot_number</code> ve <code>supplier_name</code>&rsquo;i malzeme kayd&inodot;ndan denormalize kopyalar olarak saklar. Bu, Yazd&inodot;rma &Idot;zleme&rsquo;nin <code>raw_materials</code> veya <code>suppliers</code>&rsquo;a join yapmadan i&#351; ge&ccedil;mi&#351;ini g&ouml;r&uuml;nt&uuml;leyebilmesi anlam&inodot;na gelir &mdash; s&inodot;k yenilenen ger&ccedil;ek zamanl&inodot; bir izleme panosu i&ccedil;in kritiktir.</p>
        </div>

        <h3>3.4 Denetim Tablolar&inodot;</h3>

        <table>
            <tr><th>Tablo</th><th>Ama&ccedil;</th><th>Anahtar S&uuml;tunlar</th><th>&Idot;li&#351;kiler</th></tr>
            <tr>
                <td><code>user_activity_logs</code></td>
                <td>T&uuml;m admin eylemlerinin denetim izi</td>
                <td>id, user_id (FK, indexed), username (denormalized), action, module, target_type, target_id, details (JSON), ip_address, user_agent, created_at (indexed)</td>
                <td>N&mdash;1 users</td>
            </tr>
            <tr>
                <td><code>ai_audit_logs</code></td>
                <td>Kapsaml&inodot; AI etkile&#351;im adli analizi</td>
                <td>id, user_id, username, user_type, session_id, ip_address, device_type, browser, os, original_query, query_language, ai_model, ai_reasoning, ai_confidence, selected_tool, tool_params, api_endpoint, api_response_status, success, error_type, total_duration_ms, ai_processing_ms, security_flags, was_blocked, block_reason, created_at</td>
                <td>Standalone (47 columns)</td>
            </tr>
        </table>

        <div class="philosophy">
            <p style="margin-bottom: 0;"><strong>AI denetim tablosu t&uuml;m sistemdeki en geni&#351; tablodur</strong> &mdash; 47 s&uuml;tun. Bu kas&inodot;tl&inodot;d&inodot;r. Her AI etkile&#351;imi &ccedil;ok ad&inodot;ml&inodot; bir hatt&inodot;r (sorgu ayr&inodot;&#351;t&inodot;rma &rarr; ara&ccedil; se&ccedil;imi &rarr; API &ccedil;a&gbreve;r&inodot;s&inodot; &rarr; yan&inodot;t &uuml;retimi) ve her ad&inodot;m hata ay&inodot;klama veya g&uuml;venlik incelemesi i&ccedil;in gerekebilecek veri &uuml;retir. Tablo, tam tablo taramas&inodot; olmadan analitik sorgular&inodot; desteklemek i&ccedil;in (user_id, created_at), (selected_tool, created_at), (success, created_at) ve (ip_address, created_at) &uuml;zerinde bile&#351;ik indekslere sahiptir.</p>
        </div>

        <h3>3.5 Varl&inodot;k-&Idot;li&#351;ki &Ouml;zeti</h3>

        <table>
            <tr><th>&Idot;li&#351;ki</th><th>Tip</th><th>Kademeli Silme</th></tr>
            <tr><td>users &rarr; user_sessions</td><td>1&mdash;N</td><td>Delete (kullan&inodot;c&inodot; silinince oturumlar temizlenir)</td></tr>
            <tr><td>users &rarr; super_admins</td><td>1&mdash;0..1</td><td>Yok (uzant&inodot; tablosu)</td></tr>
            <tr><td>users &rarr; lab_users</td><td>1&mdash;0..1</td><td>Yok (uzant&inodot; tablosu)</td></tr>
            <tr><td>users &rarr; operators</td><td>1&mdash;0..1</td><td>Yok (uzant&inodot; tablosu)</td></tr>
            <tr><td>users &rarr; user_activity_logs</td><td>1&mdash;N</td><td>Yok (loglar kullan&inodot;c&inodot; silinse de kal&inodot;r)</td></tr>
            <tr><td>users &rarr; print_jobs (requested_by)</td><td>1&mdash;N</td><td>Yok</td></tr>
            <tr><td>raw_materials &rarr; print_jobs (material_id)</td><td>1&mdash;N</td><td>Yok (&ccedil;apraz mod&uuml;l FK)</td></tr>
        </table>

        <!-- ============================================ -->
        <h2 id="sec-4">4. BACKEND M&Idot;MAR&Idot;S&Idot;</h2>
        <!-- ============================================ -->

        <p>Admin backend&rsquo;i be&#351; route grubu, bir temel servis, bir g&uuml;venlik mod&uuml;l&uuml; ve bir yetki yard&inodot;mc&inodot; katman&inodot; olarak organize edilmi&#351;tir. Tek bir route dosyas&inodot;na sahip &uuml;retim mod&uuml;llerinin aksine, Admin birden fazla dosyaya yay&inodot;l&inodot;r &ccedil;&uuml;nk&uuml; sorumluluklar&inodot; birbirinden temelden farkl&inodot;d&inodot;r.</p>

        <h3>4.1 Route Gruplar&inodot;</h3>

        <table>
            <tr><th>Route Grubu</th><th>&Ouml;nek</th><th>Endpoint</th><th>Auth Gerekli</th><th>Min. Rol</th></tr>
            <tr><td>Kimlik Do&gbreve;rulama</td><td><code>/api/auth</code></td><td>5</td><td>Kar&inodot;&#351;&inodot;k (login herkese a&ccedil;&inodot;k)</td><td>Yok / Herhangi</td></tr>
            <tr><td>Kullan&inodot;c&inodot; Y&ouml;netimi</td><td><code>/api/user-management</code></td><td>9</td><td>Evet</td><td>Super Admin (&ccedil;o&gbreve;u), Herhangi (operat&ouml;r listesi)</td></tr>
            <tr><td>Yaz&inodot;c&inodot;lar</td><td><code>/api/printers</code></td><td>5</td><td>Evet</td><td>Super Admin (CRUD), Lab User (test)</td></tr>
            <tr><td>Yazd&inodot;rma Kuyru&gbreve;u</td><td><code>/api/print-queue</code></td><td>5</td><td>Evet</td><td>Herhangi (kuyruk), Super Admin (y&ouml;netim)</td></tr>
            <tr><td>AI</td><td><code>/api/ai</code></td><td>12</td><td>Evet</td><td>Herhangi (sohbet), Super Admin (yap&inodot;land&inodot;rma)</td></tr>
        </table>

        <h3>4.2 Kimlik Do&gbreve;rulama Endpoint&rsquo;leri (5)</h3>

        <table>
            <tr><th>Metod</th><th>Yol</th><th>Ama&ccedil;</th><th>Temel Davran&inodot;&#351;</th></tr>
            <tr><td>POST</td><td>/auth/login</td><td>Kullan&inodot;c&inodot; giri&#351;i</td><td>Kullan&inodot;c&inodot; ad&inodot;/&#351;ifre + device_type + remember_me kabul eder. access_token, refresh_token, expires_in, user objesi d&ouml;nd&uuml;r&uuml;r. Oturum kayd&inodot; olu&#351;turur.</td></tr>
            <tr><td>POST</td><td>/auth/logout</td><td>Oturumu sonland&inodot;r</td><td>Oturum durumunu &ldquo;terminated&rdquo; yapar, logout_time damgalar.</td></tr>
            <tr><td>POST</td><td>/auth/refresh</td><td>Eri&#351;im token&rsquo;&inodot; yenile</td><td>refresh_token&rsquo;&inodot; do&gbreve;rular, yeni access_token &uuml;retir. Refresh token&rsquo;&inodot; d&ouml;nd&uuml;rmez.</td></tr>
            <tr><td>GET</td><td>/auth/me</td><td>Mevcut kullan&inodot;c&inodot; bilgisi</td><td>JWT&rsquo;yi &ccedil;&ouml;zer, ayr&inodot;&#351;t&inodot;r&inodot;lm&inodot;&#351; yetkilerle tam kullan&inodot;c&inodot; objesi d&ouml;nd&uuml;r&uuml;r.</td></tr>
            <tr><td>GET</td><td>/auth/health</td><td>Sa&gbreve;l&inodot;k kontrolü</td><td>Durum + veritaban&inodot; ba&gbreve;lant&inodot; kontrol&uuml; d&ouml;nd&uuml;r&uuml;r.</td></tr>
        </table>

        <h3>4.3 Kullan&inodot;c&inodot; Y&ouml;netimi Endpoint&rsquo;leri (9)</h3>

        <table>
            <tr><th>Metod</th><th>Yol</th><th>Ama&ccedil;</th><th>Temel Davran&inodot;&#351;</th></tr>
            <tr><td>GET</td><td>/user-management/users/list</td><td>T&uuml;m kullan&inodot;c&inodot;lar&inodot; listele</td><td>status_filter ve user_type sorgu parametrelerini destekler. Yetkileri JSON string&rsquo;den objeye ayr&inodot;&#351;t&inodot;r&inodot;r.</td></tr>
            <tr><td>GET</td><td>/user-management/operators</td><td>Operat&ouml;rleri listele</td><td>Sadece aktif operat&ouml;rleri d&ouml;nd&uuml;r&uuml;r. T&uuml;m kimli&gbreve;i do&gbreve;rulanm&inodot;&#351; kullan&inodot;c&inodot;lara a&ccedil;&inodot;kt&inodot;r (&uuml;retim mod&uuml;lleri i&ccedil;in gerekli).</td></tr>
            <tr><td>POST</td><td>/user-management/users/create</td><td>Kullan&inodot;c&inodot; olu&#351;tur</td><td>Sa&gbreve;lanmazsa &#351;ifreyi otomatik &uuml;retir. force_password_change ayarlar. Aktivite g&uuml;nl&uuml;&gbreve;&uuml;ne kaydeder.</td></tr>
            <tr><td>PUT</td><td>/user-management/users/{id}</td><td>Kullan&inodot;c&inodot; g&uuml;ncelle</td><td>K&inodot;smi g&uuml;ncelleme: username, email, full_name, user_type, status, is_active, permissions, password.</td></tr>
            <tr><td>POST</td><td>/user-management/users/{id}/suspend</td><td>Ask&inodot;ya al/a&ccedil;</td><td>&ldquo;active&rdquo; ve &ldquo;suspended&rdquo; durumlar&inodot; aras&inodot;nda ge&ccedil;i&#351; yapar. Aktivite g&uuml;nl&uuml;&gbreve;&uuml;ne kaydeder.</td></tr>
            <tr><td>DELETE</td><td>/user-management/users/{id}</td><td>Kullan&inodot;c&inodot;y&inodot; kal&inodot;c&inodot; sil</td><td>Kal&inodot;c&inodot; silme. Kendini silmeyi engeller (kendi hesab&inodot;n&inodot;z&inodot; silemezsiniz).</td></tr>
            <tr><td>POST</td><td>/user-management/users/{id}/reset-password</td><td>&#350;ifre s&inodot;f&inodot;rlamay&inodot; zorla</td><td>G&uuml;venli 12 karakterli rastgele &#351;ifre &uuml;retir (harf + rakam + sembol). force_password_change=True ayarlar.</td></tr>
            <tr><td>GET</td><td>/user-management/roles/list</td><td>Rol &#351;ablonlar&inodot;n&inodot; listele</td><td>Yetki &#351;ablonu atamas&inodot;nda kullan&inodot;lmak &uuml;zere t&uuml;m UserRole kay&inodot;tlar&inodot;n&inodot; d&ouml;nd&uuml;r&uuml;r.</td></tr>
            <tr><td>GET</td><td>/user-management/activity-logs</td><td>Aktivite g&uuml;nl&uuml;&gbreve;&uuml; g&ouml;r&uuml;nt&uuml;leyici</td><td>user_id, module, action&rsquo;a g&ouml;re filtrelemeyi destekler. Varsay&inodot;lan limit 200.</td></tr>
        </table>

        <h3>4.4 Yaz&inodot;c&inodot; &amp; Yazd&inodot;rma Kuyru&gbreve;u Endpoint&rsquo;leri (10)</h3>

        <table>
            <tr><th>Metod</th><th>Yol</th><th>Ama&ccedil;</th><th>Temel Davran&inodot;&#351;</th></tr>
            <tr><td>GET</td><td>/printers/list</td><td>Yaz&inodot;c&inodot;lar&inodot; listele</td><td>Opsiyonel active_only filtresi.</td></tr>
            <tr><td>POST</td><td>/printers/create</td><td>Yaz&inodot;c&inodot; ekle</td><td>Ad, IP, port (varsay&inodot;lan 9100), konum, assigned_materials (JSON dizisi).</td></tr>
            <tr><td>PUT</td><td>/printers/update/{id}</td><td>Yaz&inodot;c&inodot; d&uuml;zenle</td><td>T&uuml;m alanlar g&uuml;ncellenebilir.</td></tr>
            <tr><td>POST</td><td>/printers/{id}/test</td><td>Ba&gbreve;lant&inodot; testi</td><td>Yaz&inodot;c&inodot; IP:port&rsquo;a a&gbreve; ba&gbreve;lant&inodot;s&inodot; dener. Durumu ONLINE veya OFFLINE olarak g&uuml;nceller.</td></tr>
            <tr><td>DELETE</td><td>/printers/{id}</td><td>Yaz&inodot;c&inodot; kald&inodot;r</td><td>Silmeye izin vermeden &ouml;nce bekleyen yazd&inodot;rma i&#351;lerini kontrol eder.</td></tr>
            <tr><td>POST</td><td>/print-queue/queue/{material_id}</td><td>Etiket yazd&inodot;rmay&inodot; kuyru&gbreve;a ekle</td><td>Malzeme ve talep eden kullan&inodot;c&inodot;ya ba&gbreve;l&inodot; QUEUED i&#351; olu&#351;turur. Yaz&inodot;c&inodot; sorgu parametresiyle se&ccedil;ilir (1&ndash;4).</td></tr>
            <tr><td>GET</td><td>/print-queue/jobs</td><td>&Idot;&#351; ge&ccedil;mi&#351;i</td><td>status, printer_id&rsquo;ye g&ouml;re filtrelenebilir. Maksimum 500 sonu&ccedil;.</td></tr>
            <tr><td>POST</td><td>/print-queue/jobs/{id}/retry</td><td>Ba&#351;ar&inodot;s&inodot;z i&#351;i yeniden dene</td><td>Durumu QUEUED&rsquo;a s&inodot;f&inodot;rlar, retry_count&rsquo;u art&inodot;r&inodot;r.</td></tr>
            <tr><td>DELETE</td><td>/print-queue/jobs/{id}</td><td>&Idot;&#351;i iptal et</td><td>Sadece QUEUED i&#351;ler iptal edilebilir (PRINTING de&gbreve;il).</td></tr>
            <tr><td>GET</td><td>/print-queue/stats</td><td>Kuyruk istatistikleri</td><td>Say&inodot;lar&inodot; d&ouml;nd&uuml;r&uuml;r: queued, printing, completed, failed.</td></tr>
        </table>

        <h3>4.5 AI Endpoint&rsquo;leri (12)</h3>

        <table>
            <tr><th>Metod</th><th>Yol</th><th>Ama&ccedil;</th><th>Temel Davran&inodot;&#351;</th></tr>
            <tr><td>POST</td><td>/api/ai/chat</td><td>AI sorgusu g&ouml;nder</td><td>Ana sohbet endpoint&rsquo;i. Sorguyu i&#351;ler, ara&ccedil;lar&inodot; &ccedil;a&gbreve;&inodot;r&inodot;r, yan&inodot;t d&ouml;nd&uuml;r&uuml;r.</td></tr>
            <tr><td>GET</td><td>/api/ai/status</td><td>Servis durumu</td><td>AI servis sa&gbreve;l&inodot;&gbreve;&inodot; ve yap&inodot;land&inodot;rma durumunu d&ouml;nd&uuml;r&uuml;r.</td></tr>
            <tr><td>GET</td><td>/api/ai/models</td><td>Mevcut modeller</td><td>Sa&gbreve;lay&inodot;c&inodot;lar genelinde desteklenen t&uuml;m AI modellerini listeler.</td></tr>
            <tr><td>POST</td><td>/api/ai/reset</td><td>AI ajan&inodot;n&inodot; s&inodot;f&inodot;rla</td><td>Konu&#351;ma ba&gbreve;lam&inodot;n&inodot; temizler ve ajan durumunu s&inodot;f&inodot;rlar.</td></tr>
            <tr><td>GET</td><td>/api/ai/config</td><td>Yap&inodot;land&inodot;rmay&inodot; getir</td><td>Mevcut de&gbreve;erleri d&ouml;nd&uuml;r&uuml;r: enabled bayra&gbreve;&inodot;, model_name, max_tokens, temperature.</td></tr>
            <tr><td>POST</td><td>/api/ai/config</td><td>Yap&inodot;land&inodot;rmay&inodot; kaydet</td><td>AI ayarlar&inodot;n&inodot; g&uuml;nceller. Sadece super admin.</td></tr>
            <tr><td>GET</td><td>/api/ai/stats</td><td>Kullan&inodot;m istatistikleri</td><td>Sorgu say&inodot;lar&inodot;, ba&#351;ar&inodot; oranlar&inodot;, ortalama yan&inodot;t s&uuml;releri.</td></tr>
            <tr><td>GET</td><td>/api/ai/audit-logs</td><td>Denetim g&uuml;nl&uuml;&gbreve;&uuml; g&ouml;r&uuml;nt&uuml;leyici</td><td>Sayfalanm&inodot;&#351; (limit + offset). Tam etkile&#351;im adli analizini d&ouml;nd&uuml;r&uuml;r.</td></tr>
            <tr><td>GET</td><td>/api/ai/api-keys/status</td><td>API anahtar durumu</td><td>Her sa&gbreve;lay&inodot;c&inodot; i&ccedil;in maskeli anahtar durumunu d&ouml;nd&uuml;r&uuml;r (&ouml;rn. &ldquo;sk-***...abc&rdquo;).</td></tr>
            <tr><td>POST</td><td>/api/ai/api-keys/save</td><td>API anahtar&inodot; sakla</td><td>.env dosyas&inodot;na yazar. Gemini, OpenAI, Anthropic destekler. Yan&inodot;tta maskeler.</td></tr>
            <tr><td>DELETE</td><td>/api/ai/api-keys/{provider}</td><td>API anahtar&inodot; kald&inodot;r</td><td>.env dosyas&inodot;ndan anahtar&inodot; kald&inodot;r&inodot;r.</td></tr>
            <tr><td>POST</td><td>/api/ai/api-keys/test/{provider}</td><td>API anahtar&inodot;n&inodot; test et</td><td>Anahtar&inodot;n &ccedil;al&inodot;&#351;t&inodot;&gbreve;&inodot;n&inodot; do&gbreve;rulamak i&ccedil;in hafif bir API &ccedil;a&gbreve;r&inodot;s&inodot; yapar.</td></tr>
        </table>

        <h3>4.6 Temel Servisler</h3>

        <h4>AuthenticationService</h4>
        <p>Merkezi kimlik do&gbreve;rulama motoru. Be&#351; operasyon y&uuml;r&uuml;t&uuml;r:</p>
        <ul>
            <li><strong>authenticate_user</strong> &mdash; Kullan&inodot;c&inodot;y&inodot; kullan&inodot;c&inodot; ad&inodot; veya e-posta ile bulur, &#351;ifreyi bcrypt ile do&gbreve;rular, <code>last_login</code> zaman damgas&inodot;n&inodot; g&uuml;nceller.</li>
            <li><strong>create_user_session</strong> &mdash; JWT eri&#351;im ve yenileme token&rsquo;lar&inodot; &uuml;retir. <em>Kritik detay:</em> operat&ouml;r hesaplar&inodot; 6 ayl&inodot;k token s&uuml;resi al&inodot;r (yeniden giri&#351; gerektirmemesi gereken kiosk telefonlar i&ccedil;in), di&gbreve;er t&uuml;m hesaplar standart 12 saatlik s&uuml;re al&inodot;r.</li>
            <li><strong>get_user_by_token</strong> &mdash; JWT&rsquo;yi &ccedil;&ouml;zer, s&uuml;re dolumunu do&gbreve;rular, kullan&inodot;c&inodot;n&inodot;n hala var olup olmad&inodot;&gbreve;&inodot;n&inodot; ve aktif olup olmad&inodot;&gbreve;&inodot;n&inodot; kontrol eder.</li>
            <li><strong>logout_user</strong> &mdash; Oturum kayd&inodot;n&inodot; sonland&inodot;r&inodot;r, &ccedil;&inodot;k&inodot;&#351; zaman&inodot;n&inodot; damgalar.</li>
            <li><strong>refresh_token</strong> &mdash; Yenileme token&rsquo;&inodot;n&inodot; do&gbreve;rular, yeni bir oturum olu&#351;turmadan yeni eri&#351;im token&rsquo;&inodot; verir.</li>
        </ul>

        <h4>SecurityManager</h4>
        <p>D&uuml;&#351;&uuml;k seviye kriptografik operasyonlar: bcrypt &#351;ifre hashleme ve do&gbreve;rulama, yap&inodot;land&inodot;r&inodot;labilir s&uuml;reli JWT olu&#351;turma, imza do&gbreve;rulamal&inodot; JWT &ccedil;&ouml;zme ve token s&uuml;re dolumu do&gbreve;rulama. Yap&inodot;land&inodot;r&inodot;labilir gizli anahtar ile HS256 algoritmas&inodot; kullan&inodot;r.</p>

        <h4>Yetki Yard&inodot;mc&inodot;lar&inodot;</h4>
        <p>Sistemdeki her mod&uuml;l taraf&inodot;ndan kullan&inodot;lan yetki kontrol omurgas&inodot;n&inodot; olu&#351;turan d&ouml;rt fonksiyon:</p>
        <ul>
            <li><code>is_permitted_user(user, required_types)</code> &mdash; Eski rol kontrol&uuml;. Super admin her zaman ge&ccedil;er.</li>
            <li><code>check_user_permission(user, page_id, button_id)</code> &mdash; Gran&uuml;ler JSON yetki kontrol&uuml;. Kullan&inodot;c&inodot;n&inodot;n <code>permissions</code> alan&inodot;n&inodot; ayr&inodot;&#351;t&inodot;r&inodot;r, <code>pages[page_id].buttons[button_id]</code>&rsquo;ye gider.</li>
            <li><code>has_special_permission(user, permission)</code> &mdash; <code>hard_delete</code> veya <code>manage_users</code> gibi &ouml;zel bayraklar&inodot; kontrol eder.</li>
            <li><code>check_permission_smart(user, required_types, page_id, button_id)</code> &mdash; Birle&#351;ik giri&#351; noktas&inodot;. &Ouml;nce rol tabanl&inodot;y&inodot; dener, sonra gran&uuml;lere d&uuml;&#351;er. &Ccedil;o&gbreve;u route&rsquo;un ger&ccedil;ekte &ccedil;a&gbreve;&inodot;rd&inodot;&gbreve;&inodot; budur.</li>
        </ul>

        <h3>4.7 FastAPI Ba&gbreve;&inodot;ml&inodot;l&inodot;klar&inodot;</h3>

        <p>Admin, sistemdeki her mod&uuml;l&uuml;n i&ccedil;e aktard&inodot;&gbreve;&inodot; d&ouml;rt enjekte edilebilir ba&gbreve;&inodot;ml&inodot;l&inodot;k tan&inodot;mlar:</p>

        <table>
            <tr><th>Ba&gbreve;&inodot;ml&inodot;l&inodot;k</th><th>Ne Yapar</th><th>Kullanan</th></tr>
            <tr><td><code>get_current_user_dependency</code></td><td>Authorization ba&#351;l&inodot;&gbreve;&inodot;ndaki JWT token&rsquo;dan kullan&inodot;c&inodot;y&inodot; &ccedil;&inodot;kar&inodot;r ve do&gbreve;rular</td><td>Sistemdeki her kimli&gbreve;i do&gbreve;rulanm&inodot;&#351; endpoint</td></tr>
            <tr><td><code>require_super_admin</code></td><td>user_type &ldquo;super_admin&rdquo; de&gbreve;ilse 403 f&inodot;rlat&inodot;r</td><td>Admin CRUD operasyonlar&inodot;, sistem yap&inodot;land&inodot;rmas&inodot;</td></tr>
            <tr><td><code>require_lab_user</code></td><td>user_type &ldquo;lab_user&rdquo; veya &ldquo;super_admin&rdquo; de&gbreve;ilse 403 f&inodot;rlat&inodot;r</td><td>Lab test route&rsquo;lar&inodot;, kalite kontrol</td></tr>
            <tr><td><code>require_operator</code></td><td>user_type &ldquo;operator&rdquo; veya &uuml;st&uuml; de&gbreve;ilse 403 f&inodot;rlat&inodot;r</td><td>&Uuml;retim route&rsquo;lar&inodot;, malzeme tarama</td></tr>
        </table>

        <div class="insight">
            <p style="margin-bottom: 0;"><strong>Admin, g&uuml;venlik katman&inodot;n&inodot; i&ccedil;e aktar&inodot;labilir ba&gbreve;&inodot;ml&inodot;l&inodot;klar olarak d&inodot;&#351;a aktar&inodot;r.</strong> Bu, Admin&rsquo;i g&ouml;bek yapan mimari mekanizmad&inodot;r: di&gbreve;er mod&uuml;ller kendi kimlik do&gbreve;rulamalar&inodot;n&inodot; uygulamaz &mdash; Admin&rsquo;den <code>get_current_user_dependency</code>&rsquo;yi i&ccedil;e aktar&inodot;r ve FastAPI <code>Depends()</code> parametresi olarak kullan&inodot;rlar. Tek do&gbreve;ruluk kayna&gbreve;&inodot;, s&inodot;f&inodot;r tekrar.</p>
        </div>

        <!-- ============================================ -->
        <h2 id="sec-5">5. &Ouml;NY&Uuml;Z</h2>
        <!-- ============================================ -->

        <p>Admin &ouml;ny&uuml;z&uuml;, be&#351; ayr&inodot; sayfa ile t&uuml;m uygulamadaki her sayfay&inodot; etkileyen kesmesel bir yetki katman&inodot;ndan olu&#351;ur.</p>

        <h3>5.1 Sayfa Envanteri</h3>

        <table>
            <tr><th>Sayfa</th><th>Route</th><th>Bile&#351;en</th><th>Eri&#351;im</th></tr>
            <tr><td>Giri&#351;</td><td>/user/login</td><td>src/pages/user/login/index.tsx</td><td>Herkese a&ccedil;&inodot;k (kimlik do&gbreve;rulamas&inodot;z)</td></tr>
            <tr><td>Kullan&inodot;c&inodot; Y&ouml;netimi</td><td>/admin/user-management</td><td>src/pages/Admin/UserManagement/index.tsx</td><td>canAdmin</td></tr>
            <tr><td>Yaz&inodot;c&inodot; Y&ouml;netimi</td><td>/admin/printer-management</td><td>src/pages/Admin/PrinterManagement/index.tsx</td><td>canAdmin</td></tr>
            <tr><td>Yazd&inodot;rma &Idot;zleme</td><td>/admin/print-monitor</td><td>src/pages/Admin/PrintJobMonitor/index.tsx</td><td>canAdmin</td></tr>
            <tr><td>AI Ayarlar&inodot;</td><td>/admin/ai-settings</td><td>src/pages/Admin/AISettings/index.tsx</td><td>canAdmin</td></tr>
        </table>

        <p>D&ouml;rt admin sayfas&inodot;n&inodot;n t&uuml;m&uuml; <code>/admin</code> route &ouml;neki alt&inodot;nda oturur ve g&ouml;r&uuml;n&uuml;rl&uuml;&gbreve;&uuml; super admin kullan&inodot;c&inodot;larla s&inodot;n&inodot;rlayan <code>canAdmin</code> eri&#351;im korumas&inodot;n&inodot; payla&#351;&inodot;r. Giri&#351; sayfas&inodot;, t&uuml;m uygulamadaki tek herkese a&ccedil;&inodot;k sayfad&inodot;r.</p>

        <h3>5.2 Yetki Katman&inodot; (Kesmesel)</h3>

        <p>Admin&rsquo;in &ouml;ny&uuml;ze en etkili katk&inodot;s&inodot; kendi sayfalar&inodot; de&gbreve;ildir &mdash; di&gbreve;er her sayfan&inodot;n kulland&inodot;&gbreve;&inodot; yetki altyap&inodot;s&inodot;d&inodot;r. Bu &uuml;&ccedil; dosyada ya&#351;ar:</p>

        <div class="arch-grid">
            <div class="arch-box">
                <h4>access.ts</h4>
                <p>Dinamik eri&#351;im fonksiyonlar&inodot;n&inodot; tan&inodot;mlar: <code>canAdmin</code>, <code>canLab</code>, <code>canProduction</code>, vb. Route yap&inodot;land&inodot;rmas&inodot;nda eri&#351;im korumalar&inodot; olarak referans verilir. Ayr&inodot;ca kullan&inodot;c&inodot;n&inodot;n ayr&inodot;&#351;t&inodot;r&inodot;lm&inodot;&#351; yetki JSON&rsquo;&inodot;ndan okuyan <code>canAccessPage(pageId)</code> ve mod&uuml;l d&uuml;zeyinde kontroller sa&gbreve;lar.</p>
            </div>
            <div class="arch-box">
                <h4>permissionManifest.ts</h4>
                <p>Sistemdeki her sayfan&inodot;n ve her butonun statik kayd&inodot;. Sayfa kimliklerini (&ouml;rn. <code>admin.kullanici_yonetimi</code>), buton kimliklerini (&ouml;rn. <code>create_user</code>, <code>delete_user</code>), etiketleri, a&ccedil;&inodot;klamalar&inodot; ve <code>critical</code> bayraklar&inodot;n&inodot; tan&inodot;mlar. Kullan&inodot;c&inodot; Y&ouml;netimi taraf&inodot;ndan yetki edit&ouml;r&uuml;n&uuml; &ccedil;izmek i&ccedil;in kullan&inodot;l&inodot;r.</p>
            </div>
            <div class="arch-box">
                <h4>buttonRegistry.ts</h4>
                <p>Statik manifestin dinamik kar&#351;&inodot;l&inodot;&gbreve;&inodot;. Bile&#351;enler, mount s&inodot;ras&inodot;nda butonlar&inodot;n&inodot; global bir kay&inodot;t defterine kaydeder. Bu, Kullan&inodot;c&inodot; Y&ouml;netimi yetki edit&ouml;r&uuml;n&uuml;n, manifest g&uuml;ncellenmemi&#351; olsa bile &ccedil;al&inodot;&#351;an uygulamada var olan butonlar&inodot; ke&#351;fetmesine olanak tan&inodot;r.</p>
            </div>
        </div>

        <div class="finding">
            <p style="margin-bottom: 0;"><strong>Hibrit Ke&#351;if Deseni:</strong> Yetki sistemi <em>hem</em> statik bir manifest (t&uuml;m sayfalar&inodot;n ve butonlar&inodot;n sabit kodlanm&inodot;&#351; listesi) <em>hem de</em> dinamik bir kay&inodot;t defteri (bile&#351;enler &ccedil;al&inodot;&#351;ma zaman&inodot;nda kendilerini kaydeder) kullan&inodot;r. Kullan&inodot;c&inodot; Y&ouml;netimi yetki edit&ouml;r&uuml;, yap&inodot;land&inodot;r&inodot;lm&inodot;&#351; a&gbreve;a&ccedil; g&ouml;r&uuml;n&uuml;m&uuml; i&ccedil;in manifestten okur ancak dinamik olarak kaydedilmi&#351; butonlar&inodot; da ke&#351;fedebilir. Bu, sistemdeki herhangi bir sayfaya eklenen yeni butonlar&inodot;n, merkezi bir yap&inodot;land&inodot;rma dosyas&inodot;n&inodot; manuel olarak g&uuml;ncellemeden yetki atamas&inodot; i&ccedil;in kullan&inodot;labilir hale gelmesi anlam&inodot;na gelir.</p>
        </div>

        <h3>5.3 Giri&#351; Sayfas&inodot;</h3>

        <p>Giri&#351; sayfas&inodot; &uuml;&ccedil; senaryoyu y&ouml;netir:</p>
        <ol>
            <li><strong>Standart giri&#351;:</strong> &ldquo;Beni hat&inodot;rla&rdquo; onay kutusuyla kullan&inodot;c&inodot; ad&inodot;/&#351;ifre formu. JWT token&rsquo;lar&inodot;n&inodot; ve kullan&inodot;c&inodot; verilerini <code>localStorage</code>&rsquo;da saklar (<code>solen_auth_token</code>, <code>solen_refresh_token</code>, <code>solen_current_user</code>).</li>
            <li><strong>Kiosk otomatik giri&#351;:</strong> Fully Kiosk Browser&rsquo;&inodot; user agent string&rsquo;i &uuml;zerinden alg&inodot;lar. Alg&inodot;land&inodot;&gbreve;&inodot;nda, otomatik olarak operat&ouml;r hesab&inodot;yla giri&#351; yapar ve <code>/production</code>&rsquo;a y&ouml;nlendirir. &Idot;nsan etkile&#351;imi gerekmez.</li>
            <li><strong>Gizli URL token&rsquo;&inodot;:</strong> Herhangi bir taray&inodot;c&inodot;dan otomatik giri&#351;i tetiklemek i&ccedil;in URL parametresi olarak <code>?kiosk=SOLEN_FACTORY_2024_KIOSK_SECRET</code> kabul eder. Bu, yeni kiosk cihazlar&inodot;n&inodot;n montaj&inodot; i&ccedil;in fabrika zemine &ouml;zel bir kolayl&inodot;kt&inodot;r.</li>
        </ol>

        <h3>5.4 Kullan&inodot;c&inodot; Y&ouml;netimi Sayfas&inodot;</h3>

        <p>Admin mod&uuml;l&uuml;ndeki en karma&#351;&inodot;k sayfa. &Uuml;&ccedil; sekmeli modal ile kullan&inodot;c&inodot; hesaplar&inodot; i&ccedil;in tam bir CRUD aray&uuml;z&uuml; sa&gbreve;lar:</p>

        <ul>
            <li><strong>Sekme 1 &mdash; Temel Bilgiler:</strong> Kullan&inodot;c&inodot; ad&inodot;, e-posta, tam ad, kullan&inodot;c&inodot; tipi (super_admin, lab_user, operator, teknik_user, bakim_user ve &ouml;zel tiplerle dropdown), durum, &#351;ifre (yeni kullan&inodot;c&inodot;lar i&ccedil;in), &#351;ifre de&gbreve;i&#351;tirmeyi zorla toggle&rsquo;&inodot;.</li>
            <li><strong>Sekme 2 &mdash; Yetkiler:</strong> Gran&uuml;ler yetki edit&ouml;r&uuml;. Tam yetki manifestini bir a&gbreve;a&ccedil; olarak &ccedil;izer: her sayfa bir switch (eri&#351;im a&ccedil;&inodot;k/kapal&inodot;) ve her sayfa alt&inodot;nda bireysel butonlar onay kutular&inodot;d&inodot;r. D&ouml;rt h&inodot;zl&inodot; doldurma &#351;ablonu i&ccedil;erir: Tam, Bo&#351;, Operat&ouml;r Varsay&inodot;lan, Lab Kullan&inodot;c&inodot; Varsay&inodot;lan.</li>
            <li><strong>Sekme 3 &mdash; &Ouml;nizleme:</strong> Kaydettikten sonra kullan&inodot;c&inodot;n&inodot;n neye eri&#351;ebilece&gbreve;inin salt okunur &ouml;zetini g&ouml;sterir &mdash; hangi mod&uuml;ller, hangi sayfalar, hangi butonlar.</li>
        </ul>

        <p>Modal&inodot;n &ouml;tesinde sayfa &#351;unlar&inodot; sa&gbreve;lar: kullan&inodot;c&inodot; ad&inodot;/e-posta/tam ad &uuml;zerinden arama, user_type ve duruma g&ouml;re filtreleme, &#351;ifre s&inodot;f&inodot;rlama (yeni &#351;ifreyi &uuml;retir ve g&ouml;r&uuml;nt&uuml;ler), ask&inodot;ya al/etkinle&#351;tir toggle&rsquo;&inodot;, onaylamal&inodot; silme ve Turkey/Istanbul saat dilimi d&ouml;n&uuml;&#351;t&uuml;rmesiyle son giri&#351; g&ouml;r&uuml;nt&uuml;leme.</p>

        <h3>5.5 Yaz&inodot;c&inodot; Y&ouml;netimi Sayfas&inodot;</h3>

        <p>Fabrika etiket yaz&inodot;c&inodot;lar&inodot; i&ccedil;in CRUD aray&uuml;z&uuml;. Her yaz&inodot;c&inodot;n&inodot;n: ad, a&ccedil;&inodot;klama, IP adresi, port, konum, durum ve atanm&inodot;&#351; malzemeleri (malzeme tiplerinden &ccedil;oklu se&ccedil;im: raw_copper, raw_tin, raw_plastic, vb.) vard&inodot;r. Yaz&inodot;c&inodot;n&inodot;n a&gbreve;da eri&#351;ilebilir oldu&gbreve;unu do&gbreve;rulamak i&ccedil;in backend&rsquo;in <code>/printers/{id}/test</code> endpoint&rsquo;ine ula&#351;an bir &ldquo;Ba&gbreve;lant&inodot; Testi&rdquo; butonu i&ccedil;erir.</p>

        <h3>5.6 Yazd&inodot;rma &Idot;zleme Sayfas&inodot;</h3>

        <p>Ger&ccedil;ek zamanl&inodot; izleme panosu. &Uuml;st b&ouml;l&uuml;m d&ouml;rt istatistik kart&inodot; g&ouml;sterir: Bekleyen (mavi), Yazd&inodot;r&inodot;lan (turuncu), Tamamlanan (ye&#351;il), Ba&#351;ar&inodot;s&inodot;z (k&inodot;rm&inodot;z&inodot;). Alt&inodot;nda s&uuml;tunlarla t&uuml;m yazd&inodot;rma i&#351;lerini g&ouml;steren bir ProTable vard&inodot;r: QR kod, malzeme tipi, lot numaras&inodot;, tedarik&ccedil;i, yaz&inodot;c&inodot;, durum, talep eden, talep tarihi, tamamlanma tarihi, hata mesaj&inodot;. Yeniden deneme (ba&#351;ar&inodot;s&inodot;z i&#351;leri yeniden kuyru&gbreve;a ekler) ve iptal (kuyruktaki i&#351;leri kald&inodot;r&inodot;r) destekler. T&uuml;m zaman damgalar&inodot; Turkey/Istanbul saat dilimindedir.</p>

        <h3>5.7 AI Ayarlar&inodot; Sayfas&inodot;</h3>

        <p>D&ouml;rt sekmeli yap&inodot;land&inodot;rma aray&uuml;z&uuml;:</p>
        <ul>
            <li><strong>Genel Bak&inodot;&#351;:</strong> AI durumu (aktif/inaktif), bug&uuml;nk&uuml; sorgu say&inodot;s&inodot;, toplam sorgular, ortalama yan&inodot;t s&uuml;resi, ba&#351;ar&inodot; oran&inodot; g&ouml;rselle&#351;tirmesi ve ba&gbreve;lant&inodot; testi butonu.</li>
            <li><strong>API Anahtarlar&inodot;:</strong> &Uuml;&ccedil; sa&gbreve;lay&inodot;c&inodot; i&ccedil;in (Gemini, OpenAI, Anthropic) API anahtarlar&inodot;n&inodot; kaydet, test et ve sil. Anahtarlar aray&uuml;zde maskelenir ve sunucunun .env dosyas&inodot;nda saklan&inodot;r.</li>
            <li><strong>Model Ayarlar&inodot;:</strong> AI&rsquo;y&inodot; etkinle&#351;tir/devre d&inodot;&#351;&inodot; b&inodot;rak, model se&ccedil; (sa&gbreve;lay&inodot;c&inodot;ya g&ouml;re grupland&inodot;r&inodot;lm&inodot;&#351; cascader: Gemini 3 Flash/Pro, GPT-5.2/Mini, Claude Sonnet/Opus/Haiku), maks token (1024&ndash;8192) ve s&inodot;cakl&inodot;k (0.1&ndash;0.9) yap&inodot;land&inodot;r.</li>
            <li><strong>Denetim G&uuml;nl&uuml;&gbreve;&uuml;:</strong> AI etkile&#351;imlerinin tam ge&ccedil;mi&#351;i. Orijinal sorguyu ve AI yan&inodot;t&inodot;n&inodot; g&ouml;steren geni&#351;letilebilir sat&inodot;rl&inodot; ProTable. Kullan&inodot;c&inodot;, ara&ccedil;, durum, IP adresine g&ouml;re filtrelenebilir. Yan&inodot;t s&uuml;resi metrikleri i&ccedil;erir.</li>
        </ul>

        <h3>5.8 Ortak &Ouml;ny&uuml;z Desenleri</h3>

        <table>
            <tr><th>Desen</th><th>Kullan&inodot;m</th></tr>
            <tr><td>ProTable (Ant Design Pro)</td><td>Her liste sayfas&inodot;, yerle&#351;ik arama, filtreleme, sayfalama ve ara&ccedil; &ccedil;ubu&gbreve;u &ouml;zelle&#351;tirmesiyle ProTable kullan&inodot;r.</td></tr>
            <tr><td>ProConfigProvider trTR locale ile</td><td>T&uuml;m tablolar ve formlar s&uuml;tun ba&#351;l&inodot;klar&inodot;, ara&ccedil; &ccedil;ubu&gbreve;u butonlar&inodot; ve bo&#351; durumlar i&ccedil;in T&uuml;rk&ccedil;e metin g&ouml;sterir.</td></tr>
            <tr><td>PageContainer</td><td>Breadcrumb ve ba&#351;l&inodot;kl&inodot; tutarl&inodot; sayfa &uuml;st bilgileri.</td></tr>
            <tr><td>Modal formlar</td><td>Olu&#351;turma/D&uuml;zenleme operasyonlar&inodot; form do&gbreve;rulamas&inodot;yla ortalanm&inodot;&#351; modal kullan&inodot;r.</td></tr>
            <tr><td>Durum Etiketleri</td><td>Durum g&ouml;r&uuml;nt&uuml;leme i&ccedil;in renk kodlu Ant Design Tag&rsquo;lar&inodot; (ye&#351;il=aktif, k&inodot;rm&inodot;z&inodot;=ask&inodot;da, mavi=bekleyen, vb.).</td></tr>
            <tr><td>Turkey/Istanbul saat dilimi</td><td>T&uuml;m zaman damgas&inodot; g&ouml;r&uuml;nt&uuml;lemeleri <code>toLocaleString()</code> kullanarak <code>Europe/Istanbul</code>&rsquo;a d&ouml;n&uuml;&#351;t&uuml;r&uuml;l&uuml;r.</td></tr>
            <tr><td>message.success / message.error</td><td>Operasyon geri bildirimi i&ccedil;in Ant Design bildirimleri, tamam&inodot; T&uuml;rk&ccedil;e.</td></tr>
        </table>

        <h3>5.9 API Katman&inodot;</h3>

        <p>&Ouml;ny&uuml;z, da&gbreve;&inodot;t&inodot;m ba&gbreve;lam&inodot;na g&ouml;re backend URL&rsquo;sini dinamik olarak &ccedil;&ouml;zen merkezi bir API yard&inodot;mc&inodot;s&inodot; (<code>src/utils/api.ts</code>) arac&inodot;l&inodot;&gbreve;&inodot;yla backend ile ileti&#351;im kurar:</p>

        <ul>
            <li><strong>HTTPS modu:</strong> <code>/api</code> proxy kullan&inodot;r (reverse proxy y&ouml;nlendirmeyi y&ouml;netir).</li>
            <li><strong>HTTP localhost:</strong> <code>http://localhost:8000/api</code> (geli&#351;tirme).</li>
            <li><strong>HTTP yerel a&gbreve;:</strong> <code>http://{hostname}:8000/api</code> (fabrika LAN eri&#351;imi).</li>
            <li><strong>&Ouml;zel ge&ccedil;ersizleme:</strong> &Ouml;zel da&gbreve;&inodot;t&inodot;mlar i&ccedil;in <code>window.BACKEND_URL</code>.</li>
        </ul>

        <p>Her API &ccedil;a&gbreve;r&inodot;s&inodot;, <code>localStorage</code>&rsquo;dan al&inodot;nan <code>Authorization: Bearer {token}</code> ba&#351;l&inodot;&gbreve;&inodot;n&inodot; i&ccedil;erir. Kimlik do&gbreve;rulama servisi (<code>src/services/realAuth.ts</code>), t&uuml;m sayfalar&inodot;n i&ccedil;e aktard&inodot;&gbreve;&inodot; <code>login()</code>, <code>logout()</code>, <code>getCurrentUser()</code> ve <code>getToken()</code> fonksiyonlar&inodot;n&inodot; sa&gbreve;lar.</p>

        <!-- ============================================ -->
        <h2 id="sec-6">6. ALT MOD&Uuml;LLER</h2>
        <!-- ============================================ -->

        <p>Admin mod&uuml;l&uuml; d&ouml;rt alt mod&uuml;l olarak organize edilmi&#351;tir, operasyonel ak&inodot;&#351;a g&ouml;re: yazd&inodot;rma i&#351;leri izlenebilmeden &ouml;nce yaz&inodot;c&inodot;lar yap&inodot;land&inodot;r&inodot;lmal&inodot;, AI ayarlar&inodot; ba&gbreve;&inodot;ms&inodot;z durur ve kullan&inodot;c&inodot; y&ouml;netimi her &#351;eye eri&#351;imi y&ouml;netir.</p>

        <div class="submod-card">
            <div class="submod-num">6.1</div>
            <div class="submod-body">
                <h4>Yaz&inodot;c&inodot; Y&ouml;netimi (Printer Management)</h4>
                <p>Fabrika zeminindeki a&gbreve; etiket yaz&inodot;c&inodot;lar&inodot;n&inodot;n kayd&inodot; ve yap&inodot;land&inodot;rmas&inodot;. IP/port yap&inodot;land&inodot;rmas&inodot;, malzeme tipi atamalar&inodot;, ba&gbreve;lant&inodot; testi ve durum izleme.</p>
                <div class="submod-tags">
                    <span class="submod-tag">5 endpoints</span>
                    <span class="submod-tag">printers table</span>
                    <span class="submod-tag">TCP port 9100</span>
                    <span class="submod-tag">material assignments</span>
                </div>
            </div>
        </div>

        <div class="submod-card">
            <div class="submod-num">6.2</div>
            <div class="submod-body">
                <h4>Yazd&inodot;rma &Idot;zleme (Print Job Monitor)</h4>
                <p>D&ouml;rt yaz&inodot;c&inodot; genelinde t&uuml;m etiket yazd&inodot;rma i&#351;lerini izleyen ger&ccedil;ek zamanl&inodot; pano. Kuyruk istatistikleri, i&#351; ge&ccedil;mi&#351;i, ba&#351;ar&inodot;s&inodot;zl&inodot;klar i&ccedil;in yeniden deneme ve kuyruktaki i&#351;ler i&ccedil;in iptal.</p>
                <div class="submod-tags">
                    <span class="submod-tag">5 endpoints</span>
                    <span class="submod-tag">print_jobs table</span>
                    <span class="submod-tag">real-time stats</span>
                    <span class="submod-tag">retry mechanism</span>
                </div>
            </div>
        </div>

        <div class="submod-card">
            <div class="submod-num">6.3</div>
            <div class="submod-body">
                <h4>AI Ayarlar&inodot; (AI Settings)</h4>
                <p>ERP&rsquo;nin AI asistan&inodot; i&ccedil;in yap&inodot;land&inodot;rma aray&uuml;z&uuml;. &Ccedil;oklu sa&gbreve;lay&inodot;c&inodot; API anahtar y&ouml;netimi, model se&ccedil;imi, parametre ayarlama, kullan&inodot;m istatistikleri ve her AI etkile&#351;iminin kapsaml&inodot; denetim g&uuml;nl&uuml;&gbreve;&uuml;.</p>
                <div class="submod-tags">
                    <span class="submod-tag">12 endpoints</span>
                    <span class="submod-tag">ai_audit_logs (47 columns)</span>
                    <span class="submod-tag">3 AI providers</span>
                    <span class="submod-tag">.env key storage</span>
                </div>
            </div>
        </div>

        <div class="submod-card">
            <div class="submod-num">6.4</div>
            <div class="submod-body">
                <h4>Kullan&inodot;c&inodot; Y&ouml;netimi (User Management)</h4>
                <p>Kullan&inodot;c&inodot; hesaplar&inodot;n&inodot;n tam ya&#351;am d&ouml;ng&uuml;s&uuml; y&ouml;netimi: olu&#351;turma, d&uuml;zenleme, ask&inodot;ya alma, silme, &#351;ifre s&inodot;f&inodot;rlama ve gran&uuml;ler yetki edit&ouml;r&uuml;. Sistemde kimin var oldu&gbreve;unu ve ne yapabilece&gbreve;ini tan&inodot;mlar.</p>
                <div class="submod-tags">
                    <span class="submod-tag">9 endpoints</span>
                    <span class="submod-tag">users + 3 extension tables</span>
                    <span class="submod-tag">user_roles templates</span>
                    <span class="submod-tag">activity_logs</span>
                    <span class="submod-tag">hybrid permission model</span>
                </div>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- 6.1  YAZICI YÖNETİMİ                         -->
        <!-- ============================================ -->

        <h2 id="sec-6-1" style="margin-top: 48px;">6.1 Yaz&inodot;c&inodot; Y&ouml;netimi (Printer Management)</h2>

        <h3>6.1.1 Ama&ccedil; ve &Idot;&#351; Ba&gbreve;lam&inodot;</h3>

        <p>Fabrikaya giren her hammadde, QR kodu, a&gbreve;&inodot;rl&inodot;k, tedarik&ccedil;i, lot numaras&inodot; ve giri&#351; tarihi i&ccedil;eren bas&inodot;l&inodot; bir A6 etiket al&inodot;r. Bu etiketler malzemenin fiziksel kimli&gbreve;idir &mdash; a&#351;a&gbreve;&inodot; ak&inodot;&#351;taki her istasyonda (lab testi, &uuml;retim, stok) taran&inodot;r. Etiket yaz&inodot;c&inodot;lar&inodot;, belirli konumlara yerle&#351;tirilmi&#351; end&uuml;striyel a&gbreve; cihazlar&inodot;d&inodot;r (TCP port 9100 / IPP port 631): laboratuvar ve &uuml;&ccedil; &uuml;retim hatt&inodot;. <strong>Yaz&inodot;c&inodot; Y&ouml;netimi</strong>, bu fiziksel cihazlar&inodot;n yap&inodot;land&inodot;r&inodot;ld&inodot;&gbreve;&inodot;, test edildi&gbreve;i ve malzeme t&uuml;rlerine atand&inodot;&gbreve;&inodot; kay&inodot;t defteridir.</p>

        <p>Bu alt mod&uuml;l olmadan sistem yazd&inodot;rma i&#351;lerini <em>nereye</em> g&ouml;nderece&gbreve;ini bilemez. D&ouml;rt soruyu yan&inodot;tlar: Hangi yaz&inodot;c&inodot;lar var? Neredeler? &Ccedil;evrimi&ccedil;iler mi? Her yaz&inodot;c&inodot; hangi malzeme t&uuml;rlerini idare edebilir?</p>

        <h3>6.1.2 Veritaban&inodot; &#350;emas&inodot;</h3>

        <p>Tek tablo: <code>printers</code> (model dosyas&inodot;: 66 sat&inodot;r)</p>

        <table>
            <tr><th>S&uuml;tun</th><th>Tip</th><th>K&inodot;s&inodot;tlamalar</th><th>Ama&ccedil;</th></tr>
            <tr><td><code>id</code></td><td>Integer PK</td><td>Otomatik art&inodot;&#351;, indeksli</td><td>Benzersiz yaz&inodot;c&inodot; tan&inodot;mlay&inodot;c&inodot;</td></tr>
            <tr><td><code>name</code></td><td>String(100)</td><td>NOT NULL</td><td>Okunabilir ad (&ouml;rn. &ldquo;Lab Yaz&inodot;c&inodot;s&inodot;&rdquo;)</td></tr>
            <tr><td><code>description</code></td><td>Text</td><td>NULLABLE</td><td>&Idot;ste&gbreve;e ba&gbreve;l&inodot; a&ccedil;&inodot;klama</td></tr>
            <tr><td><code>ip_address</code></td><td>String(50)</td><td>NOT NULL</td><td>A&gbreve; IP adresi (&ouml;rn. 192.168.0.182)</td></tr>
            <tr><td><code>port</code></td><td>Integer</td><td>NOT NULL, varsay&inodot;lan 9100</td><td>A&gbreve; portu (RAW i&ccedil;in 9100, IPP i&ccedil;in 631)</td></tr>
            <tr><td><code>status</code></td><td>String(20)</td><td>NOT NULL, varsay&inodot;lan &ldquo;online&rdquo;</td><td>Mevcut durum: online / offline / error / maintenance</td></tr>
            <tr><td><code>is_active</code></td><td>Boolean</td><td>NOT NULL, varsay&inodot;lan True</td><td>Ge&ccedil;ici etkinle&#351;tirme/devre d&inodot;&#351;&inodot; b&inodot;rakma</td></tr>
            <tr><td><code>assigned_materials</code></td><td>Text</td><td>NULLABLE</td><td>Bu yaz&inodot;c&inodot;n&inodot;n idare etti&gbreve;i malzeme t&uuml;r kodlar&inodot;n&inodot;n JSON dizisi (&ouml;rn. <code>["raw_copper","raw_tin"]</code>)</td></tr>
            <tr><td><code>location</code></td><td>String(100)</td><td>NULLABLE</td><td>Fiziksel konum (&ouml;rn. &ldquo;Laboratuvar&rdquo;, &ldquo;&Uuml;retim - Hat 1&rdquo;)</td></tr>
            <tr><td><code>created_at</code></td><td>DateTime</td><td>NOT NULL, otomatik</td><td>Olu&#351;turma zaman damgas&inodot;</td></tr>
            <tr><td><code>updated_at</code></td><td>DateTime</td><td>NOT NULL, otomatik + onupdate</td><td>Son de&gbreve;i&#351;iklik zaman damgas&inodot;</td></tr>
            <tr><td><code>last_checked</code></td><td>DateTime</td><td>NULLABLE</td><td>Son ba&gbreve;lant&inodot; testi zaman damgas&inodot;</td></tr>
        </table>

        <h4>PrinterStatus Enum</h4>
        <pre><span class="keyword">class</span> <span class="string">PrinterStatus</span>(str, Enum):
    ONLINE      = <span class="string">"online"</span>
    OFFLINE     = <span class="string">"offline"</span>
    ERROR       = <span class="string">"error"</span>
    MAINTENANCE = <span class="string">"maintenance"</span></pre>

        <h4>Varsay&inodot;lan Yaz&inodot;c&inodot;lar (Migration Tohum Verisi)</h4>
        <table>
            <tr><th>ID</th><th>Ad</th><th>IP</th><th>Port</th><th>Konum</th><th>Atanm&inodot;&#351; Malzemeler</th></tr>
            <tr><td>1</td><td>Lab Yaz&inodot;c&inodot;s&inodot;</td><td>192.168.0.182</td><td>9100</td><td>Laboratuvar</td><td>A, B, C, D, E, F (t&uuml;m t&uuml;rler)</td></tr>
            <tr><td>2</td><td>&Uuml;retim Yaz&inodot;c&inodot;s&inodot; 1</td><td>192.168.0.183</td><td>9100</td><td>&Uuml;retim - Hat 1</td><td>[] (yok)</td></tr>
            <tr><td>3</td><td>&Uuml;retim Yaz&inodot;c&inodot;s&inodot; 2</td><td>192.168.0.184</td><td>9100</td><td>&Uuml;retim - Hat 2</td><td>[] (yok)</td></tr>
            <tr><td>4</td><td>&Uuml;retim Yaz&inodot;c&inodot;s&inodot; 3</td><td>192.168.0.185</td><td>9100</td><td>&Uuml;retim - Hat 3</td><td>[] (yok)</td></tr>
        </table>

        <h3>6.1.3 API S&ouml;zle&#351;mesi &mdash; 5 Endpoint</h3>

        <table>
            <tr><th>Metot</th><th>Yol</th><th>Yetki</th><th>Ne Yapar</th></tr>
            <tr><td><code>GET</code></td><td><code>/api/printers/list</code></td><td>Kimlik do&gbreve;rulanm&inodot;&#351; herkes</td><td>T&uuml;m yaz&inodot;c&inodot;lar&inodot; listeler. &Idot;ste&gbreve;e ba&gbreve;l&inodot; <code>?active_only=true</code> filtresi. <code>assigned_materials</code>&rsquo;&inodot; JSON&rsquo;dan ayr&inodot;&#351;t&inodot;r&inodot;r.</td></tr>
            <tr><td><code>POST</code></td><td><code>/api/printers/create</code></td><td>Yaln&inodot;zca super_admin</td><td>Yeni yaz&inodot;c&inodot; olu&#351;turur. Zorunlu: name, ip_address. Varsay&inodot;lan port=9100, status=online, is_active=true. assigned_materials dizisini JSON string&rsquo;e d&ouml;n&uuml;&#351;t&uuml;r&uuml;r.</td></tr>
            <tr><td><code>PUT</code></td><td><code>/api/printers/update/{id}</code></td><td>Yaln&inodot;zca super_admin</td><td>Yaz&inodot;c&inodot;y&inodot; g&uuml;nceller. K&inodot;smi g&uuml;ncelleme &mdash; yaln&inodot;zca g&ouml;nderilen alanlar de&gbreve;i&#351;ir. <code>updated_at</code> damgalanr.</td></tr>
            <tr><td><code>POST</code></td><td><code>/api/printers/{id}/test</code></td><td>super_admin veya lab_user</td><td>CUPS <code>lpstat -p</code> ile ba&gbreve;lant&inodot; testi. <code>status</code>&rsquo;&uuml; online/offline olarak g&uuml;nceller ve <code>last_checked</code> damgalar.</td></tr>
            <tr><td><code>DELETE</code></td><td><code>/api/printers/{id}</code></td><td>Yaln&inodot;zca super_admin</td><td>Yaz&inodot;c&inodot;y&inodot; siler. Bekleyen i&#351;ler (QUEUED veya PRINTING) varsa <strong>engellenir</strong>. Hata: &ldquo;Bu yaz&inodot;c&inodot;n&inodot;n {n} bekleyen i&#351;i var.&rdquo;</td></tr>
        </table>

        <h3>6.1.4 CRUD Ak&inodot;&#351;&inodot;</h3>

        <p><strong>Olu&#351;tur:</strong></p>
        <ol>
            <li>Ara&ccedil; &ccedil;ubu&gbreve;unda &ldquo;Yeni Yaz&inodot;c&inodot; Ekle&rdquo; butonuna t&inodot;kla</li>
            <li>Modal (600px) 7 alanla a&ccedil;&inodot;l&inodot;r: ad (zorunlu), a&ccedil;&inodot;klama, konum, IP adresi (zorunlu), port (varsay&inodot;lan 9100), atanm&inodot;&#351; malzemeler (&ccedil;oklu se&ccedil;im: A=Bak&inodot;r, B=Kalay, C=Plastik, D=Kataliz&ouml;r, E=Boya, F=Antirodent), durum</li>
            <li>G&ouml;nderimde: <code>POST /api/printers/create</code></li>
            <li>Backend <code>is_active=true</code>, <code>status=online</code> ile kay&inodot;t olu&#351;turur, assigned_materials dizisini JSON string&rsquo;e d&ouml;n&uuml;&#351;t&uuml;r&uuml;r</li>
            <li>Ba&#351;ar&inodot;da: toast &ldquo;Yaz&inodot;c&inodot; &lsquo;{ad}&rsquo; eklendi&rdquo; &rarr; modal kapan&inodot;r &rarr; tablo yenilenir</li>
            <li><strong>Not:</strong> Yeni yaz&inodot;c&inodot;n&inodot;n arka plan yazd&inodot;rma i&#351;&ccedil;isinin ba&#351;lamas&inodot; i&ccedil;in uygulama yeniden ba&#351;lat&inodot;lmal&inodot;d&inodot;r</li>
        </ol>

        <p><strong>Oku:</strong></p>
        <ol>
            <li>Sayfa y&uuml;klenir &rarr; <code>GET /api/printers/list</code></li>
            <li>ProTable (11 s&uuml;tun) render eder: ID, ad, a&ccedil;&inodot;klama, IP (mavi etiket), port, konum, durum (renk kodlu etiket), atanm&inodot;&#351; malzemeler (harf etiketleri), aktif (onay/&ccedil;arp&inodot; ikon), i&#351;lemler</li>
            <li>&Idot;stemci taraf&inodot; arama, ad, a&ccedil;&inodot;klama, IP, konum, durum, port ve ID &uuml;zerinde ayn&inodot; anda filtreler</li>
        </ol>

        <p><strong>G&uuml;ncelle:</strong></p>
        <ol>
            <li>&Idot;&#351;lemler s&uuml;tunundaki d&uuml;zenle ikonuna t&inodot;kla</li>
            <li>Ayn&inodot; modal mevcut de&gbreve;erlerle dolu olarak a&ccedil;&inodot;l&inodot;r</li>
            <li>Alanlar&inodot; de&gbreve;i&#351;tir &rarr; &ldquo;G&uuml;ncelle&rdquo;ye t&inodot;kla</li>
            <li><code>PUT /api/printers/update/{id}</code> &rarr; backend yaln&inodot;zca g&ouml;nderilen alanlar&inodot; g&uuml;nceller, <code>updated_at</code> damgalar</li>
            <li>Ba&#351;ar&inodot;da: toast &ldquo;Yaz&inodot;c&inodot; &lsquo;{ad}&rsquo; g&uuml;ncellendi&rdquo; &rarr; modal kapan&inodot;r &rarr; tablo yenilenir</li>
        </ol>

        <p><strong>Sil:</strong></p>
        <ol>
            <li>&Idot;&#351;lemler s&uuml;tunundaki sil ikonuna (tehlike butonu) t&inodot;kla</li>
            <li>Onay modal&inodot;: &ldquo;{ad} yaz&inodot;c&inodot;s&inodot;n&inodot; silmek istedi&gbreve;inize emin misiniz?&rdquo;</li>
            <li>Onayda: <code>DELETE /api/printers/{id}</code></li>
            <li>Backend bekleyen yazd&inodot;rma i&#351;lerini (QUEUED veya PRINTING durumu) kontrol eder</li>
            <li>Bekleyen i&#351;ler varsa: silme <strong>engellenir</strong>, hata &ldquo;Bu yaz&inodot;c&inodot;n&inodot;n {n} bekleyen i&#351;i var. &Ouml;nce i&#351;leri tamamlay&inodot;n veya iptal edin.&rdquo;</li>
            <li>Bekleyen i&#351; yoksa: yaz&inodot;c&inodot; silinir &rarr; toast &rarr; tablo yenilenir</li>
        </ol>

        <p><strong>Ba&gbreve;lant&inodot; Testi:</strong></p>
        <ol>
            <li>&Idot;&#351;lemler s&uuml;tunundaki test ikonuna (ApiOutlined) t&inodot;kla</li>
            <li><code>POST /api/printers/{id}/test</code></li>
            <li>Backend <code>PrintService.test_printer_connection()</code> &ccedil;a&gbreve;&inodot;r&inodot;r, alt s&uuml;re&ccedil; &uuml;zerinden <code>lpstat -p {yaz&inodot;c&inodot;_ad&inodot;}</code> &ccedil;al&inodot;&#351;t&inodot;r&inodot;r</li>
            <li>Olas&inodot; sonu&ccedil;lar: &ldquo;connected&rdquo; (bo&#351;ta), &ldquo;busy&rdquo;, &ldquo;not_found&rdquo;, &ldquo;timeout&rdquo;, &ldquo;error&rdquo;</li>
            <li>Backend <code>printer.status</code>&rsquo;&uuml; (ONLINE veya OFFLINE) ve <code>last_checked</code>&rsquo;&inodot; g&uuml;nceller</li>
            <li>Ba&#351;ar&inodot;da: yaz&inodot;c&inodot; ad&inodot;yla toast &rarr; tablo yenilenir (durum s&uuml;tunu yeni durumu yans&inodot;t&inodot;r)</li>
            <li>Ba&#351;ar&inodot;s&inodot;zl&inodot;kta: uyar&inodot; mesaj&inodot; &rarr; tablo yenilenir (durum &ldquo;&Ccedil;evrimd&inodot;&#351;&inodot;&rdquo; k&inodot;rm&inodot;z&inodot; g&ouml;r&uuml;n&uuml;r)</li>
        </ol>

        <h3>6.1.5 Yazd&inodot;rma Servisi &mdash; Etiket &Uuml;retim Motoru</h3>

        <p>Dosya: <code>app/services/print_service.py</code> (576 sat&inodot;r). A6 etiketleri &uuml;reten ve yazd&inodot;ran &ccedil;ekirdek servis.</p>

        <h4>Etiket &Ouml;zellikleri</h4>
        <table>
            <tr><th>&Ouml;zellik</th><th>De&gbreve;er</th></tr>
            <tr><td>Boyut</td><td>A6 (827 &times; 1165 piksel)</td></tr>
            <tr><td>DPI</td><td>200</td></tr>
            <tr><td>QR Kod Boyutu</td><td>300px, ortalanm&inodot;&#351;, hata d&uuml;zeltme seviyesi H</td></tr>
            <tr><td>Saat Dilimi</td><td>Europe/Istanbul (T&uuml;rkiye)</td></tr>
            <tr><td>Yazd&inodot;rma Protokol&uuml;</td><td>CUPS/IPP, <code>lp</code> komutu ile A6 medya + sayfaya s&inodot;&gbreve;d&inodot;r</td></tr>
            <tr><td>Zaman A&#351;&inodot;m&inodot;</td><td>Yazd&inodot;rma komutu ba&#351;&inodot;na 10 saniye</td></tr>
        </table>

        <h4>Etiket &Idot;&ccedil;erik D&uuml;zeni</h4>
        <ol>
            <li>Ortalanm&inodot;&#351; QR kod (300px) ve alt&inodot;nda QR metni</li>
            <li>Lot numaras&inodot; (varsa)</li>
            <li>A&gbreve;&inodot;rl&inodot;k (kg)</li>
            <li>Malzeme t&uuml;r&uuml; / &uuml;r&uuml;n ad&inodot;</li>
            <li>Tarih ve saat (T&uuml;rkiye saat dilimi)</li>
            <li>&ldquo;Olu&#351;turan&rdquo; kullan&inodot;c&inodot; ad&inodot;</li>
            <li>Notlar (varsa)</li>
        </ol>

        <h4>Temel Servis Metotlar&inodot;</h4>
        <table>
            <tr><th>Metot</th><th>Ne Yapar</th></tr>
            <tr><td><code>generate_qr_code(data, size)</code></td><td>Hata d&uuml;zeltme H ile QR kod g&ouml;r&uuml;nt&uuml;s&uuml; olu&#351;turur</td></tr>
            <tr><td><code>create_label_image(material_data)</code></td><td>PIL kullanarak QR, a&gbreve;&inodot;rl&inodot;k, tedarik&ccedil;i, lot, tarihlerle A6 etiket olu&#351;turur</td></tr>
            <tr><td><code>print_via_cups(image, printer_name, copies)</code></td><td>Ge&ccedil;ici PNG&rsquo;ye kaydeder &rarr; A6 medya ile <code>lp</code> komutu &rarr; temizler</td></tr>
            <tr><td><code>print_label(material_data)</code></td><td>&Uuml;ret + tek etiket yazd&inodot;r (1 kopya)</td></tr>
            <tr><td><code>print_label_with_quantity(material_data, copies)</code></td><td>&Uuml;ret + birden fazla kopya ile yazd&inodot;r</td></tr>
            <tr><td><code>print_multiple_labels(materials)</code></td><td>Toplu yazd&inodot;rma: ba&#351;ar&inodot;/ba&#351;ar&inodot;s&inodot;z say&inodot;lar&inodot;yla s&inodot;ral&inodot; i&#351;leme</td></tr>
            <tr><td><code>get_label_preview(material_data)</code></td><td>Base64 kodlanm&inodot;&#351; etiket g&ouml;r&uuml;nt&uuml;s&uuml; d&ouml;nd&uuml;r&uuml;r (yazd&inodot;rma yok)</td></tr>
            <tr><td><code>test_printer_connection(printer_name)</code></td><td><code>lpstat -p</code> alt s&uuml;reci &ccedil;al&inodot;&#351;t&inodot;r&inodot;r, connected/busy/not_found/timeout/error d&ouml;nd&uuml;r&uuml;r</td></tr>
            <tr><td><code>get_available_printers()</code></td><td><code>lpstat -p -d</code> &ccedil;al&inodot;&#351;t&inodot;r&inodot;r, mevcut CUPS yaz&inodot;c&inodot;lar&inodot;n&inodot; ayr&inodot;&#351;t&inodot;r&inodot;r</td></tr>
        </table>

        <h4>Font Geri D&ouml;n&uuml;&#351; Zinciri</h4>
        <p>Servis fontlar&inodot; platform s&inodot;ras&inodot;yla dener: macOS (<code>/System/Library/Fonts/</code>) &rarr; Linux (<code>/usr/share/fonts/</code>) &rarr; Windows (<code>C:/Windows/Fonts/</code>) &rarr; PIL varsay&inodot;lan. Bu, etiket &uuml;retiminin t&uuml;m geli&#351;tirme ve &uuml;retim ortamlar&inodot;nda &ccedil;al&inodot;&#351;mas&inodot;n&inodot; sa&gbreve;lar.</p>

        <h3>6.1.6 Yazd&inodot;rma &Idot;&#351;&ccedil;isi &mdash; Arka Plan &Idot;&#351; &Idot;&#351;leme</h3>

        <p>Dosya: <code>app/services/print_worker.py</code> (292 sat&inodot;r). Her aktif yaz&inodot;c&inodot; kendine ait bir arka plan i&#351;&ccedil;i thread&rsquo;i al&inodot;r.</p>

        <h4>Mimari</h4>
        <div class="flow">
            <span class="flow-step">Uygulama ba&#351;lar</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">initialize_workers(db_url)</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">DB&rsquo;den aktif yaz&inodot;c&inodot;lar&inodot; y&uuml;kle</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">Her yaz&inodot;c&inodot; i&ccedil;in PrintWorker olu&#351;tur</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">start_all_workers()</span>
        </div>

        <h4>&Idot;&#351;&ccedil;i Ya&#351;am D&ouml;ng&uuml;s&uuml;</h4>
        <ol>
            <li><strong>Ba&#351;latma:</strong> IP&rsquo;den CUPS yaz&inodot;c&inodot; ad&inodot; &uuml;retir (&ouml;rn. <code>Printer_192_168_0_182</code>), yaz&inodot;c&inodot;y&inodot; <code>lpadmin</code> ile CUPS&rsquo;a kaydeder, <code>lpoptions</code> ile A6&rsquo;y&inodot; varsay&inodot;lan medya olarak ayarlar</li>
            <li><strong>Yoklama d&ouml;ng&uuml;s&uuml;:</strong> Her 1 saniyede bu yaz&inodot;c&inodot; i&ccedil;in s&inodot;radaki QUEUED i&#351;i sorgular (<code>requested_at</code>&rsquo;a g&ouml;re s&inodot;ral&inodot; &mdash; FIFO)</li>
            <li><strong>&Idot;&#351; i&#351;leme:</strong> Durumu PRINTING yapar &rarr; <code>started_at</code> damgalar &rarr; malzeme + kullan&inodot;c&inodot; verisini &ccedil;eker &rarr; <code>print_label_with_quantity()</code> &ccedil;a&gbreve;&inodot;r&inodot;r</li>
            <li><strong>Ba&#351;ar&inodot;da:</strong> Durum &rarr; COMPLETED, <code>completed_at</code> damgalan&inodot;r</li>
            <li><strong>Ba&#351;ar&inodot;s&inodot;zl&inodot;kta:</strong> <code>retry_count &lt; 3</code> ise: art&inodot;r, QUEUED&rsquo;a geri al. <code>retry_count &ge; 3</code> ise: durum &rarr; FAILED</li>
        </ol>

        <h4>CUPS Otomatik Kay&inodot;t</h4>
        <p>Bir i&#351;&ccedil;i ba&#351;lad&inodot;&gbreve;&inodot;nda, yaz&inodot;c&inodot; CUPS&rsquo;a kay&inodot;tl&inodot; de&gbreve;ilse i&#351;&ccedil;i otomatik olarak ekler:</p>
        <pre><span class="comment"># Yaz&inodot;c&inodot;y&inodot; CUPS&rsquo;a otomatik kaydet</span>
lpadmin -p Printer_192_168_0_182 -E -v ipp://192.168.0.182:631/ipp/print -m everywhere
lpoptions -p Printer_192_168_0_182 -o media=A6</pre>

        <h3>6.1.7 Malzeme Atama Sistemi</h3>

        <p>Her yaz&inodot;c&inodot;ya <code>assigned_materials</code> JSON dizisi arac&inodot;l&inodot;&gbreve;&inodot;yla belirli malzeme t&uuml;rleri atanabilir. Alt&inodot; malzeme t&uuml;r&uuml; kodu, fabrikan&inodot;n QR kod harf sistemine kar&#351;&inodot;l&inodot;k gelir:</p>

        <table>
            <tr><th>Kod</th><th>Harf</th><th>Malzeme</th></tr>
            <tr><td><code>raw_copper</code></td><td>A</td><td>Bak&inodot;r</td></tr>
            <tr><td><code>raw_tin</code></td><td>B</td><td>Kalay</td></tr>
            <tr><td><code>raw_plastic</code></td><td>C</td><td>Plastik</td></tr>
            <tr><td><code>raw_catalyst</code></td><td>D</td><td>Kataliz&ouml;r</td></tr>
            <tr><td><code>raw_dye</code></td><td>E</td><td>Boya</td></tr>
            <tr><td><code>raw_antirodent</code></td><td>F</td><td>Antirodent</td></tr>
        </table>

        <p>Lab yaz&inodot;c&inodot;s&inodot; (ID 1) t&uuml;m malzeme giri&#351;lerini idare etti&gbreve;i i&ccedil;in alt&inodot; t&uuml;re de atanm&inodot;&#351;t&inodot;r. &Uuml;retim yaz&inodot;c&inodot;lar&inodot;n&inodot;n bo&#351; atamalar&inodot; vard&inodot;r &mdash; &uuml;retim a&#351;amas&inodot; etiketleme i&ccedil;in kullan&inodot;l&inodot;rlar.</p>

        <h3>6.1.8 Frontend Mimarisi</h3>

        <p>Tek dosya: <code>src/pages/Admin/PrinterManagement/index.tsx</code> (527 sat&inodot;r). Rota: <code>/admin/printer-management</code>.</p>

        <h4>Bile&#351;en Yap&inodot;s&inodot;</h4>
        <div class="arch-grid">
            <div class="arch-box">
                <h4>ProTable (11 s&uuml;tun)</h4>
                <p>ID (sabit sol), ad (sabit sol), a&ccedil;&inodot;klama, IP adresi (mavi etiket), port, konum, durum (renk kodlu etiket: ye&#351;il=&ccedil;evrimi&ccedil;i, k&inodot;rm&inodot;z&inodot;=&ccedil;evrimd&inodot;&#351;&inodot;, turuncu=hata, gri=bak&inodot;mda), atanm&inodot;&#351; malzemeler (harf etiketleri), aktif (onay/&ccedil;arp&inodot; ikon), i&#351;lemler (sabit sa&gbreve;).</p>
            </div>
            <div class="arch-box">
                <h4>Ekle/D&uuml;zenle Modal&inodot; (600px)</h4>
                <p>7 form alan&inodot;: ad (zorunlu), a&ccedil;&inodot;klama (textarea), konum, IP adresi (zorunlu), port (say&inodot;, varsay&inodot;lan 9100), atanm&inodot;&#351; malzemeler (malzeme kodlar&inodot;yla &ccedil;oklu se&ccedil;im), durum (a&ccedil;&inodot;l&inodot;r liste: &ccedil;evrimi&ccedil;i/&ccedil;evrimd&inodot;&#351;&inodot;/bak&inodot;mda/hata).</p>
            </div>
            <div class="arch-box">
                <h4>Ara&ccedil; &Ccedil;ubu&gbreve;u</h4>
                <p>Arama girdisi (t&uuml;m s&uuml;tunlarda istemci taraf&inodot; filtreleme) + &ldquo;Yeni Yaz&inodot;c&inodot; Ekle&rdquo; birincil buton. Tablo se&ccedil;enekleri: yo&gbreve;unluk, yenile, s&uuml;tun ayarlar&inodot;.</p>
            </div>
            <div class="arch-box">
                <h4>&Idot;&#351;lem Butonlar&inodot; (sat&inodot;r ba&#351;&inodot;na)</h4>
                <p>Ba&gbreve;lant&inodot; testi (ApiOutlined), D&uuml;zenle (EditOutlined), Sil (DeleteOutlined, tehlike). Sil, devam etmeden &ouml;nce onay modal&inodot; g&ouml;sterir.</p>
            </div>
        </div>

        <h4>&Idot;stemci Taraf&inodot; Arama</h4>
        <p>Arama girdisi t&uuml;m g&ouml;r&uuml;n&uuml;r s&uuml;tunlarda ayn&inodot; anda filtreler: ad, a&ccedil;&inodot;klama, IP adresi, konum, durum (&Idot;ngilizce ve T&uuml;rk&ccedil;e terimler), port ve ID. Bu tamamen frontend filtrelemededir &mdash; tam veri seti her zaman &ccedil;ekilir.</p>

        <h4>WebSocket Entegrasyonu Yok</h4>
        <p>Di&gbreve;er mod&uuml;llerin aksine, Yaz&inodot;c&inodot; Y&ouml;netimi ger&ccedil;ek zamanl&inodot; g&uuml;ncellemeler i&ccedil;in WebSocket kullanmaz. Tablo yenilemeleri her mutasyondan (olu&#351;tur, g&uuml;ncelle, sil, test) sonra manuel <code>actionRef.current?.reload()</code> ile ger&ccedil;ekle&#351;ir.</p>

        <h3>6.1.9 Yetki Modeli</h3>

        <p>Sayfa ID: <code>admin.yazici_yonetimi</code></p>

        <table>
            <tr><th>Yetki ID</th><th>Etiket</th><th>A&ccedil;&inodot;klama</th><th>Kritik</th></tr>
            <tr><td><code>access_page</code></td><td>Sayfaya Eri&#351;im</td><td>Sayfay&inodot; g&ouml;r&uuml;nt&uuml;leme</td><td></td></tr>
            <tr><td><code>view_table</code></td><td>Tablo G&ouml;r&uuml;nt&uuml;le</td><td>Yaz&inodot;c&inodot; tablosunu g&ouml;rme</td><td></td></tr>
            <tr><td><code>create_printer</code></td><td>Yeni Yaz&inodot;c&inodot; Ekle</td><td>Yeni yaz&inodot;c&inodot; olu&#351;turma</td><td></td></tr>
            <tr><td><code>edit_printer</code></td><td>Yaz&inodot;c&inodot; D&uuml;zenle</td><td>Yaz&inodot;c&inodot; ayarlar&inodot;n&inodot; g&uuml;ncelleme</td><td></td></tr>
            <tr><td><code>test_connection</code></td><td>Ba&gbreve;lant&inodot; Test</td><td>Yaz&inodot;c&inodot; ba&gbreve;lant&inodot;s&inodot;n&inodot; test etme</td><td></td></tr>
            <tr><td><code>assign_materials</code></td><td>Malzeme Ata</td><td>Yaz&inodot;c&inodot;ya malzeme t&uuml;rlerini atama</td><td></td></tr>
            <tr><td><code>delete_printer</code></td><td>Yaz&inodot;c&inodot; Sil</td><td>Yaz&inodot;c&inodot;y&inodot; silme</td><td>&#9679;</td></tr>
        </table>

        <p>Backend rol tabanl&inodot; uygular: yaln&inodot;zca <code>super_admin</code> olu&#351;turabilir/g&uuml;ncelleyebilir/silebilir, <code>super_admin</code> + <code>lab_user</code> test edebilir. Frontend bu 7 gran&uuml;ler yetkiyi yetki edit&ouml;r&uuml;n&uuml;n ke&#351;fetmesi i&ccedil;in <code>buttonRegistry</code>&rsquo;ye kaydeder.</p>

        <h3>6.1.10 Yaz&inodot;c&inodot; Y&ouml;netimi Sistemin Geri Kalan&inodot;na Nas&inodot;l Ba&gbreve;lan&inodot;r</h3>

        <div class="arch-grid">
            <div class="arch-box">
                <h4>&rarr; Yazd&inodot;rma Kuyru&gbreve;u (6.2)</h4>
                <p>Hammadde Giri&#351;i bir yazd&inodot;rma i&#351;i kuyru&gbreve;a ald&inodot;&gbreve;&inodot;nda, bir <code>printer_id</code> (1&ndash;4) belirtir. Yazd&inodot;rma kuyru&gbreve;u rotalar&inodot; bu ID&rsquo;yi yaz&inodot;c&inodot;lar tablosuna kar&#351;&inodot; do&gbreve;rular. Arka plan i&#351;&ccedil;ileri uygulama ba&#351;lang&inodot;c&inodot;nda yaz&inodot;c&inodot;lar tablosundan ba&#351;lat&inodot;l&inodot;r.</p>
            </div>
            <div class="arch-box">
                <h4>&rarr; Hammadde Giri&#351;i</h4>
                <p>Bir malzeme girildikten sonra ba&#351;ar&inodot; modal&inodot; &ldquo;Etiket Yazd&inodot;r&rdquo; butonu sunar. Bu <code>POST /api/print-queue/queue/{material_id}?printer_id=X</code> &ccedil;a&gbreve;&inodot;r&inodot;r ve i&#351;i se&ccedil;ilen yaz&inodot;c&inodot;n&inodot;n kuyru&gbreve;una g&ouml;nderir.</p>
            </div>
            <div class="arch-box">
                <h4>&rarr; Hammaddeler Listesi</h4>
                <p>Hammaddeler Listesi&rsquo;ndeki yeniden yazd&inodot;rma eylemi de ID ile belirli bir yaz&inodot;c&inodot;y&inodot; hedefler. <code>GET /api/materials/print/preview/{id}</code> endpoint&rsquo;i, yaz&inodot;c&inodot;lar tablosundan yaz&inodot;c&inodot; konfig&uuml;rasyonunu y&uuml;kleyen <code>get_default_print_service()</code> kullan&inodot;r (&ldquo;Lab&rdquo; yaz&inodot;c&inodot;s&inodot;n&inodot; tercih eder, ilk aktif yaz&inodot;c&inodot;ya geri d&ouml;ner).</p>
            </div>
            <div class="arch-box">
                <h4>&rarr; Uygulama Ba&#351;lang&inodot;c&inodot; (main.py)</h4>
                <p><code>initialize_workers(db_url)</code> DB&rsquo;den t&uuml;m aktif yaz&inodot;c&inodot;lar&inodot; okur, her yaz&inodot;c&inodot; i&ccedil;in bir <code>PrintWorker</code> daemon thread&rsquo;i olu&#351;turur, her birini CUPS&rsquo;a otomatik kaydeder ve yoklamay&inodot; ba&#351;lat&inodot;r. &Idot;&#351;&ccedil;iler dijital kuyruk ile fiziksel donan&inodot;m aras&inodot;ndaki k&ouml;pr&uuml;d&uuml;r.</p>
            </div>
        </div>

        <div class="discovery">
            <p style="margin-bottom: 0;"><strong>Mimari i&ccedil;g&ouml;r&uuml;:</strong> Yaz&inodot;c&inodot; Y&ouml;netimi bir donan&inodot;m soyutlama katman&inodot;d&inodot;r. Sistemin geri kalan&inodot; asla do&gbreve;rudan yaz&inodot;c&inodot;larla konu&#351;maz &mdash; bir <code>printer_id</code> ile i&#351; kuyru&gbreve;a al&inodot;r ve i&#351;&ccedil;i thread&rsquo;leri CUPS/IPP &uuml;zerinden fiziksel ileti&#351;imi y&ouml;netir. Bu ayr&inodot;&#351;t&inodot;rma, bir yaz&inodot;c&inodot;n&inodot;n Hammadde Giri&#351;i veya Hammaddeler Listesi&rsquo;nde hi&ccedil;bir kod de&gbreve;i&#351;ikli&gbreve;i olmadan de&gbreve;i&#351;tirilebilece&gbreve;i, IP&rsquo;sinin g&uuml;ncellenebilece&gbreve;i veya &ccedil;evrimd&inodot;&#351;&inodot; al&inodot;nabilece&gbreve;i anlam&inodot;na gelir. <code>assigned_materials</code> alan&inodot; kullan&inodot;c&inodot; aray&uuml;z&uuml; i&ccedil;in meta veridir (kullan&inodot;c&inodot;lar&inodot;n do&gbreve;ru yaz&inodot;c&inodot;y&inodot; se&ccedil;mesine yard&inodot;mc&inodot; olur) ancak kuyruk d&uuml;zeyinde uygulanmaz &mdash; herhangi bir yaz&inodot;c&inodot; teknik olarak herhangi bir malzemenin etiketini yazd&inodot;rabilir.</p>
        </div>

        <!-- ============================================ -->
        <!-- 6.2  YAZDIRMA İZLEME                         -->
        <!-- ============================================ -->

        <h2 id="sec-6-2" style="margin-top: 48px;">6.2 Yazd&inodot;rma &Idot;zleme (Print Job Monitor)</h2>

        <h3>6.2.1 Ama&ccedil; ve &Idot;&#351; Ba&gbreve;lam&inodot;</h3>

        <p>Her malzeme etiket yazd&inodot;rmas&inodot; bir i&#351; kuyru&gbreve;undan ge&ccedil;er. &Idot;&#351;, kullan&inodot;c&inodot; Hammadde Giri&#351;i veya Hammaddeler Listesi&rsquo;nde &ldquo;Yazd&inodot;r&rdquo;a t&inodot;klad&inodot;&gbreve;&inodot; anda olu&#351;turulur ve bir arka plan i&#351;&ccedil;isi bir saniye i&ccedil;inde onu al&inodot;r. <strong>Yazd&inodot;rma &Idot;zleme</strong>, bu g&ouml;r&uuml;nmez boru hatt&inodot;n&inodot; g&ouml;r&uuml;n&uuml;r k&inodot;lan ger&ccedil;ek zamanl&inodot; panodur: ka&ccedil; i&#351; bekliyor, hangileri &#351;u anda yazd&inodot;r&inodot;l&inodot;yor, hangileri ba&#351;ar&inodot;l&inodot; oldu, hangileri ba&#351;ar&inodot;s&inodot;z oldu ve neden.</p>

        <p>&Idot;ki amaca hizmet eder: <strong>izleme</strong> (yaz&inodot;c&inodot;lar yeti&#351;ebiliyor mu? ba&#351;ar&inodot;s&inodot;zl&inodot;k var m&inodot;?) ve <strong>m&uuml;dahale</strong> (ba&#351;ar&inodot;s&inodot;z bir i&#351;i yeniden dene, kuyruktakini iptal et). Bu alt mod&uuml;l olmadan, ba&#351;ar&inodot;s&inodot;z bir yazd&inodot;rma 3 denemeden sonra sessizce kaybolur ve kimse bir malzemenin etiketinin eksik oldu&gbreve;unu bilmez.</p>

        <h3>6.2.2 Veritaban&inodot; &#350;emas&inodot;</h3>

        <p>Tek tablo: <code>print_jobs</code> (model dosyas&inodot;: 69 sat&inodot;r)</p>

        <table>
            <tr><th>S&uuml;tun</th><th>Tip</th><th>K&inodot;s&inodot;tlamalar</th><th>Ama&ccedil;</th></tr>
            <tr><td><code>id</code></td><td>Integer PK</td><td>Otomatik art&inodot;&#351;, indeksli</td><td>Benzersiz i&#351; tan&inodot;mlay&inodot;c&inodot;</td></tr>
            <tr><td><code>material_id</code></td><td>Integer FK &rarr; raw_materials</td><td>NOT NULL</td><td>Bu etiketin hangi malzeme i&ccedil;in oldu&gbreve;u</td></tr>
            <tr><td><code>qr_code</code></td><td>String(50)</td><td>NOT NULL</td><td>QR kod metni. Reddedilen malzemeler i&ccedil;in &ldquo; - REDDEDILDI&rdquo; eki i&ccedil;erir</td></tr>
            <tr><td><code>printer_id</code></td><td>Integer</td><td>NOT NULL, indeksli</td><td>Hedef yaz&inodot;c&inodot; (1&ndash;4)</td></tr>
            <tr><td><code>copies</code></td><td>Integer</td><td>NOT NULL, varsay&inodot;lan 1</td><td>Yazd&inodot;r&inodot;lacak etiket kopya say&inodot;s&inodot;</td></tr>
            <tr><td><code>status</code></td><td>String(20)</td><td>NOT NULL, indeksli, varsay&inodot;lan &ldquo;queued&rdquo;</td><td>&#304;&#351; ya&#351;am d&ouml;ng&uuml;s&uuml; durumu</td></tr>
            <tr><td><code>retry_count</code></td><td>Integer</td><td>NOT NULL, varsay&inodot;lan 0</td><td>&#304;&#351;&ccedil;inin ka&ccedil; kez yeniden denedi&gbreve;i (maks 3)</td></tr>
            <tr><td><code>error_message</code></td><td>Text</td><td>NULLABLE</td><td>&#304;&#351; ba&#351;ar&inodot;s&inodot;z olursa hata detaylar&inodot;</td></tr>
            <tr><td><code>requested_by</code></td><td>Integer FK &rarr; users</td><td>NOT NULL</td><td>Yazd&inodot;rmay&inodot; tetikleyen kullan&inodot;c&inodot;</td></tr>
            <tr><td><code>requested_at</code></td><td>DateTime</td><td>NOT NULL, otomatik</td><td>&#304;&#351;in kuyru&gbreve;a al&inodot;nd&inodot;&gbreve;&inodot; zaman</td></tr>
            <tr><td><code>started_at</code></td><td>DateTime</td><td>NULLABLE</td><td>&#304;&#351;&ccedil;inin yazd&inodot;rmaya ba&#351;lad&inodot;&gbreve;&inodot; zaman</td></tr>
            <tr><td><code>completed_at</code></td><td>DateTime</td><td>NULLABLE</td><td>&#304;&#351;in tamamland&inodot;&gbreve;&inodot; veya ba&#351;ar&inodot;s&inodot;z oldu&gbreve;u zaman</td></tr>
            <tr><td><code>material_type</code></td><td>String(50)</td><td>NULLABLE, denormalize</td><td>Join olmadan h&inodot;zl&inodot; g&ouml;sterim i&ccedil;in malzeme t&uuml;r&uuml;</td></tr>
            <tr><td><code>lot_number</code></td><td>String(100)</td><td>NULLABLE, denormalize</td><td>H&inodot;zl&inodot; g&ouml;sterim i&ccedil;in lot numaras&inodot;</td></tr>
            <tr><td><code>supplier_name</code></td><td>String(200)</td><td>NULLABLE, denormalize</td><td>H&inodot;zl&inodot; g&ouml;sterim i&ccedil;in tedarik&ccedil;i ad&inodot;</td></tr>
        </table>

        <h4>PrintJobStatus Enum (5 durum)</h4>
        <pre><span class="keyword">class</span> <span class="string">PrintJobStatus</span>(str, Enum):
    QUEUED    = <span class="string">"queued"</span>      <span class="comment"># Kuyrukta bekliyor</span>
    PRINTING  = <span class="string">"printing"</span>    <span class="comment"># &#304;&#351;&ccedil;i &#351;u anda yazd&inodot;r&inodot;yor</span>
    COMPLETED = <span class="string">"completed"</span>   <span class="comment"># Etiket ba&#351;ar&inodot;yla yazd&inodot;r&inodot;ld&inodot;</span>
    FAILED    = <span class="string">"failed"</span>      <span class="comment"># 3 denemeden sonra ba&#351;ar&inodot;s&inodot;z</span>
    CANCELLED = <span class="string">"cancelled"</span>   <span class="comment"># Admin taraf&inodot;ndan manuel iptal</span></pre>

        <h4>&#304;&#351; Ya&#351;am D&ouml;ng&uuml;s&uuml;</h4>
        <div class="flow">
            <span class="flow-step">QUEUED</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">PRINTING</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">COMPLETED</span>
        </div>
        <div class="flow" style="margin-top: 8px;">
            <span class="flow-step">PRINTING (ba&#351;ar&inodot;s&inodot;z)</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">QUEUED (deneme &lt; 3)</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">PRINTING</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">FAILED (deneme &ge; 3)</span>
        </div>
        <div class="flow" style="margin-top: 8px;">
            <span class="flow-step">QUEUED</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">CANCELLED (manuel)</span>
        </div>

        <h4>Denormalizasyon Stratejisi</h4>
        <p>&Uuml;&ccedil; s&uuml;tun (<code>material_type</code>, <code>lot_number</code>, <code>supplier_name</code>) bilin&ccedil;li olarak <code>raw_materials</code> ve <code>suppliers</code>&rsquo;dan denormalize edilmi&#351;tir. Bu, izleme panosunun tablolar aras&inodot; pahal&inodot; join&rsquo;ler olmadan t&uuml;m i&#351; verilerini g&ouml;stermesini sa&gbreve;lar &mdash; 500&rsquo;e kadar i&#351; listeleyen bir sayfa i&ccedil;in kritiktir.</p>

        <h3>6.2.3 API S&ouml;zle&#351;mesi &mdash; 5 Endpoint</h3>

        <table>
            <tr><th>Metot</th><th>Yol</th><th>Yetki</th><th>Ne Yapar</th></tr>
            <tr><td><code>POST</code></td><td><code>/api/print-queue/queue/{material_id}?printer_id=X</code></td><td>super_admin, lab_user, operator</td><td>Yazd&inodot;rma i&#351;i kuyru&gbreve;a al. QUEUED durumuyla PrintJob olu&#351;turur. Kopya say&inodot;s&inodot; <code>material.quantity</code>&rsquo;den (varsay&inodot;lan 1). Malzeme reddedilmi&#351;se QR&rsquo;ye &ldquo; - REDDEDILDI&rdquo; ekler. material_type, lot_number, supplier_name denormalize eder.</td></tr>
            <tr><td><code>GET</code></td><td><code>/api/print-queue/jobs</code></td><td>Yaln&inodot;zca super_admin</td><td>&#304;&#351;leri filtrelerle listele: <code>?status=</code>, <code>?printer_id=</code>, <code>?limit=</code> (varsay&inodot;lan 100, maks 500). <code>requested_at DESC</code> s&inodot;ral&inodot;. Tamamlanm&inodot;&#351;sa <code>duration</code> saniye hesaplar.</td></tr>
            <tr><td><code>POST</code></td><td><code>/api/print-queue/jobs/{id}/retry</code></td><td>super_admin veya lab_user</td><td>Ba&#351;ar&inodot;s&inodot;z i&#351;i s&inodot;f&inodot;rla: durum &rarr; QUEUED, retry_count &rarr; 0, error_message temizle, zaman damgalar&inodot;n&inodot; s&inodot;f&inodot;rla. &#304;&#351;&ccedil;i yeniden al&inodot;r.</td></tr>
            <tr><td><code>DELETE</code></td><td><code>/api/print-queue/jobs/{id}</code></td><td>Yaln&inodot;zca super_admin</td><td>Kuyruktaki i&#351;i iptal et. Durum PRINTING ise <strong>engellenir</strong> (&ldquo;Devam eden i&#351; iptal edilemez&rdquo;). Durum &rarr; CANCELLED, completed_at damgalan&inodot;r.</td></tr>
            <tr><td><code>GET</code></td><td><code>/api/print-queue/stats</code></td><td>Yaln&inodot;zca super_admin</td><td>&#304;&#351; say&inodot;lar&inodot;n&inodot; d&ouml;nd&uuml;r&uuml;r: <code>{ queued, printing, completed, failed, total }</code>.</td></tr>
        </table>

        <h3>6.2.4 CRUD Ak&inodot;&#351;&inodot;</h3>

        <p><strong>Olu&#351;tur (Yazd&inodot;rma &#304;&#351;i Kuyru&gbreve;a Al):</strong></p>
        <ol>
            <li>Hammaddeler Listesi&rsquo;nde bir malzeme sat&inodot;r&inodot;ndaki yazd&inodot;r ikonuna t&inodot;kla (palet/makara i&ccedil;in devre d&inodot;&#351;&inodot;)</li>
            <li>Yaz&inodot;c&inodot; se&ccedil;im modal&inodot; a&ccedil;&inodot;l&inodot;r: QR kodu, etiket say&inodot;s&inodot; (<code>material.quantity</code> veya 1) ve <code>GET /api/printers/list?active_only=true</code>&rsquo;den &ccedil;ekilen aktif yaz&inodot;c&inodot;lar&inodot;n a&ccedil;&inodot;l&inodot;r listesini g&ouml;sterir</li>
            <li>Yaz&inodot;c&inodot; se&ccedil; &rarr; &ldquo;Yazd&inodot;r&rdquo;a t&inodot;kla</li>
            <li><code>POST /api/print-queue/queue/{material_id}?printer_id=X</code></li>
            <li>Backend malzemenin var oldu&gbreve;unu do&gbreve;rular, ili&#351;kiden tedarik&ccedil;i ad&inodot;n&inodot; al&inodot;r, malzemenin reddedilip reddedilmedi&gbreve;ini kontrol eder (QR&rsquo;ye &ldquo; - REDDEDILDI&rdquo; ekler), t&uuml;r/lot/tedarik&ccedil;iyi i&#351; sat&inodot;r&inodot;na denormalize eder</li>
            <li>Ba&#351;ar&inodot;da: toast &ldquo;Yazd&inodot;rma i&#351;i kuyru&gbreve;a eklendi (#123)&rdquo; &rarr; modal kapan&inodot;r</li>
            <li>Arka plan i&#351;&ccedil;isi i&#351;i 1 saniye i&ccedil;inde al&inodot;r ve yazd&inodot;rmaya ba&#351;lar</li>
        </ol>

        <p><strong>Oku (&#304;&#351;leri &#304;zle):</strong></p>
        <ol>
            <li>/admin/print-monitor sayfas&inodot;na git</li>
            <li>Sayfa y&uuml;klenir &rarr; <code>GET /api/print-queue/jobs?limit=200</code> + <code>GET /api/print-queue/stats</code></li>
            <li>&Uuml;stte 4 istatistik kart&inodot; render edilir: Bekleyen (gri), Yazd&inodot;r&inodot;l&inodot;yor (mavi), Tamamlanan (ye&#351;il), Ba&#351;ar&inodot;s&inodot;z (k&inodot;rm&inodot;z&inodot;)</li>
            <li>ProTable (16 s&uuml;tun) t&uuml;m i&#351;leri render eder: ID, QR kod (mavi etiket), malzeme t&uuml;r&uuml; (renk kodlu T&uuml;rk&ccedil;e etiket), lot, tedarik&ccedil;i, yaz&inodot;c&inodot; (filtrelenebilir 1&ndash;4), adet (kal&inodot;n), durum (renk kodlu etiket), deneme say&inodot;s&inodot; (X/3 uyar&inodot; etiketi &gt; 0 ise), hata mesaj&inodot; (k&inodot;rm&inodot;z&inodot; tooltip), kullan&inodot;c&inodot;, istek/ba&#351;lang&inodot;&ccedil;/biti&#351; zaman damgalar&inodot; (T&uuml;rkiye saat dilimi), s&uuml;re (saniye), i&#351;lemler</li>
            <li>&#304;stemci taraf&inodot; arama QR kod, lot, tedarik&ccedil;i, kullan&inodot;c&inodot;, durum, malzeme t&uuml;r&uuml;, ID ve yaz&inodot;c&inodot; &uuml;zerinde &mdash; T&uuml;rk&ccedil;e &ccedil;eviriler dahil &mdash; filtreler</li>
        </ol>

        <p><strong>Yeniden Dene (Ba&#351;ar&inodot;s&inodot;z &rarr; Kuyrukta):</strong></p>
        <ol>
            <li>Yeniden dene butonu (RedoOutlined) <strong>yaln&inodot;zca</strong> &ldquo;ba&#351;ar&inodot;s&inodot;z&rdquo; durumlu sat&inodot;rlarda g&ouml;r&uuml;n&uuml;r</li>
            <li>Yeniden dene&rsquo;ye t&inodot;kla &rarr; <code>POST /api/print-queue/jobs/{id}/retry</code></li>
            <li>Backend s&inodot;f&inodot;rlar: durum &rarr; QUEUED, retry_count &rarr; 0, error_message temizlenir, started_at ve completed_at null yap&inodot;l&inodot;r</li>
            <li>Ba&#351;ar&inodot;da: toast &ldquo;&#304;&#351; #{id} tekrar kuyru&gbreve;a eklendi&rdquo; &rarr; tablo + istatistikler yenilenir</li>
            <li>&#304;&#351;&ccedil;i sonraki yoklama d&ouml;ng&uuml;s&uuml;nde (1 saniye i&ccedil;inde) i&#351;i yeniden al&inodot;r</li>
        </ol>

        <p><strong>&#304;ptal (Kuyrukta &rarr; &#304;ptal Edildi):</strong></p>
        <ol>
            <li>&#304;ptal butonu (CloseCircleOutlined, tehlike) <strong>yaln&inodot;zca</strong> &ldquo;kuyrukta&rdquo; durumlu sat&inodot;rlarda g&ouml;r&uuml;n&uuml;r</li>
            <li>&#304;ptal&rsquo;e t&inodot;kla &rarr; onay modal&inodot;: &ldquo;&#304;&#351; #{id} iptal edilsin mi?&rdquo; ile &ldquo;&#304;ptal Et&rdquo; (tehlike) / &ldquo;Vazge&ccedil;&rdquo;</li>
            <li>Onayda: <code>DELETE /api/print-queue/jobs/{id}</code></li>
            <li>Backend i&#351;in PRINTING olmad&inodot;&gbreve;&inodot;n&inodot; do&gbreve;rular (&ldquo;Devam eden i&#351; iptal edilemez&rdquo; ile engeller), durum &rarr; CANCELLED, completed_at damgalan&inodot;r</li>
            <li>Ba&#351;ar&inodot;da: toast &ldquo;&#304;&#351; #{id} iptal edildi&rdquo; &rarr; tablo + istatistikler yenilenir</li>
        </ol>

        <h3>6.2.5 Arka Plan &#304;&#351;&ccedil;isi &mdash; &#304;&#351;ler Nas&inodot;l Ger&ccedil;ekten Yazd&inodot;r&inodot;l&inodot;r</h3>

        <p>Bu izleme sayfas&inodot; ile fiziksel yazd&inodot;rma aras&inodot;ndaki ba&gbreve;lant&inodot; <code>PrintWorker</code>&rsquo;d&inodot;r (292 sat&inodot;r, 6.1.6&rsquo;da a&ccedil;&inodot;klanm&inodot;&#351;t&inodot;r). &#304;&#351;&ccedil;i bir i&#351;i i&#351;lerken tam veri ak&inodot;&#351;&inodot;:</p>

        <div class="flow">
            <span class="flow-step">Her 1s DB yokla</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">Bu yaz&inodot;c&inodot; i&ccedil;in en eski QUEUED i&#351;i bul</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">Durum &rarr; PRINTING</span>
        </div>
        <div class="flow" style="margin-top: 8px;">
            <span class="flow-step">RawMaterial &ccedil;ek</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">User (entered_by) &ccedil;ek</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">material_data dict olu&#351;tur</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">print_label_with_quantity()</span>
        </div>

        <h4>material_data Dict (&#304;&#351;&ccedil;i Taraf&inodot;ndan Olu&#351;turulur)</h4>
        <table>
            <tr><th>Anahtar</th><th>Kaynak</th></tr>
            <tr><td><code>qr_code</code></td><td><code>job.qr_code</code> (reddedilmi&#351;se &ldquo;REDDEDILDI&rdquo; i&ccedil;erir)</td></tr>
            <tr><td><code>material_type</code></td><td><code>job.material_type</code> (denormalize)</td></tr>
            <tr><td><code>lot_number</code></td><td><code>job.lot_number</code> veya <code>material.lot_number</code></td></tr>
            <tr><td><code>supplier_name</code></td><td><code>job.supplier_name</code> (denormalize)</td></tr>
            <tr><td><code>weight</code></td><td><code>material.weight</code> (DB&rsquo;den canl&inodot;)</td></tr>
            <tr><td><code>received_date</code></td><td><code>material.received_date</code> (DB&rsquo;den canl&inodot;)</td></tr>
            <tr><td><code>entered_by</code></td><td><code>user.full_name</code> veya <code>user.username</code> (canl&inodot; arama)</td></tr>
            <tr><td><code>notes</code></td><td><code>material.notes</code> (DB&rsquo;den canl&inodot;)</td></tr>
        </table>

        <p>Hibrit yakla&#351;&inodot;ma dikkat edin: baz&inodot; alanlar denormalize i&#351; sat&inodot;r&inodot;ndan gelir (h&inodot;zl&inodot;, join yok), a&gbreve;&inodot;rl&inodot;k, tarih, kullan&inodot;c&inodot; ad&inodot; ve notlar ise DB&rsquo;den canl&inodot; &ccedil;ekilir (her zaman g&uuml;ncel).</p>

        <h4>Yeniden Deneme Mant&inodot;&gbreve;&inodot; (Otomatik)</h4>
        <table>
            <tr><th>retry_count</th><th>Yazd&inodot;rma Ba&#351;ar&inodot;s&inodot;z</th><th>Sonu&ccedil;</th></tr>
            <tr><td>0</td><td>&#304;lk deneme ba&#351;ar&inodot;s&inodot;z</td><td>retry_count &rarr; 1, durum &rarr; QUEUED, hata saklan&inodot;r</td></tr>
            <tr><td>1</td><td>&#304;kinci deneme ba&#351;ar&inodot;s&inodot;z</td><td>retry_count &rarr; 2, durum &rarr; QUEUED</td></tr>
            <tr><td>2</td><td>&Uuml;&ccedil;&uuml;nc&uuml; deneme ba&#351;ar&inodot;s&inodot;z</td><td>retry_count &rarr; 3, durum &rarr; QUEUED</td></tr>
            <tr><td>3</td><td>D&ouml;rd&uuml;nc&uuml; deneme ba&#351;ar&inodot;s&inodot;z</td><td>durum &rarr; <strong>FAILED</strong>, completed_at damgalan&inodot;r</td></tr>
        </table>

        <p>Otomatik 3 deneme t&uuml;kendikten sonra, i&#351; panoda &ldquo;Ba&#351;ar&inodot;s&inodot;z&rdquo; olarak &ldquo;3/3&rdquo; deneme say&inodot;s&inodot;yla g&ouml;r&uuml;n&uuml;r. Bir admin veya lab kullan&inodot;c&inodot;s&inodot; daha sonra manuel olarak yeniden deneyebilir (sayac&inodot; 0&rsquo;a s&inodot;f&inodot;rlar).</p>

        <h3>6.2.6 Frontend Mimarisi</h3>

        <p>Tek dosya: <code>src/pages/Admin/PrintJobMonitor/index.tsx</code> (509 sat&inodot;r). Rota: <code>/admin/print-monitor</code>.</p>

        <h4>Bile&#351;en Yap&inodot;s&inodot;</h4>
        <div class="arch-grid">
            <div class="arch-box">
                <h4>4 &#304;statistik Kart&inodot; (Row, gutter 16)</h4>
                <p><strong>Bekleyen &#304;&#351;ler</strong> (gri #8c8c8c), <strong>Yazd&inodot;r&inodot;l&inodot;yor</strong> (mavi #1890ff), <strong>Tamamlanan</strong> (ye&#351;il #52c41a), <strong>Ba&#351;ar&inodot;s&inodot;z</strong> (k&inodot;rm&inodot;z&inodot; #ff4d4f). Font boyutu 24px. Her tablo y&uuml;klemesinden ve yeniden dene/iptal eylemlerinden sonra yenilenir.</p>
            </div>
            <div class="arch-box">
                <h4>ProTable (16 s&uuml;tun)</h4>
                <p>Varsay&inodot;lan sayfa boyutu 50, maks 500. Kayd&inodot;rma geni&#351;li&gbreve;i 1800px. S&uuml;tunlar: ID (s&inodot;ralanabilir, sabit sol), QR kod (mavi etiket), malzeme t&uuml;r&uuml; (renk kodlu), lot, tedarik&ccedil;i, yaz&inodot;c&inodot; (filtrelenebilir), adet (kal&inodot;n), durum (filtrelenebilir, renk kodlu), deneme say&inodot;s&inodot;, hata (k&inodot;rm&inodot;z&inodot; tooltip), kullan&inodot;c&inodot;, 3 zaman damgas&inodot; (T&uuml;rkiye SD), s&uuml;re, i&#351;lemler (sabit sa&gbreve;).</p>
            </div>
            <div class="arch-box">
                <h4>Ara&ccedil; &Ccedil;ubu&gbreve;u</h4>
                <p>Arama girdisi (T&uuml;rk&ccedil;e &ccedil;eviriler dahil t&uuml;m s&uuml;tunlarda istemci taraf&inodot; filtreleme) + tablo se&ccedil;enekleri (yo&gbreve;unluk, yenile, s&uuml;tun ayarlar&inodot;). Ba&#351;l&inodot;k: &ldquo;Yazd&inodot;rma &#304;&#351;leri&rdquo;.</p>
            </div>
            <div class="arch-box">
                <h4>&#304;&#351;lem Butonlar&inodot; (ko&#351;ullu)</h4>
                <p><strong>Yeniden Dene</strong> (RedoOutlined): yaln&inodot;zca &ldquo;ba&#351;ar&inodot;s&inodot;z&rdquo; sat&inodot;rlarda g&ouml;r&uuml;n&uuml;r. <strong>&#304;ptal</strong> (CloseCircleOutlined, tehlike): yaln&inodot;zca &ldquo;kuyrukta&rdquo; sat&inodot;rlarda g&ouml;r&uuml;n&uuml;r. &ldquo;Yazd&inodot;r&inodot;l&inodot;yor&rdquo;, &ldquo;tamamland&inodot;&rdquo; veya &ldquo;iptal edildi&rdquo; sat&inodot;rlar&inodot;nda i&#351;lem yok.</p>
            </div>
        </div>

        <h4>Tarih Bi&ccedil;imlendirme</h4>
        <p>T&uuml;m zaman damgalar&inodot; veritaban&inodot;nda UTC olarak saklan&inodot;r. Frontend bunlar&inodot; <code>dayjs.utc(dateStr).tz('Europe/Istanbul')</code> kullanarak d&ouml;n&uuml;&#351;t&uuml;r&uuml;r ve <code>D.MM.YYYY HH:mm:ss</code> bi&ccedil;iminde g&ouml;sterir (&ouml;rn. &ldquo;18.02.2026 14:30:45&rdquo;).</p>

        <h4>Malzeme T&uuml;r&uuml; Etiketleri (Renk E&#351;lemesi)</h4>
        <table>
            <tr><th>T&uuml;r</th><th>Etiket Rengi</th><th>T&uuml;rk&ccedil;e Etiket</th></tr>
            <tr><td><code>raw_copper</code></td><td>orange</td><td>Bak&inodot;r</td></tr>
            <tr><td><code>raw_tin</code></td><td>cyan</td><td>Kalay</td></tr>
            <tr><td><code>raw_plastic</code></td><td>purple</td><td>Plastik</td></tr>
            <tr><td><code>raw_catalyst</code></td><td>magenta</td><td>Kataliz&ouml;r</td></tr>
            <tr><td><code>raw_dye</code></td><td>volcano</td><td>Boya</td></tr>
            <tr><td><code>raw_antirodent</code></td><td>geekblue</td><td>Antirodent</td></tr>
        </table>

        <h4>WebSocket Yok &mdash; Manuel Yenileme</h4>
        <p>ERP&rsquo;deki di&gbreve;er sayfalar&inodot;n aksine, Yazd&inodot;rma &#304;zleme ger&ccedil;ek zamanl&inodot; g&uuml;ncellemeler i&ccedil;in WebSocket kullanmaz. Tablo ve istatistikler mutasyonlardan (yeniden dene, iptal) sonra <code>actionRef.current?.reload()</code> ile ve tablonun yerle&#351;ik yenile butonuyla yenilenir. Otomatik yoklama yoktur.</p>

        <h3>6.2.7 Yetki Modeli</h3>

        <p>Sayfa ID: <code>admin.yazdirma_izleme</code></p>

        <table>
            <tr><th>Yetki ID</th><th>Etiket</th><th>A&ccedil;&inodot;klama</th></tr>
            <tr><td><code>access_page</code></td><td>Sayfaya Eri&#351;im</td><td>Yazd&inodot;rma izleme sayfas&inodot;n&inodot; g&ouml;r&uuml;nt&uuml;leme</td></tr>
            <tr><td><code>view_jobs</code></td><td>&#304;&#351;leri G&ouml;r&uuml;nt&uuml;le</td><td>Yazd&inodot;rma i&#351;lerini g&ouml;rme</td></tr>
            <tr><td><code>view_stats</code></td><td>&#304;statistikler</td><td>&#304;statistik kartlar&inodot;n&inodot; g&ouml;rme</td></tr>
            <tr><td><code>retry_job</code></td><td>Tekrar Dene</td><td>Ba&#351;ar&inodot;s&inodot;z i&#351;i tekrar &ccedil;al&inodot;&#351;t&inodot;rma</td></tr>
            <tr><td><code>cancel_job</code></td><td>&#304;&#351;i &#304;ptal Et</td><td>Bekleyen i&#351;i iptal etme</td></tr>
            <tr><td><code>refresh_data</code></td><td>Yenile</td><td>Veriyi yenileme butonu</td></tr>
        </table>

        <p>Backend uygular: <code>super_admin</code> her &#351;eyi yapabilir. <code>lab_user</code> ba&#351;ar&inodot;s&inodot;z i&#351;leri yeniden deneyebilir. <code>operator</code> yaln&inodot;zca yeni i&#351; kuyru&gbreve;a alabilir (Hammadde Giri&#351;i &uuml;zerinden) ancak izleme panosuna eri&#351;emez.</p>

        <h3>6.2.8 Yazd&inodot;rma &#304;zleme Sistemin Geri Kalan&inodot;na Nas&inodot;l Ba&gbreve;lan&inodot;r</h3>

        <div class="arch-grid">
            <div class="arch-box">
                <h4>&larr; Hammadde Giri&#351;i (Kaynak)</h4>
                <p>Bir malzeme girildikten sonra ba&#351;ar&inodot; modal&inodot;n&inodot;n &ldquo;Yazd&inodot;r&rdquo; butonu <code>POST /print-queue/queue/{id}</code> ile bir yazd&inodot;rma i&#351;i kuyru&gbreve;a al&inodot;r. Bu birincil i&#351; olu&#351;turma yoludur.</p>
            </div>
            <div class="arch-box">
                <h4>&larr; Hammaddeler Listesi (Kaynak)</h4>
                <p>Herhangi bir malzeme sat&inodot;r&inodot;ndaki yeniden yazd&inodot;r butonu bir yaz&inodot;c&inodot; se&ccedil;im modal&inodot; a&ccedil;ar (QR kodu + etiket say&inodot;s&inodot; g&ouml;sterir), sonra ayn&inodot; endpoint &uuml;zerinden kuyru&gbreve;a al&inodot;r. Palet ve makaralar i&ccedil;in devre d&inodot;&#351;&inodot;.</p>
            </div>
            <div class="arch-box">
                <h4>&rarr; Yaz&inodot;c&inodot; Y&ouml;netimi (6.1)</h4>
                <p>Yazd&inodot;rma i&#351;&ccedil;ileri yaz&inodot;c&inodot;lar tablosundan ba&#351;lat&inodot;l&inodot;r. Hammaddeler Listesi&rsquo;ndeki yaz&inodot;c&inodot; se&ccedil;im modal&inodot; <code>/api/printers/list</code>&rsquo;den aktif yaz&inodot;c&inodot;lar&inodot; &ccedil;eker. &#304;&#351;teki yaz&inodot;c&inodot; ID&rsquo;si 6.1&rsquo;de yap&inodot;land&inodot;r&inodot;lm&inodot;&#351; fiziksel bir cihaza kar&#351;&inodot;l&inodot;k gelir.</p>
            </div>
            <div class="arch-box">
                <h4>&rarr; PrintWorker (Arka Plan)</h4>
                <p>Yaz&inodot;c&inodot; ba&#351;&inodot;na bir daemon thread&rsquo;i print_jobs tablosunu her 1 saniyede yoklar, QUEUED i&#351;leri FIFO s&inodot;ras&inodot;yla i&#351;ler, otomatik yeniden denemeleri y&ouml;netir (maks 3) ve i&#351; durumunu g&uuml;nceller. 6.1.6&rsquo;da detayl&inodot; a&ccedil;&inodot;klanm&inodot;&#351;t&inodot;r.</p>
            </div>
        </div>

        <div class="discovery">
            <p style="margin-bottom: 0;"><strong>Mimari i&ccedil;g&ouml;r&uuml;:</strong> Yazd&inodot;rma kuyru&gbreve;u <em>engellenmeyen, at-ve-unut</em> bir sistemdir. Kullan&inodot;c&inodot; &ldquo;Yazd&inodot;r&rdquo;a t&inodot;klad&inodot;&gbreve;&inodot;nda, API hemen bir i&#351; ID&rsquo;si ile d&ouml;ner &mdash; kullan&inodot;c&inodot; fiziksel yaz&inodot;c&inodot;y&inodot; beklemez. &#304;&#351;&ccedil;i bunu asenkron olarak i&#351;ler. Bu tasar&inodot;m, Hammadde Giri&#351;i&rsquo;nin yava&#351; veya &ccedil;evrimd&inodot;&#351;&inodot; yaz&inodot;c&inodot;larda asla engellenmemesi anlam&inodot;na gelir. &#304;zleme panosu bu asenkronlu&gbreve;un bir g&ouml;zlemlenebilirlik bo&#351;lu&gbreve;u yaratt&inodot;&gbreve;&inodot; i&ccedil;in vard&inodot;r: att&inodot;ktan ve unuttukuntan sonra ne oldu&gbreve;unu g&ouml;recek bir yere ihtiyac&inodot;n&inodot;z var. Malzeme verisinin i&#351; sat&inodot;r&inodot;na denormalizasyonu bilin&ccedil;li bir performans &ouml;d&uuml;n&uuml;d&uuml;r &mdash; izleme sayfas&inodot; 500 i&#351;le bile h&inodot;zl&inodot; y&uuml;klenir &ccedil;&uuml;nk&uuml; asla raw_materials veya suppliers&rsquo;a join yapmaz.</p>
        </div>

        <!-- ============================================ -->
        <!-- 6.3  AI AYARLARI                              -->
        <!-- ============================================ -->

        <h2 id="sec-6-3" style="margin-top: 48px;">6.3 AI Ayarlar&inodot; (AI Settings)</h2>

        <h3>6.3.1 Ama&ccedil; ve &#304;&#351; Ba&gbreve;lam&inodot;</h3>

        <p>ERP, &#351;u anda API entegrasyonu &uuml;zerinden Google Gemini taraf&inodot;ndan desteklenen (OpenAI ve Anthropic Claude tamamen entegre ve haz&inodot;r) bir AI asistan i&ccedil;erir. Asistan, kullan&inodot;c&inodot;lar ad&inodot;na dahili API&rsquo;leri &ccedil;a&gbreve;&inodot;rarak sipari&#351;ler, malzemeler, &uuml;retim ve envanter hakk&inodot;nda sorular&inodot; yan&inodot;tlayabilir. <strong>AI Ayarlar&inodot;</strong>, bu asistan&inodot;n yap&inodot;land&inodot;rma ve izleme merkezidir: API anahtar y&ouml;netimi, model se&ccedil;imi, parametre ayarlama, kullan&inodot;m istatistikleri ve her AI etkile&#351;iminin kapsaml&inodot; denetim izi.</p>

        <p>Mevcut API tabanl&inodot; entegrasyon bir <strong>h&inodot;zl&inodot; demo katman&inodot;d&inodot;r</strong> &mdash; uzun vadeli vizyon paralel olarak geli&#351;irken anl&inodot;k AI yetenekleri sa&gbreve;lar. Yol haritas&inodot;, t&uuml;m fabrika genelinde <strong>&ouml;zel, yerel olarak bar&inodot;nd&inodot;r&inodot;lan modeller</strong> in&#351;a etmek ve da&gbreve;&inodot;tmakt&inodot;r: &uuml;retim optimizasyonu, kalite kontrol, &ouml;ng&ouml;r&uuml;c&uuml; bak&inodot;m, anomali tespiti &mdash; esasen her &#351;eyi s&uuml;rekli izleyen ve kontrol eden g&ouml;r&uuml;nmez AI ajanlar&inodot;. Dil/arama bile&#351;eni i&ccedil;in &ouml;zellikle, ERP&rsquo;ye &ouml;zg&uuml; arama sorgusu anlamas&inodot; i&ccedil;in ince ayar yap&inodot;lm&inodot;&#351; hafif ~1B parametreli bir model (Qwen veya benzeri) kullan&inodot;lacak ve harici API ba&gbreve;&inodot;ml&inodot;l&inodot;&gbreve;&inodot; tamamen ortadan kald&inodot;r&inodot;lacakt&inodot;r. Bu ayarlar sayfas&inodot;ndaki &ccedil;oklu sa&gbreve;lay&inodot;c&inodot; mimarisi bu ge&ccedil;i&#351; g&ouml;z &ouml;n&uuml;nde bulundurularak tasarlanm&inodot;&#351;t&inodot;r &mdash; harici API&rsquo;den yerel model endpoint&rsquo;ine ge&ccedil;i&#351; bir yeniden yazma de&gbreve;il, konfig&uuml;rasyon de&gbreve;i&#351;ikli&gbreve;idir.</p>

        <p>AI ajan&inodot;n&inodot;n kendisi ana backend&rsquo;den ayr&inodot; bir serviste (<code>solen_ai_service</code>) ya&#351;ar. Bu alt mod&uuml;l <em>kontrol d&uuml;zlemi</em>ni sa&gbreve;lar &mdash; bir y&ouml;neticinin koda veya konfig&uuml;rasyon dosyalar&inodot;na dokunmadan AI&rsquo;y&inodot; y&ouml;netmesini sa&gbreve;layan d&uuml;&gbreve;meler ve panolar.</p>

        <h3>6.3.2 Veritaban&inodot; &#350;emas&inodot; &mdash; 47 S&uuml;tunlu Denetim G&uuml;nl&uuml;&gbreve;&uuml;</h3>

        <p>AI sistemi adli d&uuml;zeyde denetim g&uuml;nl&uuml;&gbreve;&uuml; i&ccedil;in iki tablo kullan&inodot;r:</p>

        <h4>ai_audit_logs (47 s&uuml;tun)</h4>
        <p>Her tekil AI etkile&#351;imi tam ba&gbreve;lamla kaydedilir. S&uuml;tunlar 8 gruba ayr&inodot;lm&inodot;&#351;t&inodot;r:</p>

        <table>
            <tr><th>Grup</th><th>S&uuml;tunlar</th><th>Ne Yakalar</th></tr>
            <tr><td><strong>Kimlik</strong> (10)</td><td>user_id, username, user_type, session_id, session_token, ip_address, user_agent, device_type, browser, os</td><td>Kim sordu, nereden, hangi cihazda</td></tr>
            <tr><td><strong>Sorgu</strong> (6)</td><td>original_query, query_language, query_length, query_type, query_category, detected_entities</td><td>Ne soruldu, s&inodot;n&inodot;fland&inodot;r&inodot;ld&inodot; ve ayr&inodot;&#351;t&inodot;r&inodot;ld&inodot; (&ouml;rn. <code>{"order_id": 377}</code>)</td></tr>
            <tr><td><strong>AI &#304;&#351;leme</strong> (9)</td><td>ai_model, ai_model_version, ai_preprocessing, ai_reasoning, ai_confidence, selected_tool, tool_params, tool_params_sanitized, alternative_tools</td><td>AI nas&inodot;l karar verdi, hangi arac&inodot; se&ccedil;ti, hangi alternatifleri d&uuml;&#351;&uuml;nd&uuml;</td></tr>
            <tr><td><strong>API &Ccedil;a&gbreve;r&inodot;s&inodot;</strong> (6)</td><td>api_endpoint, api_method, api_request_headers, api_response_status, api_response_data, api_response_size_bytes</td><td>AI&rsquo;n&inodot;n kullan&inodot;c&inodot; ad&inodot;na yapt&inodot;&gbreve;&inodot; dahili API &ccedil;a&gbreve;r&inodot;s&inodot;</td></tr>
            <tr><td><strong>Sonu&ccedil;</strong> (6)</td><td>success, error_type, error_message, error_stack, final_response, response_type</td><td>AI ne yan&inodot;tlad&inodot;, ba&#351;ar&inodot;l&inodot; m&inodot; oldu, de&gbreve;ilse hata detaylar&inodot;</td></tr>
            <tr><td><strong>Performans</strong> (4)</td><td>total_duration_ms, ai_processing_ms, api_call_ms, response_generation_ms</td><td>Zamanlama da&gbreve;&inodot;l&inodot;m&inodot;: AI d&uuml;&#351;&uuml;nme + API &ccedil;a&gbreve;r&inodot;s&inodot; + yan&inodot;t &uuml;retme</td></tr>
            <tr><td><strong>G&uuml;venlik</strong> (4)</td><td>security_flags, rate_limit_status, was_blocked, block_reason</td><td>Enjeksiyon tespiti, h&inodot;z s&inodot;n&inodot;rlama, engellenen sorgular</td></tr>
            <tr><td><strong>Meta</strong> (2)</td><td>created_at, metadata</td><td>Zaman damgas&inodot; ve geni&#351;letilebilir JSON meta verisi</td></tr>
        </table>

        <p>11 indeks sorgular&inodot; optimize eder: user_id, username, session_id, ip_address, selected_tool, success, created_at &uuml;zerinde tekli; (user_id, created_at), (selected_tool, created_at), (success, created_at), (ip_address, created_at) &uuml;zerinde bile&#351;ik.</p>

        <h4>ai_audit_log_summaries (12 s&uuml;tun)</h4>
        <p>G&uuml;nl&uuml;k toplu istatistikler: toplam/ba&#351;ar&inodot;l&inodot;/ba&#351;ar&inodot;s&inodot;z/engellenen sorgular, benzersiz kullan&inodot;c&inodot;lar ve IP&rsquo;ler, en &ccedil;ok kullan&inodot;lan ara&ccedil;lar, en &ccedil;ok kategori, ortalama yan&inodot;t s&uuml;releri, hata da&gbreve;&inodot;l&inodot;m&inodot;. G&uuml;nde bir sat&inodot;r. &#350;u anda API &uuml;zerinden sunulmuyor &mdash; gelecekteki analitik panolar&inodot; i&ccedil;in ayr&inodot;lm&inodot;&#351;.</p>

        <h3>6.3.3 API S&ouml;zle&#351;mesi &mdash; 12 Endpoint</h3>

        <table>
            <tr><th>Metot</th><th>Yol</th><th>Ne Yapar</th></tr>
            <tr><td><code>POST</code></td><td><code>/api/ai/chat</code></td><td>AI ajan&inodot;na sorgu g&ouml;nder. AI&rsquo;n&inodot;n etkin olup olmad&inodot;&gbreve;&inodot;n&inodot; kontrol eder. Yan&inodot;t, kullan&inodot;lan ara&ccedil;lar, zamanlama d&ouml;nd&uuml;r&uuml;r. Hatalar&inodot; kullan&inodot;c&inodot;dan gizler.</td></tr>
            <tr><td><code>GET</code></td><td><code>/api/ai/status</code></td><td>AI haz&inodot;rl&inodot;k durumunu kontrol et: API anahtar&inodot; yap&inodot;land&inodot;r&inodot;lm&inodot;&#351; m&inodot;, model ad&inodot;, ajan durumu (ready/error/not_initialized).</td></tr>
            <tr><td><code>GET</code></td><td><code>/api/ai/models</code></td><td>Sa&gbreve;lay&inodot;c&inodot;ya g&ouml;re gruplanm&inodot;&#351; mevcut modelleri listele: tier, a&ccedil;&inodot;klama, &ouml;nerilen bayra&gbreve;&inodot;, yak&inodot;nda bayra&gbreve;&inodot;.</td></tr>
            <tr><td><code>POST</code></td><td><code>/api/ai/reset</code></td><td>Mevcut ajan singleton&rsquo;&inodot;n&inodot; yok et. Sonraki istekte en son konfig&uuml;rasyonla yeniden ba&#351;lat&inodot;l&inodot;r.</td></tr>
            <tr><td><code>GET</code></td><td><code>/api/ai/config</code></td><td>Mevcut konfig&uuml;rasyonu al: enabled, model_name, max_tokens, temperature, anahtar durumu.</td></tr>
            <tr><td><code>POST</code></td><td><code>/api/ai/config</code></td><td>Konfig&uuml;rasyonu g&uuml;ncelle. K&inodot;smi g&uuml;ncellemeler desteklenir. <code>ai_config.json</code>&rsquo;a kaydeder.</td></tr>
            <tr><td><code>GET</code></td><td><code>/api/ai/stats</code></td><td>Denetim tablosundan kullan&inodot;m istatistikleri: toplam/ba&#351;ar&inodot;l&inodot;/ba&#351;ar&inodot;s&inodot;z sorgular, ort. yan&inodot;t s&uuml;resi, bug&uuml;nk&uuml; say&inodot;.</td></tr>
            <tr><td><code>GET</code></td><td><code>/api/ai/audit-logs</code></td><td>Sayfalanm&inodot;&#351; denetim g&uuml;nl&uuml;&gbreve;&uuml; kay&inodot;tlar&inodot;. Params: <code>?limit=100&amp;offset=0</code>.</td></tr>
            <tr><td><code>GET</code></td><td><code>/api/ai/api-keys/status</code></td><td>3 sa&gbreve;lay&inodot;c&inodot; anahtar&inodot;n&inodot;n durumu: yap&inodot;land&inodot;r&inodot;lm&inodot;&#351; bayra&gbreve;&inodot; + maskeli &ouml;nizleme (ilk 8 + &ldquo;...&rdquo; + son 4 karakter).</td></tr>
            <tr><td><code>POST</code></td><td><code>/api/ai/api-keys/save</code></td><td>Sa&gbreve;lay&inodot;c&inodot; i&ccedil;in API anahtar&inodot; kaydet. Uzunluk (&ge; 20) do&gbreve;rular, &ouml;nek kontrol eder (yaln&inodot;zca uyar&inodot;). <code>.env</code>&rsquo;ye yazar, &ccedil;al&inodot;&#351;ma zaman&inodot; ortam&inodot;n&inodot; g&uuml;nceller, ajan&inodot; s&inodot;f&inodot;rlar.</td></tr>
            <tr><td><code>DELETE</code></td><td><code>/api/ai/api-keys/{provider}</code></td><td><code>.env</code> ve &ccedil;al&inodot;&#351;ma zaman&inodot; ortam&inodot;ndan API anahtar&inodot;n&inodot; kald&inodot;r.</td></tr>
            <tr><td><code>POST</code></td><td><code>/api/ai/api-keys/test/{provider}</code></td><td>Anahtar ge&ccedil;erlili&gbreve;ini test et: Gemini istemci &ouml;rnekleme, OpenAI/Anthropic modeller endpoint&rsquo;i ile.</td></tr>
        </table>

        <h3>6.3.4 CRUD Ak&inodot;&#351;&inodot;</h3>

        <p><strong>Olu&#351;tur / G&uuml;ncelle (API Anahtar&inodot;):</strong></p>
        <ol>
            <li>&ldquo;API Anahtarlar&inodot;&rdquo; sekmesine git &rarr; 3 sa&gbreve;lay&inodot;c&inodot; kart&inodot; (Google Gemini, OpenAI, Anthropic Claude) her biri logo, durum etiketi ve &#351;ifre girdisi ile</li>
            <li>&#350;ifre alan&inodot;na API anahtar&inodot;n&inodot; gir &rarr; &ldquo;Kaydet&rdquo;e t&inodot;kla</li>
            <li><code>POST /api/ai/api-keys/save</code> ile <code>{ provider, api_key }</code></li>
            <li>Backend do&gbreve;rular: bo&#351; de&gbreve;il, &ge; 20 karakter, &ouml;nek kontrol (Gemini i&ccedil;in AIza, OpenAI i&ccedil;in sk-, Anthropic i&ccedil;in sk-ant- &mdash; yaln&inodot;zca uyar&inodot;, engelleme yok)</li>
            <li><code>solen_ai_service/.env</code> dosyas&inodot;na yazar, &ccedil;al&inodot;&#351;ma zaman&inodot; <code>os.environ</code>&rsquo;&inodot; g&uuml;nceller, AI ajan singleton&rsquo;&inodot;n&inodot; s&inodot;f&inodot;rlar</li>
            <li>Ba&#351;ar&inodot;da: toast &ldquo;API anahtar&inodot; kaydedildi&rdquo; + varsa &ouml;nek uyar&inodot;s&inodot; &rarr; kartta maskeli anahtar g&ouml;sterilir &rarr; durum yenilenir</li>
        </ol>

        <p><strong>Oku (Genel Bak&inodot;&#351; Panosu):</strong></p>
        <ol>
            <li>/admin/ai-settings sayfas&inodot;na git &rarr; &ldquo;Genel Bak&inodot;&#351;&rdquo; sekmesi y&uuml;klenir</li>
            <li>4 istatistik kart&inodot;: AI durumu (aktif/pasif), bug&uuml;nk&uuml; sorgular, toplam sorgular, ortalama yan&inodot;t s&uuml;resi</li>
            <li>Ba&#351;ar&inodot; oran&inodot; kart&inodot;: dairesel ilerleme grafi&gbreve;i + ba&#351;ar&inodot;l&inodot;/ba&#351;ar&inodot;s&inodot;z say&inodot;lar&inodot;</li>
            <li>Ba&gbreve;lant&inodot; test kart&inodot;: durum, API anahtar durumu, mevcut modeli g&ouml;sterir. &ldquo;Ba&gbreve;lant&inodot;y&inodot; Test Et&rdquo; butonu <code>GET /api/ai/status</code> &ccedil;a&gbreve;&inodot;r&inodot;r</li>
        </ol>

        <p><strong>Model Ayarlar&inodot;n&inodot; G&uuml;ncelle:</strong></p>
        <ol>
            <li>&ldquo;Model Ayarlar&inodot;&rdquo; sekmesine git</li>
            <li>4 alanl&inodot; form: AI etkin (switch), model (cascader: Sa&gbreve;lay&inodot;c&inodot; &rarr; Model, tier etiketleri ve &ouml;nerilen y&inodot;ld&inodot;zlar&inodot;yla), maks token (se&ccedil;im: 1024/2048/4096/8192), s&inodot;cakl&inodot;k (se&ccedil;im: 0.1/0.3/0.5/0.7/0.9)</li>
            <li>&ldquo;Ayarlar&inodot; Kaydet&rdquo;e t&inodot;kla</li>
            <li><code>POST /api/ai/config</code> &rarr; <code>ai_config.json</code>&rsquo;a kaydeder</li>
            <li><code>POST /api/ai/reset</code> &rarr; mevcut ajan&inodot; yok eder, sonraki sorguda yeni konfig&uuml;rasyonla yeniden ba&#351;lat&inodot;l&inodot;r</li>
            <li>Toast: &ldquo;Ayarlar kaydedildi - AI yeniden ba&#351;lat&inodot;ld&inodot;&rdquo;</li>
        </ol>

        <p><strong>API Anahtar&inodot; Sil:</strong></p>
        <ol>
            <li>Sa&gbreve;lay&inodot;c&inodot; kart&inodot;nda &ldquo;Sil&rdquo; butonuna t&inodot;kla</li>
            <li>Onay modal&inodot;</li>
            <li><code>DELETE /api/ai/api-keys/{provider}</code></li>
            <li>Backend anahtar&inodot; <code>.env</code> dosyas&inodot;ndan ve <code>os.environ</code>&rsquo;dan kald&inodot;r&inodot;r</li>
            <li>Toast: &ldquo;API anahtar&inodot; silindi&rdquo; &rarr; kart yap&inodot;land&inodot;r&inodot;lmam&inodot;&#351; duruma d&ouml;ner</li>
        </ol>

        <p><strong>API Anahtar&inodot; Test Et:</strong></p>
        <ol>
            <li>Yap&inodot;land&inodot;r&inodot;lm&inodot;&#351; sa&gbreve;lay&inodot;c&inodot; kart&inodot;nda &ldquo;Test Et&rdquo; butonuna t&inodot;kla</li>
            <li><code>POST /api/ai/api-keys/test/{provider}</code></li>
            <li>Backend test eder: Gemini istemci &ouml;rnekleme ile, OpenAI <code>GET https://api.openai.com/v1/models</code> ile, Anthropic <code>GET https://api.anthropic.com/v1/models</code> ile</li>
            <li>Ba&#351;ar&inodot; toast&rsquo;u veya detayl&inodot; hata toast&rsquo;u</li>
        </ol>

        <h3>6.3.5 AI Sa&gbreve;lay&inodot;c&inodot; Yap&inodot;land&inodot;rmas&inodot;</h3>

        <table>
            <tr><th>Sa&gbreve;lay&inodot;c&inodot;</th><th>Ortam De&gbreve;i&#351;keni</th><th>Anahtar &Ouml;neki</th><th>Modeller</th><th>Durum</th></tr>
            <tr><td><strong>Google Gemini</strong></td><td><code>GEMINI_API_KEY</code></td><td><code>AIza</code></td><td>gemini-3-flash (&ouml;nerilen), gemini-3-pro, gemini-2.5-flash, gemini-2.5-pro</td><td>Aktif</td></tr>
            <tr><td><strong>OpenAI</strong></td><td><code>OPENAI_API_KEY</code></td><td><code>sk-</code></td><td>gpt-5.2 (&ouml;nerilen), gpt-5-mini, o3, gpt-4.1</td><td>Aktif</td></tr>
            <tr><td><strong>Anthropic Claude</strong></td><td><code>ANTHROPIC_API_KEY</code></td><td><code>sk-ant-</code></td><td>claude-sonnet-4-5 (&ouml;nerilen), claude-opus-4-5, claude-haiku-4-5</td><td>Aktif</td></tr>
        </table>

        <h4>Anahtar Saklama Mimarisi</h4>
        <p>API anahtarlar&inodot; <code>solen_ai_service</code> dizinindeki <code>.env</code> dosyas&inodot;nda saklan&inodot;r (ana backend&rsquo;den ayr&inodot;). Veritaban&inodot;nda <strong>asla</strong> saklanmazlar. Kaydetme s&inodot;ras&inodot;nda anahtar, yeniden ba&#351;latma olmadan anl&inodot;k kullan&inodot;m i&ccedil;in <code>os.environ</code>&rsquo;da da ayarlan&inodot;r. Anahtarlar API yan&inodot;tlar&inodot;nda <strong>asla</strong> d&ouml;nd&uuml;r&uuml;lmez &mdash; yaln&inodot;zca maskeli &ouml;nizlemeler (ilk 8 + &ldquo;...&rdquo; + son 4 karakter).</p>

        <h4>Konfig&uuml;rasyon Saklama</h4>
        <p>Model ayarlar&inodot; (enabled, model_name, max_tokens, temperature) <code>.env</code> dosyas&inodot;n&inodot;n yan&inodot;ndaki <code>ai_config.json</code>&rsquo;da saklan&inodot;r. Varsay&inodot;lanlar: enabled=true, model=gemini-3-flash, max_tokens=4096, temperature=0.7.</p>

        <h3>6.3.6 AI Ajan&inodot; &mdash; Singleton Mimarisi</h3>

        <p>AI ajan&inodot; (<code>SolenAIAgent</code>) istekler aras&inodot;nda kal&inodot;c&inodot; bir singleton&rsquo;d&inodot;r. &#304;lk AI sorgusunda ba&#351;lat&inodot;l&inodot;r ve a&ccedil;&inodot;k&ccedil;a s&inodot;f&inodot;rlan&inodot;ncaya kadar yeniden kullan&inodot;l&inodot;r.</p>

        <div class="flow">
            <span class="flow-step">&#304;lk /ai/chat &ccedil;a&gbreve;r&inodot;s&inodot;</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">ai_config.json y&uuml;kle</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">SolenAIAgent(config) olu&#351;tur</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">_agent_instance&rsquo;da sakla</span>
        </div>

        <p>Ajan &#351;u durumlarda s&inodot;f&inodot;rlan&inodot;r (yok edilir ve yeniden olu&#351;turulur): API anahtarlar&inodot; kaydedildi&gbreve;inde/silindi&gbreve;inde, konfig&uuml;rasyon ayarlar sayfas&inodot; &uuml;zerinden g&uuml;ncellendi&gbreve;inde veya <code>POST /api/ai/reset</code> &ccedil;a&gbreve;r&inodot;ld&inodot;&gbreve;&inodot;nda. Bu, ajan&inodot;n her zaman en son konfig&uuml;rasyonu kullanmas&inodot;n&inodot; sa&gbreve;lar.</p>

        <h4>Sohbet &#304;stek Ak&inodot;&#351;&inodot;</h4>
        <ol>
            <li>Kullan&inodot;c&inodot; <code>POST /api/ai/chat</code> ile <code>{ query, conversation_history, user_type }</code> g&ouml;nderir</li>
            <li>Backend <code>ai_config.json</code>&rsquo;&inodot; kontrol eder &mdash; <code>enabled: false</code> ise &ldquo;AI servisi &#351;u an devre d&inodot;&#351;&inodot;&rdquo; d&ouml;nd&uuml;r&uuml;r</li>
            <li>Ajan singleton&rsquo;&inodot;n&inodot; al&inodot;r veya olu&#351;turur, JWT&rsquo;den kullan&inodot;c&inodot; bilgisini &ccedil;&inodot;kar&inodot;r</li>
            <li><code>agent.process_query(query, history, user_type, ip, username, user_id)</code> &ccedil;a&gbreve;&inodot;r&inodot;r</li>
            <li>Ajan dahili olarak: sorguyu &ouml;n i&#351;ler, ara&ccedil; se&ccedil;er, dahili API &ccedil;a&gbreve;&inodot;r&inodot;r, yan&inodot;t &uuml;retir, <strong>denetim g&uuml;nl&uuml;&gbreve;&uuml; yazar</strong></li>
            <li>Backend yan&inodot;t&inodot; temizler (ham API hatalar&inodot;n&inodot; gizler), <code>{ success, response, tool_used, timing_ms }</code> d&ouml;nd&uuml;r&uuml;r</li>
        </ol>

        <h3>6.3.7 Denetim G&uuml;nl&uuml;&gbreve;&uuml; &mdash; Adli D&uuml;zeyde &#304;zleme</h3>

        <p>Her AI etkile&#351;imi <code>ai_audit_logs</code>&rsquo;a 47 s&uuml;tun ba&gbreve;lamla bir sat&inodot;r yazar. Denetim g&uuml;nl&uuml;&gbreve;&uuml; her sorgu hakk&inodot;nda 7 soruyu yan&inodot;tlar:</p>

        <ol>
            <li><strong>Kim?</strong> &mdash; user_id, username, user_type, oturum bilgisi, IP, cihaz, taray&inodot;c&inodot;, i&#351;letim sistemi</li>
            <li><strong>Ne?</strong> &mdash; orijinal sorgu, dil, t&uuml;r (arama/soru/komut), kategori (sipari&#351;/malzeme/&uuml;retim), tespit edilen varl&inodot;klar</li>
            <li><strong>Nas&inodot;l?</strong> &mdash; AI model, ak&inodot;l y&uuml;r&uuml;tme, g&uuml;ven skoru, se&ccedil;ilen ara&ccedil;, ara&ccedil; parametreleri, de&gbreve;erlendirilen alternatif ara&ccedil;lar</li>
            <li><strong>Nereye?</strong> &mdash; &ccedil;a&gbreve;r&inodot;lan API endpoint&rsquo;i, metot, yan&inodot;t durumu, yan&inodot;t verisi, yan&inodot;t boyutu</li>
            <li><strong>Sonu&ccedil;?</strong> &mdash; ba&#351;ar&inodot;/ba&#351;ar&inodot;s&inodot;zl&inodot;k, hata t&uuml;r&uuml; ve mesaj&inodot;, son yan&inodot;t metni, yan&inodot;t t&uuml;r&uuml;</li>
            <li><strong>Performans?</strong> &mdash; toplam ms, AI i&#351;leme ms, API &ccedil;a&gbreve;r&inodot;s&inodot; ms, yan&inodot;t &uuml;retme ms</li>
            <li><strong>G&uuml;venlik?</strong> &mdash; enjeksiyon bayraklar&inodot;, h&inodot;z s&inodot;n&inodot;r&inodot; durumu, engelleme bayra&gbreve;&inodot; ve nedeni</li>
        </ol>

        <h3>6.3.8 Frontend Mimarisi</h3>

        <p>Tek dosya: <code>src/pages/Admin/AISettings/index.tsx</code> (1.177 sat&inodot;r). Rota: <code>/admin/ai-settings</code>.</p>

        <h4>4 Sekmeli D&uuml;zen</h4>
        <div class="arch-grid">
            <div class="arch-box">
                <h4>Sekme 1: Genel Bak&inodot;&#351;</h4>
                <p>4 istatistik kart&inodot; (AI durumu, bug&uuml;nk&uuml; sorgular, toplam sorgular, ort. yan&inodot;t s&uuml;resi). Ba&#351;ar&inodot; oran&inodot; dairesel ilerleme grafi&gbreve;i. Ba&gbreve;lant&inodot; test kart&inodot;: durum g&ouml;stergesi, API anahtar bayra&gbreve;&inodot; ve model ad&inodot;.</p>
            </div>
            <div class="arch-box">
                <h4>Sekme 2: API Anahtarlar&inodot;</h4>
                <p>3 sa&gbreve;lay&inodot;c&inodot; kart&inodot; (Gemini, OpenAI, Claude) her biri: sa&gbreve;lay&inodot;c&inodot; logosu, &ldquo;Aktif&rdquo; durum etiketi, maskeli anahtar g&ouml;r&uuml;nt&uuml;leme, &#351;ifre girdisi, kaydet/test/sil butonlar&inodot; ve sa&gbreve;lay&inodot;c&inodot;n&inodot;n API konsoluna ba&gbreve;lant&inodot; ile. Art&inodot; AI servis hesab&inodot; durum kart&inodot;.</p>
            </div>
            <div class="arch-box">
                <h4>Sekme 3: Model Ayarlar&inodot;</h4>
                <p>Form: etkin switch, model cascader (Sa&gbreve;lay&inodot;c&inodot; &rarr; Model, ikonlar, tier etiketleri, &ouml;nerilen y&inodot;ld&inodot;zlar, API anahtar yoksa devre d&inodot;&#351;&inodot;), maks token se&ccedil;imi (1024&ndash;8192), s&inodot;cakl&inodot;k se&ccedil;imi (0.1&ndash;0.9). Kaydet konfig g&uuml;ncelleme + ajan s&inodot;f&inodot;rlama tetikler.</p>
            </div>
            <div class="arch-box">
                <h4>Sekme 4: Kullan&inodot;m Ge&ccedil;mi&#351;i</h4>
                <p>Geni&#351;letilebilir sat&inodot;rl&inodot; ProTable. S&uuml;tunlar: zaman damgas&inodot;, kullan&inodot;c&inodot; ad&inodot; + user_type etiketi, kullan&inodot;lan ara&ccedil; (mavi etiket), durum (ba&#351;ar&inodot;/hata), yan&inodot;t s&uuml;resi (renk kodlu: ye&#351;il &lt; 500ms, turuncu 500&ndash;1000ms, k&inodot;rm&inodot;z&inodot; &gt; 1000ms), IP. Geni&#351;letilmi&#351; sat&inodot;r: sorgu, AI yan&inodot;t&inodot;, hata mesaj&inodot;. Arama, sayfalama (10/20/50), yo&gbreve;unluk kontrolleri.</p>
            </div>
        </div>

        <h3>6.3.9 Yetki Modeli</h3>

        <p>AI Ayarlar&inodot; manifest&rsquo;te gran&uuml;ler buton d&uuml;zeyinde yetkilere sahip de&gbreve;ildir. Eri&#351;im mod&uuml;l d&uuml;zeyinde <code>canAdmin</code> ile kontrol edilir &mdash; admin mod&uuml;l&uuml;ne eri&#351;imi olan herhangi bir kullan&inodot;c&inodot; AI Ayarlar&inodot;&rsquo;n&inodot; g&ouml;r&uuml;nt&uuml;leyebilir. Backend endpoint&rsquo;lerinde JWT kimlik do&gbreve;rulamas&inodot; &ouml;tesinde a&ccedil;&inodot;k yetki kontrol&uuml; yoktur.</p>

        <p>Bu bilin&ccedil;li bir tasar&inodot;m se&ccedil;imidir: AI konfig&uuml;rasyonu buton ba&#351;&inodot;na bir yetki de&gbreve;il, admin genelinde bir yetenek olarak kabul edilir. Pratikte yaln&inodot;zca super admin&rsquo;ler admin mod&uuml;l&uuml;ne eri&#351;ir.</p>

        <h3>6.3.10 AI Ayarlar&inodot; Sistemin Geri Kalan&inodot;na Nas&inodot;l Ba&gbreve;lan&inodot;r</h3>

        <div class="arch-grid">
            <div class="arch-box">
                <h4>&rarr; AI Ajan&inodot; (Harici Servis)</h4>
                <p>Ayarlar sayfas&inodot; <code>SolenAIAgent</code>&rsquo;&inodot; i&ccedil;eren harici <code>solen_ai_service</code>&rsquo;i yap&inodot;land&inodot;r&inodot;r. API anahtarlar&inodot;, model se&ccedil;imi ve parametreler ajan&inodot;n okudu&gbreve;u dosyalarda saklan&inodot;r. Ajan, backend&rsquo;e singleton olarak import edilir.</p>
            </div>
            <div class="arch-box">
                <h4>&rarr; AI Arama (Sorgu &Ouml;n &#304;&#351;leme)</h4>
                <p><code>ai_search_service.py</code> (256 sat&inodot;r) arama sorgular&inodot;n&inodot; &ouml;n i&#351;lemek i&ccedil;in Gemini kullan&inodot;r: T&uuml;rk&ccedil;e karakter d&uuml;zeltme, sorgu s&inodot;n&inodot;fland&inodot;rma, varl&inodot;k tespiti. AI kullan&inodot;lamazsa kural tabanl&inodot; i&#351;lemeye geri d&ouml;ner.</p>
            </div>
            <div class="arch-box">
                <h4>&rarr; T&uuml;m ERP Mod&uuml;lleri (AI Sohbet Yoluyla)</h4>
                <p>AI ajan&inodot; kullan&inodot;c&inodot;lar ad&inodot;na dahili API&rsquo;leri &ccedil;a&gbreve;&inodot;rabilir &mdash; sipari&#351;leri, malzemeleri, tedarik&ccedil;ileri, &uuml;retim verilerini sorgular. Her mod&uuml;lden veri <em>t&uuml;keten</em> ancak asla yazmayan salt okunur bir asistan.</p>
            </div>
            <div class="arch-box">
                <h4>&rarr; Denetim ve Uyumluluk</h4>
                <p>47 s&uuml;tunlu denetim g&uuml;nl&uuml;&gbreve;&uuml; her AI etkile&#351;iminin eksiksiz adli izini olu&#351;turur: kim ne sordu, AI nas&inodot;l i&#351;ledi, hangi API&rsquo;yi &ccedil;a&gbreve;&inodot;rd&inodot;, ne yan&inodot;tlad&inodot; ve ne kadar s&uuml;rd&uuml;. Bu hem hata ay&inodot;klamay&inodot; hem de g&uuml;venlik denetimini destekler.</p>
            </div>
        </div>

        <div class="discovery">
            <p style="margin-bottom: 0;"><strong>Mimari i&ccedil;g&ouml;r&uuml;:</strong> AI sistemi <em>kontrol d&uuml;zlemi / veri d&uuml;zlemi</em> ayr&inodot;m&inodot;n&inodot; izler. Kontrol d&uuml;zlemi (bu ayarlar sayfas&inodot;) konfig&uuml;rasyon, anahtarlar ve izlemeyi y&ouml;netir. Veri d&uuml;zlemi (harici <code>SolenAIAgent</code>) ger&ccedil;ek sorgu i&#351;lemeyi y&ouml;netir. Bu ayr&inodot;m, AI ajan&inodot;n&inodot;n ERP backend&rsquo;inden ba&gbreve;&inodot;ms&inodot;z olarak y&uuml;kseltilmesi, de&gbreve;i&#351;tirilmesi veya &ouml;l&ccedil;eklenmesi anlam&inodot;na gelir. 47 s&uuml;tunlu denetim g&uuml;nl&uuml;&gbreve;&uuml; bilin&ccedil;li olarak a&#351;&inodot;r&inodot; m&uuml;hendislenmi&#351;tir &mdash; temel g&uuml;nl&uuml;kleme i&ccedil;in gerekenden &ccedil;ok daha fazla ba&gbreve;lam yakalar, &ccedil;&uuml;nk&uuml; AI adli bili&#351;imi yaln&inodot;zca AI&rsquo;n&inodot;n <em>ne</em> yapt&inodot;&gbreve;&inodot;n&inodot; de&gbreve;il, o eylemi <em>neden</em> se&ccedil;ti&gbreve;ini ve hangi alternatifleri de&gbreve;erlendirdi&gbreve;ini anlamay&inodot; gerektirir. &Ccedil;oklu sa&gbreve;lay&inodot;c&inodot; mimarisi (3 sa&gbreve;lay&inodot;c&inodot;n&inodot;n tamam&inodot; &mdash; Gemini, OpenAI ve Claude &mdash; 30&rsquo;dan fazla modelle tamamen entegre) AI sa&gbreve;lay&inodot;c&inodot;s&inodot;n&inodot; de&gbreve;i&#351;tirmenin bir kod de&gbreve;i&#351;ikli&gbreve;i de&gbreve;il konfig&uuml;rasyon de&gbreve;i&#351;ikli&gbreve;i oldu&gbreve;u anlam&inodot;na gelir.</p>
        </div>

        <!-- ============================================ -->
        <!-- 6.4  KULLANICI YÖNETİMİ                      -->
        <!-- ============================================ -->

        <h2 id="sec-6-4" style="margin-top: 48px;">6.4 Kullan&inodot;c&inodot; Y&ouml;netimi (User Management)</h2>

        <h3>6.4.1 Ama&ccedil; ve &#304;&#351; Ba&gbreve;lam&inodot;</h3>

        <p>Kullan&inodot;c&inodot; Y&ouml;netimi, t&uuml;m ERP&rsquo;nin <strong>kimlik ve yetkilendirme omurgas&inodot;d&inodot;r</strong>. Di&gbreve;er t&uuml;m mod&uuml;ller &mdash; Hammadde, Teknik, Sipari&#351;, &Uuml;retim, Stok, Lab, Admin &mdash; iki soruyu yan&inodot;tlamak i&ccedil;in bu alt mod&uuml;le ba&gbreve;&inodot;ml&inodot;d&inodot;r: <em>&ldquo;Bu ki&#351;i kim?&rdquo;</em> (kimlik do&gbreve;rulama) ve <em>&ldquo;Ne yapmaya yetkili?&rdquo;</em> (yetkilendirme). Sistemdeki en karma&#351;&inodot;k alt mod&uuml;ld&uuml;r &ccedil;&uuml;nk&uuml; <strong>hibrit bir yetki modeli</strong> uygular: eski rol tabanl&inodot; eri&#351;imin &uuml;zerine katmanlanan, 8 mod&uuml;l, 26+ sayfa ve 200+ eylem &uuml;zerinde tek tek UI butonlar&inodot;na kadar g&ouml;r&uuml;n&uuml;rl&uuml;&gbreve;&uuml; kontrol eden gran&uuml;ler sayfa+buton yetki sistemi.</p>

        <p>Fabrikada &uuml;&ccedil; temel kullan&inodot;c&inodot; arketipi vard&inodot;r: <strong>S&uuml;per Admin</strong> (tam sistem kontrol&uuml;, masa&uuml;st&uuml;), <strong>Lab Kullan&inodot;c&inodot;s&inodot;</strong> (kalite testi, masa&uuml;st&uuml;) ve <strong>Operat&ouml;r</strong> (makine kullan&inodot;m&inodot;, mobil kiosk). Bunlar&inodot;n &ouml;tesinde sistem, her biri elle haz&inodot;rlanm&inodot;&#351; yetkilerle s&inodot;n&inodot;rs&inodot;z &ouml;zel kullan&inodot;c&inodot; tipini destekler.</p>

        <h3>6.4.2 Veritaban&inodot; &#350;emas&inodot; &mdash; 6 Tablo, Joined-Table Kal&inodot;t&inodot;m</h3>

        <h4>users (17 s&uuml;tun) &mdash; Temel Kimlik Tablosu</h4>
        <table>
            <tr><th>S&uuml;tun</th><th>Tip</th><th>Detay</th></tr>
            <tr><td><code>id</code></td><td>Integer PK</td><td>Otomatik artan, indeksli</td></tr>
            <tr><td><code>email</code></td><td>String(320)</td><td>Benzersiz, indeksli, bo&#351; olamaz</td></tr>
            <tr><td><code>hashed_password</code></td><td>String(1024)</td><td>bcrypt hash, bo&#351; olamaz</td></tr>
            <tr><td><code>is_active</code></td><td>Boolean</td><td>Varsay&inodot;lan True</td></tr>
            <tr><td><code>is_superuser</code></td><td>Boolean</td><td>Varsay&inodot;lan False (FastAPI-Users miras&inodot;)</td></tr>
            <tr><td><code>is_verified</code></td><td>Boolean</td><td>Varsay&inodot;lan False</td></tr>
            <tr><td><code>username</code></td><td>String(50)</td><td>Benzersiz, indeksli, bo&#351; olamaz</td></tr>
            <tr><td><code>user_type</code></td><td>String(50)</td><td><code>super_admin</code>, <code>lab_user</code>, <code>operator</code> veya &ouml;zel</td></tr>
            <tr><td><code>full_name</code></td><td>String(100)</td><td>G&ouml;r&uuml;nen ad</td></tr>
            <tr><td><code>status</code></td><td>String(20)</td><td><code>active</code> / <code>inactive</code> / <code>suspended</code></td></tr>
            <tr><td><code>last_login</code></td><td>DateTime</td><td>Her giri&#351;te g&uuml;ncellenir</td></tr>
            <tr><td><code>created_at</code></td><td>DateTime</td><td>UTC zaman damgas&inodot;</td></tr>
            <tr><td><code>updated_at</code></td><td>DateTime</td><td>De&gbreve;i&#351;iklikte otomatik g&uuml;ncellenir</td></tr>
            <tr><td><code>preferred_interface</code></td><td>String(20)</td><td><code>mobile</code> / <code>desktop</code> / <code>auto</code></td></tr>
            <tr><td><code>device_info</code></td><td>JSON</td><td>Son bilinen cihaz detaylar&inodot;</td></tr>
            <tr><td><code>permissions</code></td><td>Text</td><td><strong>JSON string</strong> &mdash; gran&uuml;ler yetki nesnesi (sayfalar + butonlar)</td></tr>
            <tr><td><code>force_password_change</code></td><td>Boolean</td><td>Varsay&inodot;lan False, &#351;ifre s&inodot;f&inodot;rlamada True olur</td></tr>
        </table>

        <h4>Joined-Table Kal&inodot;t&inodot;m &mdash; Uzant&inodot; Tablolar&inodot;</h4>
        <p>Her kullan&inodot;c&inodot; tipinin <code>user_id FK &rarr; users.id</code> (benzersiz, bire-bir) ile ba&gbreve;lanan &ouml;zel bir uzant&inodot; tablosu vard&inodot;r. Bunlar tipe &ouml;zg&uuml; meta verileri saklar:</p>

        <table>
            <tr><th>Tablo</th><th>Ek S&uuml;tunlar</th><th>Ama&ccedil;</th></tr>
            <tr><td><code>super_admins</code></td><td>admin_level (system/module/user), permissions (JSON liste), access_logs (JSON liste)</td><td>Admin hiyerar&#351;isi, eylem denetim izi</td></tr>
            <tr><td><code>lab_users</code></td><td>lab_department, certifications (JSON liste), test_specializations (JSON liste), shift_schedule (JSON dict)</td><td>Lab&rsquo;a &ouml;zg&uuml; yeterlilikler ve vardiyalar</td></tr>
            <tr><td><code>operators</code></td><td>assigned_machines (JSON liste), shift_schedule (JSON dict), skill_level (junior/senior/expert), certifications (JSON liste)</td><td>Makine atamalar&inodot; ve beceri takibi</td></tr>
        </table>

        <p>SQLAlchemy backref&rsquo;ler navigasyon sa&gbreve;lar: <code>user.super_admin_profile</code>, <code>user.lab_user_profile</code>, <code>user.operator_profile</code>.</p>

        <h4>user_sessions (11 s&uuml;tun)</h4>
        <table>
            <tr><th>S&uuml;tun</th><th>Tip</th><th>Detay</th></tr>
            <tr><td><code>id</code></td><td>Integer PK</td><td>Otomatik artan</td></tr>
            <tr><td><code>user_id</code></td><td>Integer FK</td><td><code>users.id</code>&rsquo;ye referans</td></tr>
            <tr><td><code>session_token</code></td><td>String(255)</td><td>Benzersiz, indeksli &mdash; JWT eri&#351;im token&rsquo;&inodot;</td></tr>
            <tr><td><code>refresh_token</code></td><td>String(255)</td><td>Benzersiz, indeksli</td></tr>
            <tr><td><code>login_time</code></td><td>DateTime</td><td>Oturum ne zaman ba&#351;lad&inodot;</td></tr>
            <tr><td><code>logout_time</code></td><td>DateTime</td><td>&Ccedil;&inodot;k&inodot;&#351;a kadar null</td></tr>
            <tr><td><code>expires_at</code></td><td>DateTime</td><td>Token s&uuml;re dolma zaman&inodot;</td></tr>
            <tr><td><code>ip_address</code></td><td>String(45)</td><td>IPv6 haz&inodot;r</td></tr>
            <tr><td><code>user_agent</code></td><td>Text</td><td>Taray&inodot;c&inodot;/cihaz string&rsquo;i</td></tr>
            <tr><td><code>device_type</code></td><td>String(20)</td><td><code>mobile</code> / <code>desktop</code> / <code>tablet</code></td></tr>
            <tr><td><code>status</code></td><td>String(20)</td><td><code>active</code> / <code>expired</code> / <code>terminated</code></td></tr>
        </table>

        <h4>user_roles (7 s&uuml;tun)</h4>
        <p>Yeniden kullan&inodot;labilir yetki &#351;ablonlar&inodot; (rol tan&inodot;mlar&inodot;). Her rol, kullan&inodot;c&inodot;lara h&inodot;zla uygulanabilen tam bir yetki JSON&rsquo;&inodot; saklar.</p>
        <table>
            <tr><th>S&uuml;tun</th><th>Tip</th><th>Detay</th></tr>
            <tr><td><code>id</code></td><td>Integer PK</td><td>Otomatik artan</td></tr>
            <tr><td><code>name</code></td><td>String(50)</td><td>Benzersiz, &ouml;rn. &ldquo;Lab Teknisyeni&rdquo;</td></tr>
            <tr><td><code>description</code></td><td>Text</td><td>Okunabilir rol a&ccedil;&inodot;klamas&inodot;</td></tr>
            <tr><td><code>permissions</code></td><td>Text</td><td>JSON string &mdash; tam yetki yap&inodot;s&inodot;</td></tr>
            <tr><td><code>is_system</code></td><td>Boolean</td><td>Sistem rolleri silinemez</td></tr>
            <tr><td><code>created_at</code></td><td>DateTime</td><td>UTC</td></tr>
            <tr><td><code>updated_at</code></td><td>DateTime</td><td>Otomatik g&uuml;ncellenir</td></tr>
        </table>

        <h4>user_activity_logs (11 s&uuml;tun)</h4>
        <p>Kullan&inodot;c&inodot;lar &uuml;zerindeki her y&ouml;netim eylemi i&ccedil;in denetim izi. <code>username</code> h&inodot;zl&inodot; okuma i&ccedil;in denormalize edilmi&#351;tir.</p>
        <table>
            <tr><th>S&uuml;tun</th><th>Tip</th><th>Detay</th></tr>
            <tr><td><code>user_id</code></td><td>Integer FK</td><td>Eylemi kim ger&ccedil;ekle&#351;tirdi</td></tr>
            <tr><td><code>username</code></td><td>String(50)</td><td>Denormalize</td></tr>
            <tr><td><code>action</code></td><td>String(50)</td><td><code>create_user</code>, <code>update_user</code>, <code>suspend_user</code>, <code>delete_user</code>, <code>reset_password</code></td></tr>
            <tr><td><code>module</code></td><td>String(50)</td><td>Her zaman <code>user_management</code></td></tr>
            <tr><td><code>target_type</code></td><td>String(50)</td><td>Her zaman <code>user</code></td></tr>
            <tr><td><code>target_id</code></td><td>Integer</td><td>Etkilenen kullan&inodot;c&inodot;n&inodot;n ID&rsquo;si</td></tr>
            <tr><td><code>details</code></td><td>Text</td><td>Ek ba&gbreve;lam i&ccedil;in JSON string</td></tr>
            <tr><td><code>ip_address</code></td><td>String(50)</td><td>&#304;stemci IP</td></tr>
            <tr><td><code>user_agent</code></td><td>Text</td><td>Taray&inodot;c&inodot; string&rsquo;i</td></tr>
            <tr><td><code>created_at</code></td><td>DateTime</td><td>Eylem ne zaman ger&ccedil;ekle&#351;ti</td></tr>
        </table>

        <h3>6.4.3 Kimlik Do&gbreve;rulama Sistemi &mdash; JWT Token&rsquo;lar ve Oturumlar</h3>

        <h4>Token Mimarisi</h4>
        <div class="flow">
            <span class="flow-step">Giri&#351; (kullan&inodot;c&inodot; ad&inodot; + &#351;ifre)</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">bcrypt do&gbreve;rulama</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">Eri&#351;im Token&rsquo;&inodot; &Uuml;ret (HS256)</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">Yenileme Token&rsquo;&inodot; &Uuml;ret</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">UserSession sat&inodot;r&inodot; olu&#351;tur</span>
        </div>

        <table>
            <tr><th>Token Tipi</th><th>S&uuml;re</th><th>Payload</th><th>Ama&ccedil;</th></tr>
            <tr><td><strong>Eri&#351;im Token&rsquo;&inodot;</strong></td><td>12 saat (varsay&inodot;lan)</td><td><code>sub</code> (user_id), <code>username</code>, <code>user_type</code>, <code>permissions</code>, <code>type: "access"</code></td><td>Her API iste&gbreve;ini <code>Authorization: Bearer</code> ba&#351;l&inodot;&gbreve;&inodot; ile do&gbreve;rula</td></tr>
            <tr><td><strong>Yenileme Token&rsquo;&inodot;</strong></td><td>7 g&uuml;n</td><td><code>sub</code> (user_id), <code>type: "refresh"</code>, <code>jti</code> (benzersiz token ID)</td><td>Yeniden giri&#351; yapmadan yeni eri&#351;im token&rsquo;&inodot; &uuml;ret</td></tr>
            <tr><td><strong>Operat&ouml;r Kiosk Token&rsquo;&inodot;</strong></td><td><strong>6 ay</strong></td><td>Eri&#351;im token&rsquo;&inodot; ile ayn&inodot;</td><td>Fabrika kiosk telefonlar&inodot; &mdash; s&inodot;k yeniden giri&#351;ten ka&ccedil;&inodot;n</td></tr>
        </table>

        <p>6 ayl&inodot;k token sabit kodlanm&inodot;&#351; bir kontrolle tetiklenir: <code>if user.username == 'operator'</code>. Bu bilin&ccedil;lidir &mdash; payla&#351;&inodot;lan <code>operator</code> hesab&inodot;, aylarca oturum a&ccedil;&inodot;k kalmas&inodot; gereken duvara monte telefonlarda kullan&inodot;l&inodot;r.</p>

        <h4>&#350;ifre Sistemi</h4>
        <table>
            <tr><th>&#304;&#351;lem</th><th>Uygulama</th></tr>
            <tr><td>Hashleme</td><td><code>passlib</code> ile <code>bcrypt</code> &#351;emas&inodot;. <code>CryptContext(schemes=["bcrypt"], deprecated="auto")</code></td></tr>
            <tr><td>Do&gbreve;rulama</td><td><code>pwd_context.verify(plain, hashed)</code> &mdash; sabit zamanl&inodot; kar&#351;&inodot;la&#351;t&inodot;rma</td></tr>
            <tr><td>Otomatik &Uuml;retim</td><td><code>secrets.choice()</code> ile <code>ascii_letters + digits + "!@#$%"</code>, 12 karakter</td></tr>
            <tr><td>Do&gbreve;rulama (Olu&#351;turma)</td><td>Min 8 karakter, b&uuml;y&uuml;k harf + k&uuml;&ccedil;&uuml;k harf + rakam i&ccedil;ermeli</td></tr>
            <tr><td>Do&gbreve;rulama (Giri&#351;)</td><td>Min 5 karakter (operat&ouml;r &#351;ifreleri i&ccedil;in &ouml;rn. <code>op123</code>)</td></tr>
        </table>

        <h4>U&ccedil;tan Uca Giri&#351; Ak&inodot;&#351;&inodot;</h4>
        <ol>
            <li>Kullan&inodot;c&inodot; <code>POST /auth/login</code>&rsquo;a kullan&inodot;c&inodot; ad&inodot; + &#351;ifre g&ouml;nderir</li>
            <li>Backend kullan&inodot;c&inodot;y&inodot; kullan&inodot;c&inodot; ad&inodot; <em>veya</em> e-posta ile sorgular (b&uuml;y&uuml;k/k&uuml;&ccedil;&uuml;k harf duyars&inodot;z)</li>
            <li><code>is_active == True</code> ve <code>status != "suspended"</code> kontrol eder</li>
            <li>&#350;ifreyi bcrypt ile do&gbreve;rular</li>
            <li><code>last_login</code> zaman damgas&inodot;n&inodot; g&uuml;nceller</li>
            <li><code>user_id</code>, <code>username</code>, <code>user_type</code>, <code>permissions</code> ile JWT payload olu&#351;turur</li>
            <li>Operat&ouml;r hesab&inodot;ysa: 6 ay s&uuml;re; de&gbreve;ilse 12 saat</li>
            <li><code>UserSession</code> sat&inodot;r&inodot; olu&#351;turur (session_token, refresh_token, cihaz bilgisi, IP, s&uuml;re)</li>
            <li><code>{ access_token, refresh_token, expires_in, user }</code> d&ouml;nd&uuml;r&uuml;r</li>
            <li>Frontend token&rsquo;lar&inodot; ve kullan&inodot;c&inodot;y&inodot; <code>localStorage</code>&rsquo;a kaydeder (anahtarlar: <code>solen_auth_token</code>, <code>solen_refresh_token</code>, <code>solen_current_user</code>)</li>
            <li>Operat&ouml;rler <code>/production</code>&rsquo;a, di&gbreve;erleri <code>/welcome</code>&rsquo;a y&ouml;nlendirilir</li>
        </ol>

        <h4>Kiosk Otomatik Giri&#351;</h4>
        <p>Giri&#351; sayfas&inodot; fabrika kiosk cihazlar&inodot;n&inodot; iki &#351;ekilde alg&inodot;lar:</p>
        <ol>
            <li><strong>User-Agent alg&inodot;lama:</strong> taray&inodot;c&inodot; user-agent string&rsquo;inde &ldquo;FullyKiosk&rdquo; kontrol&uuml; (Fully Kiosk Browser fabrika telefonlar&inodot;nda &ccedil;al&inodot;&#351;an uygulamad&inodot;r)</li>
            <li><strong>Gizli URL token&rsquo;&inodot;:</strong> URL&rsquo;de <code>?kiosk=SOLEN_FACTORY_2024_KIOSK_SECRET</code> kontrol&uuml;</li>
        </ol>
        <p>E&#351;le&#351;me olursa sayfa otomatik olarak <code>operator</code> / <code>op123</code> ile giri&#351; yapar ve <code>/production</code>&rsquo;a y&ouml;nlendirir &mdash; insan etkile&#351;imi gerekmez.</p>

        <h4>Token Yenileme ve &Ccedil;&inodot;k&inodot;&#351;</h4>
        <ol>
            <li><strong>Yenileme:</strong> <code>POST /auth/refresh</code> ile yenileme token&rsquo;&inodot; &rarr; do&gbreve;rular, yeni eri&#351;im token&rsquo;&inodot; &uuml;retir, yeni oturum <em>olu&#351;turmaz</em></li>
            <li><strong>&Ccedil;&inodot;k&inodot;&#351;:</strong> <code>POST /auth/logout</code> ile eri&#351;im token&rsquo;&inodot; &rarr; oturum <code>status = "terminated"</code> ve <code>logout_time</code> ayarlan&inodot;r &rarr; frontend <code>localStorage</code>&rsquo;&inodot; temizler</li>
        </ol>

        <h3>6.4.4 Yetki Sistemi &mdash; En Karma&#351;&inodot;k B&ouml;l&uuml;m</h3>

        <p>Yetkilendirme sistemi, rota d&uuml;zeyinden tek tek buton g&ouml;r&uuml;n&uuml;rl&uuml;&gbreve;&uuml;ne kadar eri&#351;imi kontrol eden <strong>5 katmanl&inodot; bir mimari</strong>dir:</p>

        <div class="flow">
            <span class="flow-step">Katman 1: Yetki Manifesti (statik tan&inodot;m)</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">Katman 2: Buton Kay&inodot;t Defteri (dinamik &ccedil;al&inodot;&#351;ma zaman&inodot;)</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">Katman 3: Eri&#351;im Kontrol&uuml; (rota korumalar&inodot;)</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">Katman 4: Yetki Yard&inodot;mc&inodot;lar&inodot; (bile&#351;en d&uuml;zeyi)</span>
            <span class="flow-arrow">&rarr;</span>
            <span class="flow-step">Katman 5: Backend Zorlama (API d&uuml;zeyi)</span>
        </div>

        <h4>Katman 1: Yetki Manifesti (<code>permissionManifest.ts</code>, 565 sat&inodot;r)</h4>

        <p>T&uuml;m ERP&rsquo;deki <strong>her yetkilendirilebilir eylemin</strong> statik, merkezi tan&inodot;m&inodot;. Mod&uuml;l &rarr; Sayfa &rarr; Buton hiyerar&#351;isi:</p>

        <table>
            <tr><th>Mod&uuml;l</th><th>Sayfalar</th><th>Toplam Buton</th><th>&Ouml;ne &Ccedil;&inodot;kanlar</th></tr>
            <tr><td><strong>Dashboard</strong></td><td>1 (Ana)</td><td>3</td><td>access_page, view_stats, view_charts</td></tr>
            <tr><td><strong>Hammadde</strong></td><td>3 (Giri&#351;, Liste, Tedarik&ccedil;i)</td><td>30</td><td>Giri&#351; formlar&inodot; i&ccedil;in 12, liste i&ccedil;in 11 (hard_delete dahil), tedarik&ccedil;iler i&ccedil;in 7</td></tr>
            <tr><td><strong>Lab</strong></td><td>2 (Panel, Test)</td><td>5</td><td>Lab eri&#351;imi, test y&ouml;netimi</td></tr>
            <tr><td><strong>Teknik</strong></td><td>6 (Panel, Kablo Tasar&inodot;m, Makine, Standart, Kablo DB, Markalama)</td><td>32</td><td>Tek ba&#351;&inodot;na Kablo Playground i&ccedil;in 11</td></tr>
            <tr><td><strong>Sipari&#351;</strong></td><td>3 (Sipari&#351;lerim, Olu&#351;tur, M&uuml;&#351;teri)</td><td>17</td><td>Sipari&#351; CRUD, m&uuml;&#351;teri y&ouml;netimi</td></tr>
            <tr><td><strong>&Uuml;retim</strong></td><td>12 (Planlama, 6 makine, Aktarma, Paletleme, Sevkiyat, Liste, Ge&ccedil;mi&#351;)</td><td>~40</td><td>Makine tipi ba&#351;&inodot;na &uuml;retim ba&#351;lat/durdur, planlama, sevkiyat</td></tr>
            <tr><td><strong>Stok</strong></td><td>3 (&Uuml;r&uuml;n, Hammadde, Projeksiyon)</td><td>14</td><td>G&ouml;r&uuml;nt&uuml;le, d&inodot;&#351;a aktar, filtrele, stok ayarla</td></tr>
            <tr><td><strong>Admin</strong></td><td>3 (Yazd&inodot;rma &#304;zleme, Yaz&inodot;c&inodot;, Kullan&inodot;c&inodot;)</td><td>22</td><td>Kullan&inodot;c&inodot; Y&ouml;netimi i&ccedil;in 9 (manage_permissions dahil)</td></tr>
        </table>

        <p><strong>Toplam: 8 mod&uuml;l, 26+ sayfa, 200+ buton.</strong></p>

        <p>Her butonun meta verisi vard&inodot;r:</p>
        <pre><span class="keyword">interface</span> <span class="string">ButtonPermission</span> {
  id: <span class="keyword">string</span>;       <span class="comment">// &ouml;rn. "hard_delete_material"</span>
  label: <span class="keyword">string</span>;    <span class="comment">// &ouml;rn. "Kal&inodot;c&inodot; Silme"</span>
  description: <span class="keyword">string</span>; <span class="comment">// &ouml;rn. "Malzemeyi veritaban&inodot;ndan tamamen siler"</span>
  critical?: <span class="keyword">boolean</span>; <span class="comment">// true = yetki d&uuml;zenleyicide k&inodot;rm&inodot;z&inodot; vurgulanm&inodot;&#351;</span>
}</pre>

        <p>Manifest ayr&inodot;ca yard&inodot;mc&inodot; fonksiyonlar da export eder: <code>createEmptyPermissions()</code> (t&uuml;m&uuml; false), <code>createFullPermissions()</code> (t&uuml;m&uuml; true), <code>getAllPages()</code>, <code>getAllButtons()</code>.</p>

        <h4>Katman 2: Buton Kay&inodot;t Defteri (<code>buttonRegistry.ts</code>, 130 sat&inodot;r)</h4>

        <p>Statik manifeste dinamik bir tamamlay&inodot;c&inodot;. Bile&#351;enler &ccedil;al&inodot;&#351;ma zaman&inodot;nda <code>registerPageButtons()</code> ile butonlar&inodot;n&inodot; kaydedebilir. <code>buildCompleteManifest()</code> fonksiyonu statik manifest sayfalar&inodot;n&inodot; dinamik kay&inodot;t defteri butonlar&inodot;yla birle&#351;tirir. Bu, yeni sayfalar&inodot;n merkezi manifest dosyas&inodot;n&inodot; de&gbreve;i&#351;tirmeden yetkilerini kendilerinin kaydetmesine olanak tan&inodot;r.</p>

        <h4>Katman 3: Eri&#351;im Kontrol&uuml; &mdash; Rota Korumalar&inodot; (<code>access.ts</code>, 93 sat&inodot;r)</h4>

        <p>Her rota de&gbreve;i&#351;ikli&gbreve;inde &ccedil;al&inodot;&#351;&inodot;r. Mevcut kullan&inodot;c&inodot;n&inodot;n <code>permissions</code> JSON&rsquo;&inodot;n&inodot; ayr&inodot;&#351;t&inodot;r&inodot;r ve <code>routes.ts</code> taraf&inodot;ndan t&uuml;ketilen boolean bayraklar d&ouml;nd&uuml;r&uuml;r:</p>

        <pre><span class="keyword">return</span> {
  canAdmin: canAccessModule(<span class="string">'admin'</span>),     <span class="comment">// /admin/* rotalar&inodot;n&inodot; korur</span>
  canLab: canAccessModule(<span class="string">'lab'</span>),         <span class="comment">// /lab/* rotalar&inodot;n&inodot; korur</span>
  canProduction: canAccessModule(<span class="string">'production'</span>),
  canHammadde: canAccessModule(<span class="string">'hammadde'</span>),
  canTeknik: canAccessModule(<span class="string">'teknik'</span>),
  canSiparis: canAccessModule(<span class="string">'siparis'</span>),
  canStok: canAccessModule(<span class="string">'stok'</span>),
  canDashboard: canAccessModule(<span class="string">'dashboard'</span>),
  <span class="comment">// ... art&inodot; alt sayfa korumalar&inodot;</span>
};</pre>

        <p><code>canAccessModule(prefix)</code>, o mod&uuml;l alt&inodot;ndaki <em>herhangi bir</em> sayfa <code>access: true</code> ise true d&ouml;nd&uuml;r&uuml;r. Rotalar bunlar&inodot; koruma olarak kullan&inodot;r: rota konfig&uuml;rasyonunda <code>access: 'canAdmin'</code>.</p>

        <h4>Katman 4: Yetki Yard&inodot;mc&inodot;lar&inodot; &mdash; Bile&#351;en D&uuml;zeyi (<code>permissions.ts</code>, 145 sat&inodot;r)</h4>

        <p>Tek tek bile&#351;enler i&ccedil;in ince ayar kontrolleri sa&gbreve;lar:</p>
        <ul>
            <li><code>canAccessModule(module)</code> &mdash; mod&uuml;l etkin mi?</li>
            <li><code>canPerformAction(module, action)</code> &mdash; belirli eylem izinli mi?</li>
            <li><code>hasSpecialPermission(permission)</code> &mdash; &ouml;rn. <code>hard_delete</code></li>
        </ul>

        <p>Ayr&inodot;ca React sar&inodot;c&inodot; bile&#351;enleri export eder:</p>
        <ul>
            <li><code>&lt;PermissionButton module="hammadde" action="delete"&gt;</code> &mdash; yetkiye g&ouml;re butonu g&ouml;ster/gizle</li>
            <li><code>&lt;PermissionGuard module="admin" action="manage"&gt;</code> &mdash; herhangi bir bile&#351;eni yetki kontrol&uuml;yle sar, reddedilirse fallback g&ouml;ster</li>
        </ul>

        <h4>Katman 5: Backend Zorlama (<code>permission_checker.py</code>, 200 sat&inodot;r)</h4>

        <p>Sunucu taraf&inodot; aynas&inodot;. Bir kullan&inodot;c&inodot; frontend&rsquo;i atlasa bile backend yetkileri zorlar:</p>

        <table>
            <tr><th>Fonksiyon</th><th>Ne Kontrol Eder</th></tr>
            <tr><td><code>check_user_permission(user, page_id, button_id)</code></td><td>Kullan&inodot;c&inodot;n&inodot;n <code>permissions</code> JSON&rsquo;&inodot;n&inodot; ayr&inodot;&#351;t&inodot;r&inodot;r, <code>pages[page_id].access</code> ve <code>pages[page_id].buttons[button_id]</code> kontrol eder</td></tr>
            <tr><td><code>has_special_permission(user, permission)</code></td><td><code>special_permissions[permission]</code> kontrol eder</td></tr>
            <tr><td><code>is_permitted_user(user, required_types)</code></td><td>Eski rol tabanl&inodot; kontrol + gran&uuml;ler geri d&ouml;n&uuml;&#351;</td></tr>
            <tr><td><code>check_permission_smart(user, types, page, button)</code></td><td><strong>Hibrit</strong>: &ouml;nce eski rol kontrol&uuml;, sonra gran&uuml;ler, sonra nazik geri d&ouml;n&uuml;&#351;. Geriye uyumlu.</td></tr>
            <tr><td><code>require_permission(page_id, button_id)</code></td><td>Yetki reddedilirse 403 f&inodot;rlatan bir FastAPI dependency d&ouml;nd&uuml;r&uuml;r</td></tr>
        </table>

        <p><strong>S&uuml;per admin atlama:</strong> Her yetki fonksiyonu &ouml;nce <code>user.user_type == "super_admin"</code> kontrol eder ve hemen <code>True</code> d&ouml;nd&uuml;r&uuml;r.</p>

        <h4>Yetki JSON Yap&inodot;s&inodot;</h4>
        <p><code>users.permissions</code> s&uuml;tununda JSON string olarak saklan&inodot;r. Frontend ve backend aras&inodot;ndaki s&ouml;zle&#351;me:</p>

        <pre>{
  <span class="string">"pages"</span>: {
    <span class="string">"hammadde.hammadde_girisi"</span>: {
      <span class="string">"access"</span>: <span class="keyword">true</span>,
      <span class="string">"buttons"</span>: {
        <span class="string">"add_copper"</span>: <span class="keyword">true</span>,
        <span class="string">"add_tin"</span>: <span class="keyword">false</span>,
        <span class="string">"submit_form"</span>: <span class="keyword">true</span>,
        <span class="string">"print_qr"</span>: <span class="keyword">true</span>
      }
    },
    <span class="string">"production.planning"</span>: {
      <span class="string">"access"</span>: <span class="keyword">false</span>,
      <span class="string">"buttons"</span>: {}
    }
  }
}</pre>

        <h3>6.4.5 API S&ouml;zle&#351;mesi &mdash; 14 Endpoint (9 Kullan&inodot;c&inodot; Y&ouml;netimi + 5 Auth)</h3>

        <h4>Kimlik Do&gbreve;rulama Endpoint&rsquo;leri (5)</h4>
        <table>
            <tr><th>Metot</th><th>Yol</th><th>Ne Yapar</th></tr>
            <tr><td><code>POST</code></td><td><code>/auth/login</code></td><td>Kullan&inodot;c&inodot; ad&inodot;/&#351;ifre ile do&gbreve;rula. Eri&#351;im + yenileme token&rsquo;lar&inodot; ve kullan&inodot;c&inodot; nesnesi d&ouml;nd&uuml;r&uuml;r.</td></tr>
            <tr><td><code>POST</code></td><td><code>/auth/logout</code></td><td>Oturumu sonland&inodot;r. Oturum durumunu &ldquo;terminated&rdquo; yapar ve &ccedil;&inodot;k&inodot;&#351; zaman&inodot;n&inodot; kaydeder.</td></tr>
            <tr><td><code>POST</code></td><td><code>/auth/refresh</code></td><td>Yenileme token&rsquo;&inodot;n&inodot; yeni eri&#351;im token&rsquo;&inodot; ile de&gbreve;i&#351;tir. Yeni oturum olu&#351;turmaz.</td></tr>
            <tr><td><code>GET</code></td><td><code>/auth/me</code></td><td>Token&rsquo;dan mevcut kullan&inodot;c&inodot; bilgisini al. Frontend&rsquo;in sayfa yenilemede durumu geri y&uuml;klemesi i&ccedil;in.</td></tr>
            <tr><td><code>GET</code></td><td><code>/auth/health</code></td><td>Auth servisi sa&gbreve;l&inodot;k kontrol&uuml;: veritaban&inodot; ba&gbreve;lant&inodot;s&inodot;, versiyon, &ccedil;al&inodot;&#351;ma s&uuml;resi.</td></tr>
        </table>

        <h4>Kullan&inodot;c&inodot; Y&ouml;netimi Endpoint&rsquo;leri (9)</h4>
        <table>
            <tr><th>Metot</th><th>Yol</th><th>Yetki</th><th>Ne Yapar</th></tr>
            <tr><td><code>GET</code></td><td><code>/user-management/users/list</code></td><td>super_admin</td><td>T&uuml;m kullan&inodot;c&inodot;lar&inodot; listele. <code>?status_filter</code> ve <code>?user_type</code> sorgu parametrelerini destekler. Yetki JSON&rsquo;&inodot;n&inodot; ayr&inodot;&#351;t&inodot;r&inodot;r.</td></tr>
            <tr><td><code>GET</code></td><td><code>/user-management/operators</code></td><td>herhangi do&gbreve;rulanm&inodot;&#351;</td><td>Aktif kullan&inodot;c&inodot;lar&inodot; listele (di&gbreve;er mod&uuml;llerdeki operat&ouml;r dropdown&rsquo;lar&inodot; i&ccedil;in). Yaln&inodot;zca id, username, full_name d&ouml;nd&uuml;r&uuml;r.</td></tr>
            <tr><td><code>POST</code></td><td><code>/user-management/users/create</code></td><td>super_admin</td><td>Kullan&inodot;c&inodot; olu&#351;tur. Kullan&inodot;c&inodot; ad&inodot;/e-posta benzersizli&gbreve;ini do&gbreve;rular. Verilmezse &#351;ifre otomatik &uuml;retir. Yetki JSON&rsquo;&inodot;n&inodot; saklar. Aktivite kaydeder.</td></tr>
            <tr><td><code>PUT</code></td><td><code>/user-management/users/{id}</code></td><td>super_admin</td><td>Kullan&inodot;c&inodot; alanlar&inodot;n&inodot; g&uuml;ncelle (kullan&inodot;c&inodot; ad&inodot;, e-posta, ad, tip, durum, yetkiler, &#351;ifre). Aktivite kaydeder.</td></tr>
            <tr><td><code>POST</code></td><td><code>/user-management/users/{id}/suspend</code></td><td>super_admin</td><td><code>active</code> ve <code>suspended</code> aras&inodot;nda ge&ccedil;i&#351; yap. Aktivite kaydeder.</td></tr>
            <tr><td><code>DELETE</code></td><td><code>/user-management/users/{id}</code></td><td>super_admin</td><td>Kullan&inodot;c&inodot;y&inodot; kal&inodot;c&inodot; olarak sil. Kendini silme engellenir (400). Aktivite kaydeder.</td></tr>
            <tr><td><code>POST</code></td><td><code>/user-management/users/{id}/reset-password</code></td><td>super_admin</td><td>Yeni 12 karakterlik &#351;ifre &uuml;ret. <code>force_password_change = True</code> ayarlar. &#350;ifreyi d&ouml;nd&uuml;r&uuml;r (tek seferlik). Aktivite kaydeder.</td></tr>
            <tr><td><code>GET</code></td><td><code>/user-management/roles/list</code></td><td>super_admin</td><td>T&uuml;m rol &#351;ablonlar&inodot;n&inodot; ayr&inodot;&#351;t&inodot;r&inodot;lm&inodot;&#351; yetkilerle listele.</td></tr>
            <tr><td><code>GET</code></td><td><code>/user-management/activity-logs</code></td><td>super_admin</td><td>Aktivite g&uuml;nl&uuml;klerini sorgula. <code>?user_id</code>, <code>?module</code>, <code>?action</code>, <code>?limit</code> filtrelerini destekler.</td></tr>
        </table>

        <h3>6.4.6 CRUD Ak&inodot;&#351;&inodot;</h3>

        <p><strong>Olu&#351;tur (Yeni Kullan&inodot;c&inodot;):</strong></p>
        <ol>
            <li>&ldquo;Yeni Kullan&inodot;c&inodot;&rdquo; butonuna t&inodot;kla &rarr; 3 sekmeli modal a&ccedil;&inodot;l&inodot;r</li>
            <li><strong>Sekme 1 &ndash; Temel Bilgiler:</strong> kullan&inodot;c&inodot; ad&inodot; (gerekli, alfan&uuml;merik + alt &ccedil;izgi), e-posta (do&gbreve;rulanm&inodot;&#351;), tam ad, &#351;ifre (iste&gbreve;e ba&gbreve;l&inodot; &mdash; bo&#351;sa otomatik &uuml;retilir), kullan&inodot;c&inodot; tipi (se&ccedil; veya sat&inodot;r i&ccedil;i &ouml;zel tip olu&#351;tur), durum, &#351;ifre de&gbreve;i&#351;tirme zorunlu onay kutusu</li>
            <li><strong>Sekme 2 &ndash; Yetkiler:</strong> yetki d&uuml;zenleyici &mdash; &uuml;stte 4 h&inodot;zl&inodot; &#351;ablon (&ldquo;T&uuml;m Yetkiler&rdquo;, &ldquo;Hi&ccedil;biri&rdquo;, &ldquo;Operat&ouml;r Varsay&inodot;lan&rdquo;, &ldquo;Lab User Varsay&inodot;lan&rdquo;), ard&inodot;ndan kayd&inodot;r&inodot;labilir mod&uuml;l listesi. Her mod&uuml;l sayfalar&inodot; g&ouml;sterir, her sayfada: eri&#351;im switch&rsquo;i, &ldquo;T&uuml;m&uuml;&rdquo;/&ldquo;Hi&ccedil;biri&rdquo; h&inodot;zl&inodot; ge&ccedil;i&#351;ler, tek tek buton onay kutular&inodot;. Kritik butonlar k&inodot;rm&inodot;z&inodot; vurgulan&inodot;r. Bir butonu etkinle&#351;tirmek sayfan&inodot;n eri&#351;imini otomatik etkinle&#351;tirir. Sayfa eri&#351;imini kapatmak t&uuml;m butonlar&inodot;n&inodot; kapat&inodot;r.</li>
            <li><strong>Sekme 3 &ndash; &Ouml;nizleme:</strong> salt okunur &ouml;zet, eri&#351;ilebilir mod&uuml;ller &rarr; sayfalar &rarr; etkin butonlar&inodot; renk kodlu etiketlerle g&ouml;sterir</li>
            <li>&ldquo;Olu&#351;tur&rdquo;a t&inodot;kla &rarr; <code>POST /user-management/users/create</code> ile <code>{ username, email, full_name, user_type, status, permissions, force_password_change, return_password: true }</code></li>
            <li>Backend benzersizli&gbreve;i do&gbreve;rular (kullan&inodot;c&inodot; ad&inodot;, e-posta), &#351;ifreyi bcrypt ile hashler, kullan&inodot;c&inodot; + yetki JSON&rsquo;&inodot;n&inodot; saklar, aktivite kaydeder</li>
            <li>&#350;ifre otomatik &uuml;retildiyse: modal &uuml;retilen &#351;ifreyi &ldquo;Bu &#351;ifreyi not edin, tekrar g&ouml;sterilmeyecektir&rdquo; uyar&inodot;s&inodot;yla g&ouml;sterir</li>
        </ol>

        <p><strong>Oku (Kullan&inodot;c&inodot; Listesi):</strong></p>
        <ol>
            <li><code>/admin/user-management</code>&rsquo;a git &rarr; ProTable <code>GET /user-management/users/list</code> ile y&uuml;klenir</li>
            <li>7 s&uuml;tun: ID (sabit sol), Kullan&inodot;c&inodot; (kullan&inodot;c&inodot; ad&inodot; + tam ad), E-posta, Tip (renkli etiket), Durum (renkli etiket), Son Giri&#351; (UTC &rarr; Istanbul), &#304;&#351;lemler (sabit sa&gbreve;)</li>
            <li>&#304;stemci taraf&inodot; arama kullan&inodot;c&inodot; ad&inodot;, e-posta, tam ad, kullan&inodot;c&inodot; tipi ve durum &uuml;zerinde ayn&inodot; anda filtreler</li>
            <li>Sayfalama: sayfa ba&#351;&inodot;na 10/20/50/100</li>
            <li>ProTable yo&gbreve;unluk ve s&uuml;tun ayarlar&inodot; kontrolleri</li>
        </ol>

        <p><strong>G&uuml;ncelle (Kullan&inodot;c&inodot; D&uuml;zenle):</strong></p>
        <ol>
            <li>Kullan&inodot;c&inodot; sat&inodot;r&inodot;ndaki d&uuml;zenle ikonuna (EditOutlined) t&inodot;kla &rarr; ayn&inodot; 3 sekmeli modal a&ccedil;&inodot;l&inodot;r, kullan&inodot;c&inodot; verileriyle doldurulmu&#351;</li>
            <li>Mevcut yetkiler y&uuml;klenir ve ayr&inodot;&#351;t&inodot;r&inodot;l&inodot;r (string JSON &rarr; nesne d&ouml;n&uuml;&#351;&uuml;m&uuml;n&uuml; y&ouml;netir)</li>
            <li>&#350;ifre alan&inodot; d&uuml;zenleme modunda gizlidir (bunun i&ccedil;in &#350;ifre S&inodot;f&inodot;rla kullan&inodot;n)</li>
            <li>Herhangi bir alan veya yetkiyi de&gbreve;i&#351;tir &rarr; &ldquo;G&uuml;ncelle&rdquo;ye t&inodot;kla</li>
            <li><code>PUT /user-management/users/{id}</code> ile de&gbreve;i&#351;en alanlar + tam yetki nesnesi</li>
            <li>Backend do&gbreve;rular, g&uuml;nceller, aktivite kaydeder</li>
        </ol>

        <p><strong>Sil (Kal&inodot;c&inodot;):</strong></p>
        <ol>
            <li>Kullan&inodot;c&inodot; sat&inodot;r&inodot;ndaki sil ikonuna (DeleteOutlined, tehlike) t&inodot;kla</li>
            <li>Onay modal&inodot;: &ldquo;Bu kullan&inodot;c&inodot;y&inodot; silmek istedi&gbreve;inizden emin misiniz?&rdquo;</li>
            <li><code>DELETE /user-management/users/{id}</code></li>
            <li>Backend kendini silmeyi engeller (400 hatas&inodot;). Kullan&inodot;c&inodot; kayd&inodot;n&inodot; kal&inodot;c&inodot; olarak siler. Aktivite kaydeder.</li>
        </ol>

        <p><strong>Askiya Al / Etkinle&#351;tir:</strong></p>
        <ol>
            <li>Kullan&inodot;c&inodot; sat&inodot;r&inodot;ndaki durdur ikonuna (StopOutlined) t&inodot;kla</li>
            <li><code>POST /user-management/users/{id}/suspend</code></li>
            <li><code>active</code> ve <code>suspended</code> aras&inodot;nda durumu de&gbreve;i&#351;tirir. Ask&inodot;ya al&inodot;nm&inodot;&#351; kullan&inodot;c&inodot;lar giri&#351; yapamaz.</li>
        </ol>

        <p><strong>&#350;ifre S&inodot;f&inodot;rla:</strong></p>
        <ol>
            <li>Kullan&inodot;c&inodot; sat&inodot;r&inodot;ndaki anahtar ikonuna (KeyOutlined) t&inodot;kla</li>
            <li><code>POST /user-management/users/{id}/reset-password</code></li>
            <li>Backend kriptografik olarak g&uuml;venli 12 karakterlik &#351;ifre &uuml;retir, bcrypt ile hashler, <code>force_password_change = True</code> ayarlar</li>
            <li>Modal yeni &#351;ifreyi uyar&inodot;yla bir kez g&ouml;sterir. Admin &#351;ifreyi kullan&inodot;c&inodot;ya bant d&inodot;&#351;&inodot;ndan iletmelidir.</li>
        </ol>

        <h3>6.4.7 Kullan&inodot;c&inodot; Tipleri ve Farklar&inodot;</h3>

        <table>
            <tr><th></th><th>S&uuml;per Admin</th><th>Lab Kullan&inodot;c&inodot;s&inodot;</th><th>Operat&ouml;r</th><th>&Ouml;zel Tipler</th></tr>
            <tr><td><strong>Aray&uuml;z</strong></td><td>Masa&uuml;st&uuml;</td><td>Masa&uuml;st&uuml;</td><td>Mobil (kiosk)</td><td>Yap&inodot;land&inodot;r&inodot;labilir</td></tr>
            <tr><td><strong>Panel Rotas&inodot;</strong></td><td><code>/welcome</code></td><td><code>/lab/dashboard</code></td><td><code>/production</code></td><td>Varsay&inodot;lan <code>/welcome</code></td></tr>
            <tr><td><strong>Token S&uuml;resi</strong></td><td>12 saat</td><td>12 saat</td><td><strong>6 ay</strong></td><td>12 saat</td></tr>
            <tr><td><strong>Yetki Atlama</strong></td><td><strong>Evet</strong> &mdash; t&uuml;m kontroller True d&ouml;ner</td><td>Hay&inodot;r</td><td>Hay&inodot;r</td><td>Hay&inodot;r</td></tr>
            <tr><td><strong>Varsay&inodot;lan Mod&uuml;ller</strong></td><td>T&uuml;m&uuml; (<code>all_access</code>)</td><td>Lab, Hammadde</td><td>&Uuml;retim</td><td>Hi&ccedil;biri (manuel)</td></tr>
            <tr><td><strong>Uzant&inodot; Tablosu</strong></td><td><code>super_admins</code></td><td><code>lab_users</code></td><td><code>operators</code></td><td>Yok</td></tr>
            <tr><td><strong>Kullan&inodot;c&inodot; Y&ouml;netebilir</strong></td><td>Evet</td><td>Hay&inodot;r</td><td>Hay&inodot;r</td><td>Hay&inodot;r</td></tr>
            <tr><td><strong>Otomatik Giri&#351;</strong></td><td>Hay&inodot;r</td><td>Hay&inodot;r</td><td><strong>Evet</strong> (kiosk)</td><td>Hay&inodot;r</td></tr>
            <tr><td><strong>Men&uuml; Eri&#351;imi</strong></td><td><code>["all"]</code></td><td><code>["lab", "welcome"]</code></td><td><code>["production"]</code></td><td>Yetkilere ba&gbreve;l&inodot;</td></tr>
        </table>

        <p>&Ouml;zel tipler (&ouml;rn. <code>teknik_user</code>, <code>bakim_user</code>, <code>data</code>) do&gbreve;rudan Kullan&inodot;c&inodot; Y&ouml;netimi modal&inodot;nda olu&#351;turulabilir &mdash; kullan&inodot;c&inodot; tipi dropdown&rsquo;&inodot;n&inodot;n alt&inodot;ndaki bir girdi alan&inodot; yeni tip ad&inodot; yazmaya olanak tan&inodot;r. <code>user_type</code> alan&inodot; serbest bir <code>String(50)</code>&rsquo;dir, enum de&gbreve;il, bu esnekli&gbreve;i sa&gbreve;lar.</p>

        <h3>6.4.8 Frontend Mimarisi</h3>

        <p>Tek dosya: <code>src/pages/Admin/UserManagement/index.tsx</code> (960 sat&inodot;r). Rota: <code>/admin/user-management</code>.</p>

        <h4>ProTable (7 s&uuml;tun)</h4>
        <table>
            <tr><th>#</th><th>S&uuml;tun</th><th>Geni&#351;lik</th><th>Detay</th></tr>
            <tr><td>1</td><td>ID</td><td>60px, sabit sol</td><td>Say&inodot;sal</td></tr>
            <tr><td>2</td><td>Kullan&inodot;c&inodot;</td><td>140px</td><td>Kullan&inodot;c&inodot; ad&inodot; (kal&inodot;n) + alt&inodot;nda tam ad</td></tr>
            <tr><td>3</td><td>E-posta</td><td>200px</td><td>Ta&#351;mada &uuml;&ccedil; nokta</td></tr>
            <tr><td>4</td><td>Tip</td><td>110px</td><td>Renkli etiket: super_admin (k&inodot;rm&inodot;z&inodot;), lab_user (mavi), operator (ye&#351;il), teknik_user (mor), bakim_user (turuncu)</td></tr>
            <tr><td>5</td><td>Durum</td><td>100px</td><td>active (ba&#351;ar&inodot;/ye&#351;il), suspended (uyar&inodot;/sar&inodot;), inactive (varsay&inodot;lan/gri)</td></tr>
            <tr><td>6</td><td>Son Giri&#351;</td><td>140px</td><td><code>dayjs.utc(date).tz('Europe/Istanbul')</code> formatl&inodot;</td></tr>
            <tr><td>7</td><td>&#304;&#351;lemler</td><td>160px, sabit sa&gbreve;</td><td>4 eylem butonu (d&uuml;zenle, &#351;ifre s&inodot;f&inodot;rla, ask&inodot;ya al, sil)</td></tr>
        </table>

        <h4>Yetki D&uuml;zenleyici (Modal&rsquo;&inodot;n Sekme 2&rsquo;si)</h4>
        <p>T&uuml;m ERP&rsquo;deki en karma&#351;&inodot;k UI bile&#351;eni. 8 mod&uuml;l&uuml;n her biri i&ccedil;in:</p>
        <ol>
            <li><strong>Mod&uuml;l ba&#351;l&inodot;&gbreve;&inodot;:</strong> ikon ile mod&uuml;l ad&inodot;</li>
            <li><strong>Sayfa kartlar&inodot;:</strong> her sayfa Card bile&#351;eni olarak:
                <ul>
                    <li>Ba&#351;l&inodot;k: sayfa eri&#351;imi i&ccedil;in <code>Switch</code> + sayfa etiketi + &ldquo;X/Y&rdquo; etkin buton say&inodot;s&inodot; g&ouml;steren etiket</li>
                    <li>H&inodot;zl&inodot; eylemler: &ldquo;T&uuml;m&uuml;&rdquo; (t&uuml;m&uuml;n&uuml; etkinle&#351;tir) / &ldquo;Hi&ccedil;biri&rdquo; (t&uuml;m&uuml;n&uuml; kapat) metin butonlar&inodot;</li>
                    <li>Buton &inodot;zgaras&inodot;: her buton i&ccedil;in <code>Row</code>/<code>Col</code> d&uuml;zeninde <code>Checkbox</code> bile&#351;enleri</li>
                    <li>Kritik butonlar: k&inodot;rm&inodot;z&inodot; metin ve farkl&inodot; stille vurgulanm&inodot;&#351;</li>
                </ul>
            </li>
            <li><strong>Ak&inodot;ll&inodot; ge&ccedil;i&#351;:</strong> herhangi bir butonu etkinle&#351;tirmek sayfan&inodot;n eri&#351;imini otomatik etkinle&#351;tirir. Sayfa eri&#351;imini kapatmak t&uuml;m butonlar&inodot; kaskad olarak kapat&inodot;r.</li>
        </ol>

        <h4>H&inodot;zl&inodot; &#350;ablonlar</h4>
        <table>
            <tr><th>&#350;ablon</th><th>Etki</th></tr>
            <tr><td>&ldquo;T&uuml;m Yetkiler&rdquo;</td><td><code>createFullPermissions()</code> &mdash; her sayfa ve her buton <code>true</code></td></tr>
            <tr><td>&ldquo;Hi&ccedil;biri&rdquo;</td><td><code>createEmptyPermissions()</code> &mdash; her &#351;ey <code>false</code></td></tr>
            <tr><td>&ldquo;Operat&ouml;r Varsay&inodot;lan&rdquo;</td><td>&Uuml;retim mod&uuml;l&uuml; etkin (planlama sayfas&inodot; hari&ccedil;, o d&inodot;&#351;lanm&inodot;&#351;)</td></tr>
            <tr><td>&ldquo;Lab User Varsay&inodot;lan&rdquo;</td><td>Lab ve Hammadde mod&uuml;lleri etkin</td></tr>
        </table>

        <h4>&Ouml;nizleme Sekmesi (Sekme 3)</h4>
        <p>Card bile&#351;enleri kullanan salt okunur &ouml;zet. Yaln&inodot;zca eri&#351;ilebilir mod&uuml;lleri/sayfalar&inodot; g&ouml;sterir. Her sayfa etkin butonlar&inodot;n&inodot; Tag olarak listeler (kritik olanlar k&inodot;rm&inodot;z&inodot;). Kaydetmeden &ouml;nce h&inodot;zl&inodot; g&ouml;rsel onay sa&gbreve;lar.</p>

        <h3>6.4.9 Aktivite G&uuml;nl&uuml;&gbreve;&uuml; &mdash; Admin Denetim &#304;zi</h3>

        <p>Her kullan&inodot;c&inodot; y&ouml;netimi eylemi <code>log_activity()</code> yard&inodot;mc&inodot; fonksiyonu arac&inodot;l&inodot;&gbreve;&inodot;yla <code>user_activity_logs</code>&rsquo;a kaydedilir:</p>

        <table>
            <tr><th>Eylem</th><th>Kaydedilen Alanlar</th></tr>
            <tr><td><code>create_user</code></td><td>Kim olu&#351;turdu, hedef kullan&inodot;c&inodot; ID, kullan&inodot;c&inodot; ad&inodot;, IP, user agent</td></tr>
            <tr><td><code>update_user</code></td><td>Kim g&uuml;ncelledi, hedef kullan&inodot;c&inodot; ID, de&gbreve;i&#351;en alanlar detaylarda</td></tr>
            <tr><td><code>suspend_user</code></td><td>Kim ask&inodot;ya ald&inodot;, hedef kullan&inodot;c&inodot; ID, yeni durum</td></tr>
            <tr><td><code>delete_user</code></td><td>Kim sildi, hedef kullan&inodot;c&inodot; ID</td></tr>
            <tr><td><code>reset_password</code></td><td>Kim s&inodot;f&inodot;rlad&inodot;, hedef kullan&inodot;c&inodot; ID (&#351;ifre asla kaydedilmez)</td></tr>
        </table>

        <p>G&uuml;nl&uuml;kler <code>GET /user-management/activity-logs</code> ile user_id, module, action ve limit (varsay&inodot;lan 200) filtreleriyle sorgulanabilir. Yaln&inodot;zca s&uuml;per adminler bu endpoint&rsquo;e eri&#351;ebilir.</p>

        <h3>6.4.10 Yetki Modeli</h3>

        <p>Kullan&inodot;c&inodot; Y&ouml;netimi sistemdeki en y&uuml;ksek ayr&inodot;cal&inodot;k d&uuml;zeyini gerektirir:</p>

        <table>
            <tr><th>Eylem</th><th>Gerekli Rol</th></tr>
            <tr><td>Kullan&inodot;c&inodot; listesini g&ouml;r&uuml;nt&uuml;le</td><td>yaln&inodot;zca super_admin</td></tr>
            <tr><td>Kullan&inodot;c&inodot; olu&#351;tur</td><td>yaln&inodot;zca super_admin</td></tr>
            <tr><td>Kullan&inodot;c&inodot; d&uuml;zenle</td><td>yaln&inodot;zca super_admin</td></tr>
            <tr><td>Yetkileri y&ouml;net</td><td>yaln&inodot;zca super_admin</td></tr>
            <tr><td>Ask&inodot;ya al / etkinle&#351;tir</td><td>yaln&inodot;zca super_admin</td></tr>
            <tr><td>&#350;ifre s&inodot;f&inodot;rla</td><td>yaln&inodot;zca super_admin</td></tr>
            <tr><td>Kullan&inodot;c&inodot; sil</td><td>yaln&inodot;zca super_admin (kendini silme engellenir)</td></tr>
            <tr><td>Aktivite g&uuml;nl&uuml;klerini g&ouml;r&uuml;nt&uuml;le</td><td>yaln&inodot;zca super_admin</td></tr>
            <tr><td>Operat&ouml;rleri listele (dropdown)</td><td>herhangi do&gbreve;rulanm&inodot;&#351; kullan&inodot;c&inodot;</td></tr>
        </table>

        <p>Yetki manifestinde Kullan&inodot;c&inodot; Y&ouml;netimi&rsquo;nin 9 kay&inodot;tl&inodot; butonu vard&inodot;r: <code>access_page</code>, <code>view_users</code>, <code>create_user</code>, <code>edit_user</code>, <code>manage_permissions</code>, <code>suspend_user</code>, <code>reset_password</code>, <code>delete_user</code>, <code>view_activity_logs</code>.</p>

        <p>Backend rol tabanl&inodot; eri&#351;im zorlar: <code>/user-management/operators</code> hari&ccedil; her endpoint <code>current_user.user_type != "super_admin"</code> kontrol eder ve ba&#351;ar&inodot;s&inodot;z olursa 403 d&ouml;nd&uuml;r&uuml;r.</p>

        <h3>6.4.11 Kullan&inodot;c&inodot; Y&ouml;netimi Sistemin Geri Kalan&inodot;na Nas&inodot;l Ba&gbreve;lan&inodot;r</h3>

        <div class="arch-grid">
            <div class="arch-box">
                <h4>&rarr; T&uuml;m Mod&uuml;ller (Kimlik Do&gbreve;rulama)</h4>
                <p>T&uuml;m ERP&rsquo;deki her API endpoint&rsquo;i Kullan&inodot;c&inodot; Y&ouml;netimi&rsquo;nin kimlik do&gbreve;rulamas&inodot;na ba&gbreve;&inodot;ml&inodot;d&inodot;r. <code>get_current_user_dependency()</code> FastAPI dependency&rsquo;si t&uuml;m rota dosyalar&inodot;na import edilir ve kullan&inodot;l&inodot;r. Burada &uuml;retilen JWT token&rsquo;lar&inodot; herhangi korunan kayna&gbreve;a eri&#351;menin <em>tek</em> yoludur.</p>
            </div>
            <div class="arch-box">
                <h4>&rarr; T&uuml;m Mod&uuml;ller (Yetkilendirme)</h4>
                <p>Kullan&inodot;c&inodot; ba&#351;&inodot;na saklanan <code>permissions</code> JSON&rsquo;&inodot;, her kullan&inodot;c&inodot;n&inodot;n 8 mod&uuml;l&uuml;n tamam&inodot;nda ne g&ouml;rd&uuml;&gbreve;&uuml;n&uuml; ve ne yapabilece&gbreve;ini kontrol eder. Rota korumalar&inodot; (<code>access.ts</code>), bile&#351;en korumalar&inodot; (<code>PermissionGuard</code>) ve backend kontrolleri (<code>permission_checker.py</code>) hepsi ayn&inodot; yetki yap&inodot;s&inodot;ndan okur.</p>
            </div>
            <div class="arch-box">
                <h4>&rarr; Hammadde Giri&#351;i (Operat&ouml;r Dropdown&rsquo;&inodot;)</h4>
                <p><code>GET /user-management/operators</code> endpoint&rsquo;i, malzeme giri&#351; formlar&inodot;ndaki ve &uuml;retim sayfalar&inodot;ndaki operat&ouml;r/kullan&inodot;c&inodot; dropdown&rsquo;lar&inodot;n&inodot; besler. Herhangi do&gbreve;rulanm&inodot;&#351; kullan&inodot;c&inodot; buna eri&#351;ebilir, mod&uuml;ller aras&inodot;nda formlar&inodot;n &ldquo;bu malzemeyi kim girdi&rdquo; g&ouml;stermesini sa&gbreve;lar.</p>
            </div>
            <div class="arch-box">
                <h4>&rarr; &Uuml;retim Sayfalar&inodot; (Kiosk Otomatik Giri&#351;)</h4>
                <p>Kiosk otomatik giri&#351; sistemi (<code>?kiosk=...</code> token&rsquo;&inodot; veya Fully Kiosk alg&inodot;lamas&inodot;) fabrika kat&inodot; cihazlar&inodot; i&ccedil;in giri&#351; formunu tamamen atlar, payla&#351;&inodot;lan operat&ouml;r hesab&inodot;n&inodot;n 6 ayl&inodot;k token&rsquo;&inodot;yla do&gbreve;rudan <code>/production</code>&rsquo;a iner.</p>
            </div>
        </div>

        <div class="discovery">
            <p style="margin-bottom: 0;"><strong>Mimari i&ccedil;g&ouml;r&uuml;:</strong> Kullan&inodot;c&inodot; Y&ouml;netimi t&uuml;m ERP&rsquo;nin <em>&ccedil;ekim merkezi</em>dir. Her mod&uuml;l ona ba&gbreve;&inodot;ml&inodot;d&inodot;r ama o hi&ccedil;bir mod&uuml;le ba&gbreve;&inodot;ml&inodot; de&gbreve;ildir. 5 katmanl&inodot; yetki mimarisi (manifest &rarr; kay&inodot;t defteri &rarr; rota korumalar&inodot; &rarr; bile&#351;en korumalar&inodot; &rarr; backend zorlama) derinlemesine savunma sa&gbreve;lar: bir katman atlan&inodot;lsa bile di&gbreve;erleri hala eri&#351;im kontrol&uuml;n&uuml; zorlar. Hibrit yetki modeli (eski rol tabanl&inodot; + gran&uuml;ler sayfa+buton JSON) pragmatik bir m&uuml;hendislik karar&inodot;d&inodot;r &mdash; sistem basit rol kontrollerinden gran&uuml;ler yetkilere tam bir yeniden yazma gerektirmeden evrildi. <code>check_permission_smart()</code> fonksiyonu bunu somutla&#351;t&inodot;r&inodot;r: &ouml;nce yeni sistemi dener, eskiye geri d&ouml;ner ve nazik&ccedil;e degrade olur. 200+ buton manifesti, tek tek kay&inodot;t d&uuml;zeyinde eri&#351;im kontrol&uuml;ne gitmeden m&uuml;mk&uuml;n olan en ince ayarl&inodot; yetki sistemini olu&#351;turur. 6 ayl&inodot;k kiosk token&rsquo;&inodot;, &uuml;retim kat&inodot;ndaki payla&#351;&inodot;lan cihazlar&inodot;n her 12 saatte bir BT m&uuml;dahalesi olmadan &ldquo;&ccedil;al&inodot;&#351;mas&inodot;&rdquo; gereken bir fabrika ortam&inodot; i&ccedil;in al&inodot;&#351;&inodot;lmad&inodot;k ama pratik bir se&ccedil;imdir.</p>
        </div>

    </main>
</body>
</html>
